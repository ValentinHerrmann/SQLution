var gs=Object.defineProperty;var bs=(c,e,t)=>e in c?gs(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var w=(c,e,t)=>bs(c,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const Ce=class Ce{static registerPerformanceEntry(e,t){let i=Ce.performanceData.find(o=>o.url==e);i==null&&(i={count:0,sumTime:0,url:e},Ce.performanceData.push(i)),i.count++;let r=Math.round(performance.now()-t);i.sumTime+=r,Ce.performanceDataCount++}static sendDataToServer(){if(performance.now()-Ce.lastTimeSent>3*60*1e3){let e={data:Ce.performanceData};Ce.performanceData=[],Ce.performanceDataCount=0,Ce.lastTimeSent=performance.now(),ae("collectPerformanceData",e,()=>{})}}};w(Ce,"performanceData",[]),w(Ce,"performanceDataCount",0),w(Ce,"lastTimeSent",performance.now());let Vi=Ce;var Ee="";function ae(c,e,t,i){c.startsWith("http")||(c="servlet/"+c),Hi(!0);let r=performance.now(),o={};Ee!=null&&(o={"x-token-pm":Ee}),$.ajax({type:"POST",async:!0,data:JSON.stringify(e),contentType:"application/json",headers:o,url:c,success:function(u){if(Vi.registerPerformanceEntry(c,r),u.csrfToken!=null&&(Ee=u.csrfToken),Hi(!1),u.success!=null&&u.success==!1||typeof u=="string"&&u==""){let f="Fehler bei der Bearbeitung der Anfrage";u.message!=null&&(f=u.message),i&&i(f)}else t(u)},error:function(u,f){if(Hi(!1),i){let g="Server nicht erreichbar.";u.status!=0&&(g=""+u.status),i(f+": "+g);return}}})}function Hi(c){c?jQuery(".jo_network-busy").css("visibility","visible"):jQuery(".jo_network-busy").css("visibility","hidden")}async function ui(c,e){let t=[["content-type","text/json"]];Ee!=null&&t.push(["x-token-pm",Ee]);try{let r=await(await fetch(c,{method:"POST",headers:t,body:JSON.stringify(e)})).json();return r.token!=null&&(Ee=r.token),r==null?alert("Fehler beim Übertragen der Daten."):r.success!=!0&&alert(`Fehler beim Übertragen der Daten:
`+r.message),r}catch(i){return{status:"Error",message:"Es ist ein Fehler aufgetreten: "+i}}}class en{constructor(){w(this,"id");w(this,"name");w(this,"templateDump");w(this,"based_on_template_id");w(this,"templateName");w(this,"statements");w(this,"published_to");w(this,"version");w(this,"description");w(this,"owner_id")}static fromDatabaseData(e,t){let i=new en;return i.id=e.id,i.name=e.name,i.statements=e.statements,i.published_to=e.published_to,i.version=t,i.description=e.description,i.templateDump=null,i.based_on_template_id=e.based_on_template_id,i.owner_id=e.owner_id,i}}class ys{fetchTemplateFromCache(e,t){if(e==null){t(null);return}let i=this;this.cacheAvailable()||t(null),this.getCache(r=>{r.match(i.databaseIdToCacheIdentifier(e)).then(o=>{o.arrayBuffer().then(u=>t(new Uint8Array(u)))}).catch(()=>t(null))})}saveTemplateToCache(e,t){if(!this.cacheAvailable())return;let i=this;this.getCache(r=>{r.put(i.databaseIdToCacheIdentifier(e),new Response(t))})}cacheAvailable(){return!1}getCache(e){caches.open("my-cache").then(e)}databaseIdToCacheIdentifier(e){return"/onlineIdeTemplateDb"+e}}class wi{uploadCurrentDatabase(e,t,i,r,o=()=>{}){t.waitOverlay.show("Bitte warten, lade Vorlage auf den Server hoch ..."),e>=0?t.getDatabaseTool().export(f=>{f=pako.deflate(f),this.uploadIntern(f,e,r,t,o)},f=>{alert("Fehler beim Exportieren der Datenbank: "+f),t.waitOverlay.hide()}):this.uploadIntern(i,-1,r,t,o)}uploadIntern(e,t,i,r,o){let u={"x-workspaceid":""+t,"x-reason":i};return Ee!=null&&(u["x-token-pm"]=Ee),$.ajax({type:"POST",async:!0,contentType:"application/octet-stream",data:e,processData:!1,headers:u,url:"servlet/uploadTemplate",success:function(f){r.waitOverlay.hide(),o(f)},error:function(f,g){alert("message"),r.waitOverlay.hide()}}),e}}const St=class St{static isZipfile(e){return St.checkSignature(e,this.zipSignature)}static isSqLiteFile(e){return St.checkSignature(e,this.sqLiteSignature)}static checkSignature(e,t){if(e==null||e.byteLength<t.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!=t[i])return!1;return!0}};w(St,"zipSignature",[120,156]),w(St,"sqLiteSignature",[83,81,76,105,116,101,32,102,111,114,109,97,116,32,51,0]);let mi=St;class Xn{constructor(e,t){w(this,"nextStrategy");this.name=e,this.manager=t}}class ws extends Xn{constructor(t){super("long-polling strategy",t);w(this,"isClosed");w(this,"csrfToken");w(this,"shortestTimeoutMs",6e4);w(this,"timeOpened",null);w(this,"abortController");this.isClosed=!1}open(){this.isClosed=!1,this.abortController=new AbortController,this.timeOpened=performance.now();let t=[["content-type","text/json"]];t.push(["x-token-pm",Ee]),this.csrfToken=Ee,t.push(["x-timeout",this.shortestTimeoutMs+""]);try{fetch("/servlet/registerLongpollingListener",{signal:this.abortController.signal,method:"POST",headers:t,body:JSON.stringify({})}).then(i=>{if(i.status!=200){console.log(`Long-polling listener got http-status: ${i.status} (${i.statusText})`);let r=Math.round(performance.now()-this.timeOpened)-4e3;r<this.shortestTimeoutMs&&(this.shortestTimeoutMs=r)}switch(i.status){case 200:i.json().then(r=>{this.manager.onMessage(r)}),this.reopen();break;case 502:case 504:this.reopen(1e3,!1);break;default:this.reopen(1e4,!1);break}}).catch(i=>{console.log(`Long-polling listener failed due to reason: ${i}`),this.reopen(1e4,!1)}).finally(()=>{this.abortController=null})}catch{this.reopen(1e4,!1)}}reopen(t=500,i=!0){this.isClosed||(t>500&&console.log(`Reopen long-polling listener in ${t/1e3} seconds...`),setTimeout(()=>{this.isClosed||this.open()},t))}async close(){var i;this.isClosed=!0,(i=this.abortController)==null||i.abort();let t=[["content-type","text/json"]];t.push(["x-token-pm",this.csrfToken]),await fetch("/servlet/unregisterLongpollingListener",{method:"POST",headers:t,body:JSON.stringify({})})}}class vs extends Xn{constructor(t){super("websocket strategy",t);w(this,"csrfToken");w(this,"websocket");w(this,"isClosed");w(this,"openedTimestamp");w(this,"currentTimer")}open(){this.isClosed=!1;try{let t=(window.location.protocol.startsWith("https")?"wss://":"ws://")+window.location.host+"/servlet/pushWebsocket?csrfToken="+Ee;this.websocket=new WebSocket(t),this.websocket.onopen=i=>{this.openedTimestamp=performance.now()},this.websocket.onclose=i=>{console.log("Websocket has been closed, code: "+i.code+", reason: "+i.reason),this.isClosed=!0,i.code==1001&&performance.now()-this.openedTimestamp>1e4?(console.log("Reason was timeout, dt > 10s => Reopen!"),this.open()):(this.manager.onStrategyFailed(this),this.isClosed=!0)},this.websocket.onerror=i=>{console.log("Error on websocket, type: "+i.type),this.websocket.close(),this.manager.onStrategyFailed(this),this.isClosed=!0},this.websocket.onmessage=i=>{if(i.data=="pong")return;const r=JSON.parse(i.data);this.manager.onMessage(r)},this.currentTimer!=null&&clearTimeout(this.currentTimer),this.doPing()}catch{this.manager.onStrategyFailed(this),this.isClosed=!0}}doPing(){this.currentTimer=setTimeout(()=>{this.isClosed?this.currentTimer=null:(this.websocket.send("ping"),this.doPing())},25e3)}async close(){this.isClosed=!0,this.websocket.close()}}class ks{constructor(e){w(this,"strategies",[]);w(this,"currentStrategy");w(this,"eventTypeToSubscriberInfoMap",new Map);this.baseURL=e,this.strategies=[new vs(this),new ws(this)];for(let t=this.strategies.length-2;t>=0;t--)this.strategies[t].nextStrategy=this.strategies[t+1]}subscribe(e,t){this.eventTypeToSubscriberInfoMap.set(e,{eventType:e,handler:t})}unsubscribe(e){this.eventTypeToSubscriberInfoMap.delete(e)}open(){this.currentStrategy==null&&(this.currentStrategy=this.strategies[0],console.log(`Opening ${this.currentStrategy.name}`),this.currentStrategy.open())}onMessage(e){var t;for(let i of e){if(i.eventType=="keepAlive")return;(t=this.eventTypeToSubscriberInfoMap.get(i.eventType))==null||t.handler(i.data)}}onStrategyFailed(e){if(e!=this.currentStrategy)return;let t=this.currentStrategy;this.currentStrategy=this.currentStrategy.nextStrategy;let i=`${t.name} failed. `;this.currentStrategy!=null?(i+=`=> Trying ${this.currentStrategy.name} in 3 seconds...`,setTimeout(()=>{console.log(`Opening ${this.currentStrategy.name}`),this.currentStrategy.open()},3e3)):i+="It was the last resort, unfortunately this client has no means to receive push-messages from server.",console.log(i)}close(){this.currentStrategy!=null&&(this.currentStrategy.close(),this.currentStrategy=null)}}const Xe=class Xe extends ks{static subscribe(e,t){Xe.getInstance().subscribe(e,t)}static unsubscribe(e){Xe.getInstance().unsubscribe(e)}static getInstance(){return Xe.instance==null&&(Xe.instance=new Xe("")),Xe.instance}};w(Xe,"instance");let Ze=Xe;class xs{constructor(e,t){w(this,"timerhandle");w(this,"ownUpdateFrequencyInSeconds",20);w(this,"teacherUpdateFrequencyInSeconds",5);w(this,"updateFrequencyInSeconds",20);w(this,"forcedUpdateEvery",4);w(this,"counterTillForcedUpdate",2);w(this,"secondsTillNextUpdate",this.updateFrequencyInSeconds);w(this,"errorHappened",!1);w(this,"interval");this.main=e,this.$updateTimerDiv=t}initializeTimer(){let e=this;this.$updateTimerDiv.find("svg").attr("width",e.updateFrequencyInSeconds),this.interval!=null&&clearInterval(this.interval),this.interval=setInterval(()=>{if(e.main.user==null)return;if(e.secondsTillNextUpdate--,e.secondsTillNextUpdate<0){e.secondsTillNextUpdate=e.updateFrequencyInSeconds,this.counterTillForcedUpdate--;let i=this.counterTillForcedUpdate==0;i&&(this.counterTillForcedUpdate=this.forcedUpdateEvery),e.sendUpdates(()=>{},i)}let t=this.$updateTimerDiv.find(".jo_updateTimerRect");t.attr("width",e.secondsTillNextUpdate+"px"),e.errorHappened?(t.css("fill","#c00000"),this.$updateTimerDiv.attr("title","Fehler beim letzten Speichervorgang -> Werd's wieder versuchen")):(t.css("fill","#008000"),this.$updateTimerDiv.attr("title",e.secondsTillNextUpdate+" Sekunden bis zum nächsten Speichern"))},1e3)}sendUpdates(e,t=!1){var f;if(this.main.user==null)return;this.main.projectExplorer.writeEditorTextToFile(),this.main.userDataDirty&&(this.main.userDataDirty=!1,this.sendUpdateUserSettings(()=>{}));let i=[],r=[];for(let g of this.main.workspaceList){g.saved||(i.push(g.getWorkspaceData(!1)),g.saved=!0);for(let y of g.moduleStore.getModules(!1))y.file.saved||(y.file.text=y.getProgramTextFromMonacoModel(),r.push(y.getFileData(g)),y.file.saved=!0)}let o={workspacesWithoutFiles:i,files:r,owner_id:this.main.workspacesOwnerId,userId:this.main.user.id,language:1,currentWorkspaceId:(f=this.main.getCurrentWorkspace())==null?void 0:f.id,getModifiedWorkspaces:!1},u=this;if(i.length>0||r.length>0||t)ae("sendUpdates",o,g=>{if(u.errorHappened=!g.success,!u.errorHappened&&(u.updateWorkspaces(o,g),e!=null)){e();return}},()=>{u.errorHappened=!0});else if(e!=null){e();return}}initializeSSE(){Ze.subscribe("doFileUpdate",e=>{let t=this.main.workspaceList.slice();this.sendUpdates(()=>{let i=this.main.workspaceList.filter(r=>t.indexOf(r)<0).map(r=>r.name).join(", ");alert(`Deine Lehrkraft hat Dir folgende Datenbank übermittelt: ${i}`)},!0)})}sendCreateWorkspace(e,t,i){if(this.main.user.is_testuser){e.id=Math.round(Math.random()*1e7),i(null);return}let r={type:"create",entity:"workspace",data:e,owner_id:t,userId:this.main.user.id};ae("createOrDeleteFileOrWorkspace",r,o=>{e.id=o.id,i(null)},i)}getDatabaseSettings(e,t){ae("getDatabaseSettings",{workspaceId:e},r=>{t(r)},r=>{alert(r)})}setNewSecret(e,t,i){ae("setNewSecret",{workspaceId:e,secretKind:t},o=>{i(o.secret)},o=>{alert(o)})}setNameAndPublishedTo(e,t,i,r,o){ae("setPublishedTo",{workspaceId:e,databaseName:t,publishedTo:i,description:r},f=>{o()},f=>{alert(f)})}sendCreateFile(e,t,i,r){let u={type:"create",entity:"file",data:e.getFileData(t),owner_id:i,userId:this.main.user.id};ae("createOrDeleteFileOrWorkspace",u,f=>{e.file.id=f.id,r(null)},r)}sendDuplicateWorkspace(e,t){let i={workspace_id:e.id,language:1};ae("duplicateWorkspace",i,r=>{t(r.message,r.workspace)},t)}sendDistributeWorkspace(e,t,i,r){let o=()=>{new wi().uploadCurrentDatabase(e.id,this.main,null,"distributeWorkspace",u=>{this.sendUpdates(()=>{let f={workspace_id:e.id,database_as_template_id:u.newTemplateId,class_id:t==null?void 0:t.id,student_ids:i};ae("distributeWorkspace",f,g=>{r(g.message)},r)},!1)})};this.main.projectExplorer.setWorkspaceActive(e,o)}sendDeleteWorkspaceOrFile(e,t,i){let r={type:"delete",entity:e,id:t,userId:this.main.user.id};ae("createOrDeleteFileOrWorkspace",r,o=>{o.success?i(null):i("Netzwerkfehler!")},i)}sendUpdateUserSettings(e){var i;let t={settings:this.main.user.settings,userId:this.main.user.id,current_workspace_id:(i=this.main.getCurrentWorkspace())==null?void 0:i.id};ae("updateUserSettings",t,r=>{r.success?e(null):e("Netzwerkfehler!")},e)}getNewStatements(e,t){let i={workspaceId:e.id,version_before:e.database.version};ae("getNewStatements",i,r=>{r.success&&t(r.newStatements,r.firstNewStatementIndex)})}AddDatabaseStatements(e,t,i){let r={workspaceId:e.id,version_before:e.database.version,statements:t};ae("addDatabaseStatements",r,o=>{o.success&&i(o.statements_before,o.new_version)})}fetchDatabase(e,t){let i=new ys,r={workspaceId:e.id};ae("getDatabase",r,o=>{if(o.success){if(e.database=en.fromDatabaseData(o.database,o.version),e.databaseId=e.database.id,e.database.based_on_template_id==null){t(null);return}i.fetchTemplateFromCache(e.database.based_on_template_id,u=>{if(mi.isZipfile(u))try{e.database.templateDump=pako.inflate(u)}catch(f){console.log(f),console.log("Dump seems not to be compressed..."),e.database.templateDump=u}else e.database.templateDump=u;if(mi.isSqLiteFile(e.database.templateDump)){t(null);return}else this.fetchTemplate(e.id,(f,g)=>{if(f!=null){i.saveTemplateToCache(e.database.based_on_template_id,f),e.database.templateDump=pako.inflate(f),t(null);return}else{e.database.templateDump=null,t(g);return}})})}else t("Netzwerkfehler!")},o=>{t("Netzwerkfehler: "+o)})}fetchTemplate(e,t){let i={workspaceId:e},r={};Ee!=null&&(r={"x-token-pm":Ee}),$.ajax({type:"POST",async:!0,data:JSON.stringify(i),contentType:"application/json",url:"servlet/getTemplate",headers:r,xhrFields:{responseType:"arraybuffer"},success:function(o){t(new Uint8Array(o))},error:function(o,u){t(null,"Konnte das Template nicht laden.")}})}fetchTemplateList(e){let t={user_id:this.main.user.id};ae("getTemplateList",t,i=>{i.success?e(i.templateList):e([])},i=>{alert(i),e([])})}updateWorkspaces(e,t){let i=new Map,r=[];e.files.forEach(u=>r.push(u.id)),t.workspaces.workspaces.forEach(u=>i.set(u.id,u));let o=[];for(let u of t.workspaces.workspaces)this.main.workspaceList.filter(g=>g.id==u.id).length==0&&(o.push(u.name),this.createNewWorkspaceFromWorkspaceData(u));for(let u of this.main.workspaceList){let f=i.get(u.id);if(f!=null){let g=new Map;f.files.forEach(C=>g.set(C.id,C));let y=new Map;for(let C of u.moduleStore.getModules(!1)){let T=C.file.id;y.set(T,C);let D=g.get(T);D==null?(this.main.projectExplorer.fileListPanel.removeElement(C),this.main.currentWorkspace.moduleStore.removeModule(C)):D.version>C.file.version&&((r.indexOf(T)<0||D.forceUpdate)&&(C.file.text=D.text,C.model.setValue(D.text),C.file.saved=!0,C.lastSavedVersionId=C.model.getAlternativeVersionId()),C.file.version=D.version)}for(let C of f.files)y.get(C.id)==null&&this.createFile(u,C)}}this.main.projectExplorer.workspaceListPanel.sortElements(),this.main.projectExplorer.fileListPanel.sortElements()}createNewWorkspaceFromWorkspaceData(e,t=!1){let i=this.main.createNewWorkspace(e.name,e.owner_id);i.id=e.id,i.sql_history="",i.path=e.path,i.isFolder=e.isFolder,this.main.workspaceList.push(i);let r=e.path.split("/");r.length==1&&r[0]==""&&(r=[]);let o={name:e.name,externalElement:i,iconClass:"workspace",isFolder:e.isFolder,path:r};this.main.projectExplorer.workspaceListPanel.addElement(o,!0),i.panelElement=o;for(let u of e.files)this.createFile(i,u);t&&(this.main.projectExplorer.workspaceListPanel.sortElements(),this.main.projectExplorer.fileListPanel.sortElements())}createFile(e,t){let i=null;e==this.main.currentWorkspace&&(i={name:t.name,externalElement:null},this.main.projectExplorer.fileListPanel.addElement(i,!0));let r={id:t.id,name:t.name,dirty:!1,saved:!0,text:t.text,version:t.version,identical_to_repository_version:!0,workspace_id:e.id,panelElement:i},o=this.main.projectExplorer.getNewModule(r);i!=null&&(i.externalElement=o),e.moduleStore.putModule(o)}rollback(e){let t=this.main.currentWorkspace,i={workspaceId:t.id,version:t.database.version};ae("rollback",i,r=>{r.success?e(null,t.database.version>r.new_version):(alert(r.message),e(r.message,!1))},r=>{alert(r),e(r,!1)})}}var a=(c=>(c[c.identifier=0]="identifier",c[c.integerConstant=1]="integerConstant",c[c.floatingPointConstant=2]="floatingPointConstant",c[c.booleanConstant=3]="booleanConstant",c[c.stringConstant=4]="stringConstant",c[c.charConstant=5]="charConstant",c[c.true=6]="true",c[c.false=7]="false",c[c.keywordRename=8]="keywordRename",c[c.keywordDistinct=9]="keywordDistinct",c[c.keywordTo=10]="keywordTo",c[c.keywordAlter=11]="keywordAlter",c[c.keywordCommit=12]="keywordCommit",c[c.keywordAdd=13]="keywordAdd",c[c.keywordDelete=14]="keywordDelete",c[c.keywordSelect=15]="keywordSelect",c[c.keywordInsert=16]="keywordInsert",c[c.keywordInto=17]="keywordInto",c[c.keywordValues=18]="keywordValues",c[c.keywordUpdate=19]="keywordUpdate",c[c.keywordSet=20]="keywordSet",c[c.keywordNo=21]="keywordNo",c[c.keywordUse=22]="keywordUse",c[c.keywordCreate=23]="keywordCreate",c[c.keywordReferences=24]="keywordReferences",c[c.keywordPrimary=25]="keywordPrimary",c[c.keywordForeign=26]="keywordForeign",c[c.keywordTable=27]="keywordTable",c[c.keywordSchema=28]="keywordSchema",c[c.keywordTables=29]="keywordTables",c[c.keywordColumn=30]="keywordColumn",c[c.keywordDrop=31]="keywordDrop",c[c.keywordUnique=32]="keywordUnique",c[c.keywordKey=33]="keywordKey",c[c.keywordIndex=34]="keywordIndex",c[c.keywordConstraint=35]="keywordConstraint",c[c.keywordModify=36]="keywordModify",c[c.keywordCascade=37]="keywordCascade",c[c.keywordRestrict=38]="keywordRestrict",c[c.keywordAction=39]="keywordAction",c[c.keywordAutoincrement=40]="keywordAutoincrement",c[c.keywordFrom=41]="keywordFrom",c[c.keywordWhere=42]="keywordWhere",c[c.keywordGroup=43]="keywordGroup",c[c.keywordBy=44]="keywordBy",c[c.keywordHaving=45]="keywordHaving",c[c.keywordOrder=46]="keywordOrder",c[c.keywordAscending=47]="keywordAscending",c[c.keywordDescending=48]="keywordDescending",c[c.keywordNulls=49]="keywordNulls",c[c.keywordFirst=50]="keywordFirst",c[c.keywordLast=51]="keywordLast",c[c.keywordIs=52]="keywordIs",c[c.keywordNull=53]="keywordNull",c[c.keywordDatabase=54]="keywordDatabase",c[c.keywordUnion=55]="keywordUnion",c[c.keywordView=56]="keywordView",c[c.keywordEnum=57]="keywordEnum",c[c.keywordBetween=58]="keywordBetween",c[c.keywordOr=59]="keywordOr",c[c.keywordAnd=60]="keywordAnd",c[c.keywordNot=61]="keywordNot",c[c.keywordJoin=62]="keywordJoin",c[c.keywordNatural=63]="keywordNatural",c[c.keywordLeft=64]="keywordLeft",c[c.keywordCross=65]="keywordCross",c[c.keywordInner=66]="keywordInner",c[c.keywordOuter=67]="keywordOuter",c[c.keywordOn=68]="keywordOn",c[c.keywordAs=69]="keywordAs",c[c.keywordLimit=70]="keywordLimit",c[c.keywordOffset=71]="keywordOffset",c[c.keywordIn=72]="keywordIn",c[c.keywordNotIn=73]="keywordNotIn",c[c.keywordLike=74]="keywordLike",c[c.keywordCollate=75]="keywordCollate",c[c.keywordDefault=76]="keywordDefault",c[c.keywordComment=77]="keywordComment",c[c.keywordEngine=78]="keywordEngine",c[c.keywordCharset=79]="keywordCharset",c[c.keywordCharacter=80]="keywordCharacter",c[c.keywordStart=81]="keywordStart",c[c.keywordTransaction=82]="keywordTransaction",c[c.keywordIf=83]="keywordIf",c[c.keywordExists=84]="keywordExists",c[c.keywordLock=85]="keywordLock",c[c.keywordUnlock=86]="keywordUnlock",c[c.keywordWrite=87]="keywordWrite",c[c.keywordRead=88]="keywordRead",c[c.leftBracket=89]="leftBracket",c[c.rightBracket=90]="rightBracket",c[c.leftSquareBracket=91]="leftSquareBracket",c[c.rightSquareBracket=92]="rightSquareBracket",c[c.leftCurlyBracket=93]="leftCurlyBracket",c[c.rightCurlyBracket=94]="rightCurlyBracket",c[c.leftRightSquareBracket=95]="leftRightSquareBracket",c[c.dot=96]="dot",c[c.modulo=97]="modulo",c[c.minus=98]="minus",c[c.plus=99]="plus",c[c.multiplication=100]="multiplication",c[c.division=101]="division",c[c.singleQuote=102]="singleQuote",c[c.doubleQuote=103]="doubleQuote",c[c.identifierQuote=104]="identifierQuote",c[c.lower=105]="lower",c[c.greater=106]="greater",c[c.lowerOrEqual=107]="lowerOrEqual",c[c.greaterOrEqual=108]="greaterOrEqual",c[c.concatenation=109]="concatenation",c[c.equal=110]="equal",c[c.notEqual=111]="notEqual",c[c.semicolon=112]="semicolon",c[c.colon=113]="colon",c[c.comma=114]="comma",c[c.backslash=115]="backslash",c[c.pipe=116]="pipe",c[c.at=117]="at",c[c.hash=118]="hash",c[c.space=119]="space",c[c.tab=120]="tab",c[c.newline=121]="newline",c[c.linefeed=122]="linefeed",c[c.identifierChar=123]="identifierChar",c[c.comment=124]="comment",c[c.endofSourcecode=125]="endofSourcecode",c[c.constantNode=126]="constantNode",c[c.callMethod=127]="callMethod",c[c.unaryOp=128]="unaryOp",c[c.binaryOp=129]="binaryOp",c[c.table=130]="table",c[c.subquery=131]="subquery",c[c.list=132]="list",c[c.column=133]="column",c[c.columnDef=134]="columnDef",c[c.allColumns=135]="allColumns",c[c.isNull=136]="isNull",c[c.isNot=137]="isNot",c[c.isNotNull=138]="isNotNull",c[c.omittedeStatement=139]="omittedeStatement",c))(a||{}),he={0:"ein Bezeichner",1:"eine Integer-Konstante",2:"eine Fließkomma-Konstante",3:"eine boolesche Konstante",4:"eine Zeichenketten-Konstante",5:"eine char-Konstante",6:"true",7:"false",8:"rename",9:"distinct",10:"to",11:"alter",12:"commit",13:"add",14:"delete",15:"select",16:"insert",17:"into",18:"values",19:"update",20:"set",21:"no",22:"use",23:"create",24:"references",25:"primary",26:"foreign",27:"table",28:"schema",29:"tables",30:"column",31:"drop",32:"unique",33:"key",34:"index",35:"constraint",36:"modify",37:"cascade",38:"restrict",39:"action",40:"autoincrement",41:"from",42:"where",43:"group",44:"by",45:"having",46:"order",47:"ascending",48:"descending",49:"nulls",50:"first",51:"last",52:"is",53:"null",54:"database",55:"union",56:"view",57:"enum",58:"between",60:"and",59:"or",61:"not",62:"join",63:"natural",64:"left",65:"cross",66:"inner",67:"outer",68:"on",69:"as",70:"limit",71:"offset",72:"in",73:"not in",74:"like",75:"collate",76:"default",77:"comment",78:"engine",79:"charset",80:"character",81:"start",82:"transaction",83:"if",84:"exists",85:"lock",86:"unlock",87:"write",88:"read",89:"(",90:")",91:"[",92:"]",93:"{",94:"}",95:"[]",96:".",98:"-",97:"%",99:"+",100:"*",101:"/",102:"'",103:'"',104:"`",105:"<",106:">",110:"=",107:"<=",108:">=",109:"||",112:";",113:":",114:",",115:"\\",117:"@",118:"#",116:"|",119:"ein Leerzeichen",120:"ein Tabulatorzeichen",121:"ein Zeilenumbruch",123:"eines der Zeichen a..z, A..Z, _",124:"ein Kommentar",125:"das Ende des Programmes"},zi={"(":89,")":90,"[":91,"]":92,"{":93,"}":94,".":96,",":114,"-":98,"%":97,"+":99,"*":100,"/":101,"\\":115,"@":117,"#":118,"|":116,"'":102,'"':103,"`":104,"<":105,">":106,"=":110,"<>":111,";":112,":":113," ":119,"	":120,"\n":121,"\r":122},Cs={rename:8,distinct:9,to:10,alter:11,commit:12,add:13,delete:14,select:15,insert:16,into:17,values:18,update:19,set:20,no:21,use:22,create:23,references:24,primary:25,foreign:26,table:27,tables:29,column:30,drop:31,unique:32,key:33,index:34,constraint:35,modify:36,cascade:37,restrict:38,action:39,autoincrement:40,auto_increment:40,from:41,where:42,true:6,false:7,group:43,by:44,having:45,order:46,asc:47,desc:48,nulls:49,first:50,last:51,is:52,null:53,database:54,union:55,view:56,enum:57,between:58,or:59,and:60,not:61,join:62,natural:63,left:64,cross:65,inner:66,outer:67,on:68,as:69,limit:70,offset:71,in:72,"not in":73,like:74,collate:75,default:76,comment:77,engine:78,charset:79,character:80,start:81,transaction:82,if:83,exists:84,lock:85,unlock:86,write:87,read:88},Un={n:`
`,r:"\r",t:"	",'"':'"',"'":"'","\\":"\\"},Qe="►";class tn{constructor(){w(this,"tokenList");w(this,"nonSpaceLastTokenType");w(this,"nonSpaceLastToken");w(this,"errorList");w(this,"pos");w(this,"line");w(this,"column");w(this,"currentChar");w(this,"nextChar");w(this,"input");w(this,"spaceTokens",[a.space,a.tab,a.newline]);w(this,"bracketStack");w(this,"bracketError");w(this,"correspondingBracket",{});w(this,"tokenTypesToMerge",[{first:a.keywordNotIn,second:a.keywordIn,merged:a.keywordNotIn},{first:a.keywordIs,second:a.keywordNot,merged:a.isNot},{first:a.isNot,second:a.keywordNull,merged:a.isNotNull},{first:a.keywordIs,second:a.keywordNull,merged:a.isNull}]);this.correspondingBracket[a.leftBracket]=a.rightBracket,this.correspondingBracket[a.leftCurlyBracket]=a.rightCurlyBracket,this.correspondingBracket[a.leftSquareBracket]=a.rightSquareBracket,this.correspondingBracket[a.rightBracket]=a.leftBracket,this.correspondingBracket[a.rightCurlyBracket]=a.leftCurlyBracket,this.correspondingBracket[a.rightSquareBracket]=a.leftSquareBracket}lex(e){if(this.input=e.replace(" "," "),this.input=this.input.replace(/{[^}]+}(\[[^\]]+\])?/g,"0"),this.tokenList=[],this.errorList=[],this.bracketError=null,this.bracketStack=[],this.pos=0,this.line=1,this.column=1,this.nonSpaceLastTokenType=null,this.nonSpaceLastToken=null,e.length==0)return{tokens:this.tokenList,errors:this.errorList,bracketError:null};for(this.currentChar=e.charAt(0),this.nextChar=e.length>1?e.charAt(1):Qe;this.currentChar!=Qe;)this.mainState();if(this.bracketStack.length>0){let t=this.bracketStack.pop(),i=this.correspondingBracket[t];this.setBracketError(he[t]+" "+he[i])}return{tokens:this.tokenList,errors:this.errorList,bracketError:this.bracketError}}checkClosingBracket(e){if(this.bracketStack.length==0){let r=this.correspondingBracket[e];this.setBracketError(he[r]+" "+he[e]);return}let t=this.bracketStack.pop(),i=this.correspondingBracket[t];e!=i&&this.setBracketError(he[t]+" "+he[i])}setBracketError(e){this.bracketError==null&&(this.bracketError=e)}next(){this.pos++,this.currentChar=this.nextChar,this.pos+1<this.input.length?this.nextChar=this.input.charAt(this.pos+1):this.nextChar=Qe,this.column++}mainState(){let e=this.currentChar,t=zi[e];if(t!=null){switch(t){case a.leftSquareBracket:if(this.nextChar=="]"){this.pushToken(a.leftRightSquareBracket,"[]"),this.next(),this.next();return}else{this.pushToken(a.leftSquareBracket,"["),this.bracketStack.push(t),this.next();return}case a.division:if(this.nextChar=="*"){this.lexMultilineComment();return}this.pushToken(a.division,"/"),this.next();return;case a.pipe:if(this.nextChar=="|"){this.pushToken(a.concatenation,"||"),this.next(),this.next();return}else{this.pushToken(a.pipe,"|"),this.next();return}case a.lower:if(this.nextChar==">"){this.pushToken(a.notEqual,"<>"),this.next(),this.next();return}else if(this.nextChar=="="){this.pushToken(a.lowerOrEqual,"<="),this.next(),this.next();return}else{this.pushToken(a.lower,"<"),this.next();return}case a.greater:if(this.nextChar=="="){this.pushToken(a.greaterOrEqual,">="),this.next(),this.next();return}else{this.pushToken(a.greater,">"),this.next();return}case a.rightSquareBracket:this.checkClosingBracket(t);break;case a.leftBracket:this.bracketStack.push(t);break;case a.rightBracket:this.checkClosingBracket(t);break;case a.leftCurlyBracket:this.bracketStack.push(t);break;case a.rightCurlyBracket:this.checkClosingBracket(t);break;case a.minus:if(this.isDigit(this.nextChar,10)&&!([a.identifier,a.integerConstant,a.floatingPointConstant,a.rightBracket].indexOf(this.nonSpaceLastTokenType)>=0)){this.lexNumber();return}else if(this.nextChar=="-"){this.lexEndofLineComment("--");return}else{this.pushToken(a.minus,"-"),this.next();return}case a.hash:if(this.nonSpaceLastToken==null||this.nonSpaceLastToken.position.line<this.line){this.lexEndofLineComment("#");return}else this.pushToken(a.hash,"#"),this.next();break;case a.singleQuote:this.lexStringConstant("'");return;case a.doubleQuote:this.lexStringConstant('"');return;case a.newline:this.pushToken(a.newline,`
`),this.line++,this.column=0,this.next();return;case a.space:case a.tab:this.lexSpace();return;case a.linefeed:this.next();return;case a.at:this.lexAnnotation();return;case a.identifierQuote:this.lexQuotedIdentifier();return}this.pushToken(t,e),this.next();return}if(this.isDigit(e,10)){this.lexNumber();return}this.lexIdentifierOrKeyword()}lexQuotedIdentifier(){let e=this.line,t=this.column,i="";for(this.next();this.currentChar!="`"&&this.currentChar!=Qe;)i+=this.currentChar,this.next();this.currentChar==Qe?this.pushError("Innerhalb eines in `` eingeschlossenen Bezeichners wurde das Ende der Datei erreicht.",i.length+1,"error",e,t):(this.next(),this.pushToken(a.identifier,i,e,t))}pushToken(e,t,i=this.line,r=this.column,o=(""+t).length){let u={tt:e,value:t,position:{column:r,line:i,length:o}};for(let f of this.tokenTypesToMerge)if(e==f.second&&this.nonSpaceLastTokenType==f.first){let g=r-this.nonSpaceLastToken.position.column+o;this.nonSpaceLastToken.tt=f.merged,this.nonSpaceLastToken.position={column:this.nonSpaceLastToken.position.column,line:i,length:g},this.nonSpaceLastToken.value=this.nonSpaceLastToken.value+" "+t,this.nonSpaceLastTokenType=f.merged;return}this.spaceTokens.indexOf(e)>=0||(this.nonSpaceLastTokenType=e,this.nonSpaceLastToken=u),this.tokenList.push(u)}pushError(e,t,i="error",r=this.line,o=this.column){this.errorList.push({text:e,position:{line:r,column:o,length:t},level:i})}isDigit(e,t){var i=e.charCodeAt(0);if(t==10)return i>=48&&i<=57;if(t==2)return i>=48&&i<=49;if(t==8)return i>=48&&i<=55;if(t==16)return i>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70}lexSpace(){let e=this.column,t=this.line,i=this.pos;for(;this.currentChar==" "||this.currentChar=="	";)this.next();let r=this.pos;this.pushToken(a.space,this.input.substring(i,r),t,e)}lexCharacterConstant(){let e=this.column,t=this.line;this.next();let i=this.currentChar;if(i=="\\"){let r=Un[this.nextChar];r==null?(this.pushError("Die Escape-Sequenz \\"+this.nextChar+" gibt es nicht.",2),this.nextChar!="'"&&(i=this.nextChar,this.next())):(i=r,this.next())}this.next(),this.currentChar!="'"?this.pushError("Das Ende der char-Konstante wird erwartet (').",1):this.next(),this.pushToken(a.charConstant,i,t,e)}lexStringConstant(e){let t=this.line,i=this.column,r="";for(this.next();;){let o=this.currentChar;if(o=="\\"){let u=Un[this.nextChar];if(u==null)if(this.nextChar=="u"){let f="";for(this.next(),this.next();"abcdef0123456789".indexOf(this.currentChar)>=0&&f.length<4;)f+=this.currentChar,f.length<4&&this.next();f.length<4?this.pushError("Unbekanntes Unicode-Zeichen: u"+f,1+f.length):o=String.fromCodePoint(parseInt(f,16))}else this.pushError("Die Escape-Sequenz \\"+this.nextChar+" gibt es nicht.",2);else o=u,this.next()}else if(o==e){if(this.next(),this.currentChar!=e)break;r+=e}else if(o==`
`||o==Qe){this.pushError("Innerhalb einer String-Konstante wurde das Zeilenende erreicht.",r.length+1,"error",t,i);break}r+=o,this.next()}e=="'"?this.pushToken(a.stringConstant,r,t,i,r.length+2):(this.pushToken(a.identifier,r,t,i,r.length+2),this.tokenList[this.tokenList.length-1].isDoubleQuotedIdentifier=!0)}lexMultilineComment(){let e=this.line,t=this.column,i=!1,r="/*";for(this.next(),this.next();;){let o=this.currentChar;if(o=="*"&&this.nextChar=="/"){this.next(),this.next(),r+="*/";break}if(o==Qe){this.pushError("Innerhalb eines Mehrzeilenkommentars (/*... */) wurde das Dateiende erreicht.",1);break}o==`
`?(this.line++,this.column=0,i=!0,r+=o):i&&o==" "||(r+=o,i=!1),this.next()}this.pushToken(a.comment,r,e,t)}lexEndofLineComment(e){let t=this.line,i=this.column,r=e;for(let o=0;o<e.length;o++)this.next();for(;;){let o=this.currentChar;if(o==`
`||o==Qe)break;r+=o,this.next()}this.pushToken(a.comment,r,t,i)}lexNumber(){let e=this.line,t=this.column,i=1;this.currentChar=="-"&&(i=-1,this.next());let r=this.pos,o=this.currentChar;this.next();let u=10;for(o=="0"&&["b","x","0","1","2","3","4","5","6","7"].indexOf(this.currentChar)>=0&&(this.currentChar=="x"?(u=16,this.next()):this.currentChar=="b"?(u=2,this.next()):u=8,r=this.pos);this.isDigit(this.currentChar,u);)this.next();let f=a.integerConstant;if(this.currentChar=="."){for(f=a.floatingPointConstant,this.next();this.isDigit(this.currentChar,10);)this.next();u!=10&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-r,"error",this.line,this.column-(this.pos-r))}let g=this.input.substring(r,this.pos);r=this.pos;let y=0;if(this.currentChar=="e"){this.next();let T=this.pos;for(this.currentChar=="-"&&this.next();this.isDigit(this.currentChar,10);)this.next();u!=10&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-r,"error",this.line,this.column-(this.pos-r));let D=this.input.substring(T,this.pos);y=Number.parseInt(D)}(this.currentChar=="d"||this.currentChar=="f")&&(f==a.floatingPointConstant,this.next(),u!=10&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-r,"error",this.line,this.column-(this.pos-r)));let C=f==a.integerConstant?Number.parseInt(g,u):Number.parseFloat(g);C*=i,y!=0&&(C*=Math.pow(10,y)),this.pushToken(f,C,e,t)}lexAnnotation(){let e=this.line,t=this.column-1,i=this.pos,r=this.currentChar;for(this.next();zi[r]==null&&!this.isSpace(r)&&r!=Qe;)this.next(),r=this.currentChar;let o=this.pos,u=this.input.substring(i,o);this.pushToken(a.at,u,e,t,u.length+1)}lexIdentifierOrKeyword(){let e=this.line,t=this.column,i=this.pos,r=this.currentChar;for(;zi[r]==null&&!this.isSpace(r)&&r!=Qe;)this.next(),r=this.currentChar;let o=this.pos,u=this.input.substring(i,o),f=Cs[u.toLowerCase()];if(f!=null&&typeof f=="number"){switch(f){case a.true:this.pushToken(a.booleanConstant,!0,e,t);break;case a.false:this.pushToken(a.booleanConstant,!1,e,t);break;default:this.pushToken(f,u,e,t);break}return}this.pushToken(a.identifier,u,e,t)}isSpace(e){return e==" "||e==`
`}}class Zn{}const Se=class Se extends Zn{constructor(t,i,r,o,u){super();w(this,"binaryResultTypes",new Map);w(this,"unaryOperators",[]);w(this,"canCastToList");this.name=t,this.parameterDescriptions=i,this.checkFunction=r,this.outputFunction=o,this.canCastToList=u.slice(0);let f=this.canCastToList.indexOf(t);f>=0&&this.canCastToList.splice(f,1)}static fromConstantType(t){switch(t){case a.stringConstant:return this.baseTypeMap.get("text");case a.integerConstant:return this.baseTypeMap.get("integer");case a.floatingPointConstant:return this.baseTypeMap.get("float");case a.charConstant:return this.baseTypeMap.get("text");case a.booleanConstant:return this.baseTypeMap.get("boolean");case a.keywordNull:return this.baseTypeMap.get("null")}}getBaseTypeName(){return this.name}toString(){return this.name}getSQLiteType(){return this.toString()}static getBaseType(t){return t!=null&&t.toLocaleLowerCase()=="char"&&(t="varchar"),this.baseTypeMap.get(t.toLocaleLowerCase())}static addBaseTypes(t){Se.baseTypes=Se.baseTypes.concat(t),t.forEach(i=>Se.baseTypeMap.set(i.name,i))}addBinaryOperation(t,i,r,o=!0){Array.isArray(t)||(t=[t]),t.forEach(u=>{let f=this.binaryResultTypes.get(u);f==null&&(f=new Map,this.binaryResultTypes.set(u,f)),f.set(i,r),o&&i!=this&&i.addBinaryOperation(u,this,r,!1)})}canCastTo(t){let i=t instanceof Se?t:t.baseType;return i instanceof Kt&&(i=Se.getBaseType("text")),i instanceof Vt&&(i=Se.getBaseType("double")),this.canCastToList.indexOf(i.name)>=0||this.name==i.name}getBinaryResultType(t,i){let r=this.binaryResultTypes.get(t);if(r==null)return null;let o=i instanceof Se?i:i.baseType;return o instanceof Kt&&(o=Se.getBaseType("text")),o instanceof Vt&&(o=Se.getBaseType("double")),r.get(o)}getUnaryResultType(t){if([a.isNull,a.isNotNull].indexOf(t)>=0)return ue;if(this.unaryOperators.indexOf(t)>=0)return this}getBinaryResult(t,i,r){switch(t){case a.concatenation:return i!=null&&r!=null?i+r:i??r;case a.plus:return i!=null&&r!=null?i+r:i??r;case a.minus:return i!=null&&r!=null?i-r:i??r;case a.multiplication:return i!=null&&r!=null?i*r:i??r;case a.division:return i!=null&&r!=null?i*r:i??r;case a.keywordAnd:return i!=null&&r!=null?i*r:i??r;case a.keywordOr:return i!=null&&r!=null?Math.max(i,r):i??r;case a.lower:return i!=null&&r!=null?i<r:i==null;case a.greater:return i!=null&&r!=null?i>=r:i==null;case a.lowerOrEqual:return i!=null&&r!=null?i<=r:i==null;case a.greaterOrEqual:return i!=null&&r!=null?i>=r:i==null;case a.equal:return i==r;case a.notEqual:return i!=r;case a.modulo:return i%r}}};w(Se,"baseTypes",[]),w(Se,"baseTypeMap",new Map);let K=Se;class Vt extends K{constructor(t){super("NumberEnum",[],(i,r)=>`check(${i} in (${t.join(", ")}))`,(i,r)=>i,["decimal","integer","double","float"]);w(this,"isInteger",!0);w(this,"numericBinaryOperators",[a.plus,a.minus,a.multiplication,a.division,a.modulo]);w(this,"comparisonOperators",[a.lower,a.lowerOrEqual,a.greater,a.greaterOrEqual,a.equal,a.notEqual]);this.values=t;for(let i of t)Math.abs(Math.round(i)-i)>1e-8&&(this.isInteger=!1);this.name=this.isInteger?"integerEnum":"floatEnum"}getBinaryResultType(t,i){return this.numericBinaryOperators.indexOf(t)>=0?this.isInteger?K.getBaseType("integer"):K.getBaseType("double"):K.getBaseType("boolean")}getUnaryResultType(t){return null}getBinaryResult(t,i,r){return i+r}toString(){return"enum ("+this.values.join(", ")+")"}getBaseTypeName(){return"enum"}getSQLiteType(){return this.isInteger?"integerEnum":"realEnum"}}class Kt extends K{constructor(e){super("textEnum",[],(t,i)=>`check(${t} in (${e.map(r=>"'"+r+"'").join(", ")}))`,(t,i)=>t,["text","varchar","char"]),this.values=e}getBinaryResultType(e,t){return e==a.concatenation?K.getBaseType("text"):null}getUnaryResultType(e){return null}getBinaryResult(e,t,i){return t+i}toString(){return"enum ("+this.values.join(", ")+")"}getBaseTypeName(){return"enum"}getSQLiteType(){return"textEnum"}}let Ki=[1,10,100,1e3,1e5,1e5,1e6,1e7,1e8,1e9];class zt extends Zn{constructor(t,i){super();w(this,"name");this.baseType=t,this.parameterValues=i;let r=i.join(", ");this.name=t.name+"("+r+")"}toString(){return this.name}getBaseTypeName(){return this.baseType.name}getSQLiteType(){return this.baseType.getSQLiteType()}canCastTo(t){let i=t instanceof K?t:t.baseType;return this.baseType.canCastToList.indexOf(i.name)>=0||this.baseType.name==i.name}getBinaryResultType(t,i){let r=this.baseType.binaryResultTypes.get(t);if(r==null)return null;let o=i instanceof K?i:i.baseType,u=r.get(o);if(this.baseType==o&&this.baseType==u&&i instanceof zt){if(this.baseType.name=="varchar"||t==a.concatenation)return new zt(this.baseType,[this.parameterValues[0]+i.parameterValues[0]]);if(this.baseType.name=="decimal")return new zt(this.baseType,[Math.max(this.parameterValues[0],i.parameterValues[0]),Math.max(this.parameterValues[1],i.parameterValues[1])])}return r.get(o)}getUnaryResultType(t){return this.baseType.getUnaryResultType(t)}getBinaryResult(t,i,r){let o=this.baseType.getBinaryResult(t,i,r);return(this.name="varchar")?o==null?null:(""+o).substr(0,this.parameterValues[0]):this.name=="decimal"?o==null?null:Math.round(o*Ki[this.parameterValues[1]])/Ki[this.parameterValues[1]]:o}}let Dt=["varchar","char","text","tinytext","mediumtext","longtext"];var Le=new K("varchar",["Maximale Länge"],(c,e)=>`check(length(${c}) <= ${Math.max(e[0],1)})`,(c,e)=>c.substring(0,Math.max(e[0],1)),Dt),Ie=new K("char",["Maximale Länge"],(c,e)=>`check(length(${c}) <= ${Math.max(e[0],1)})`,(c,e)=>c.substring(0,Math.max(e[0],1)),Dt),fe=new K("text",["Maximale Länge"],(c,e)=>"",(c,e)=>c,Dt.concat(["time","date","datetime","timestamp"])),Ss=new K("tinyText",[],(c,e)=>"",(c,e)=>c,Dt),Es=new K("mediumText",[],(c,e)=>"",(c,e)=>c,Dt),Ts=new K("longText",[],(c,e)=>"",(c,e)=>c,Dt);let Lt=["decimal","numeric","double","real","float","floatEnum"];var hi=new K("decimal",["Gesamtzahl der Stellen","Nachkommastellen"],(c,e)=>"",(c,e)=>{let t=Math.trunc(c),i=c-t;return""+t+(e[1]>0?"."+Math.round(i*Ki[e[1]]):"")},Lt),js=new K("numeric",["Gesamtzahl der Stellen","Nachkommastellen"],(c,e)=>"",(c,e)=>""+c,Lt),Ds=new K("double",["Gesamtzahl der Stellen","Nachkommastellen"],(c,e)=>"",(c,e)=>""+c,Lt),Ls=new K("real",[],(c,e)=>"",(c,e)=>""+c,Lt),_s=new K("float",[],(c,e)=>"",(c,e)=>""+c,Lt);let Ps=["int","integer","tinyint","smallint","mediumint","bigint","integerEnum"],_t=Ps.concat(Lt);var Ms=new K("int",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),Is=new K("integer",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),As=new K("tinyint",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),Os=new K("smallint",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),$s=new K("mediumint",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),Ns=new K("bigint",["Maximale Anzahl der Stellen"],(c,e)=>`check(round(${c}) = ${c})`,(c,e)=>""+Math.round(c),_t),Yn=new K("time",[],(c,e)=>`check(isTime(${c}))`,(c,e)=>c,[]),Jn=new K("date",[],(c,e)=>`check(isDate(${c}))`,(c,e)=>c,[]),er=new K("datetime",[],(c,e)=>`check(isDateTime(${c}))`,(c,e)=>c,["timestamp"]),tr=new K("timestamp",[],(c,e)=>`check(isDateTime(${c}))`,(c,e)=>c,["datetime"]),ue=new K("boolean",[],(c,e)=>`check(${c} == 0 or ${c} == 1)`,(c,e)=>c==1?"true":"false",["varchar","text","decimal","numeric"]),Bs=new K("null",[],(c,e)=>"",(c,e)=>c,[]);let Ge=[hi,js,Ds,Ls,_s,Ms,Is,As,Os,$s,Ns],ir=[Le,Ie,fe,Ss,Es,Ts,Yn,Jn,er,tr,ue,Bs].concat(Ge),Wt=[Yn,Jn,er,tr];K.addBaseTypes(ir);Le.addBinaryOperation(a.concatenation,Le,Le);Le.addBinaryOperation(a.concatenation,Ie,Le);Le.addBinaryOperation(a.concatenation,fe,fe);fe.addBinaryOperation(a.concatenation,fe,fe);Le.addBinaryOperation(a.keywordLike,Le,ue);Le.addBinaryOperation(a.keywordLike,fe,ue);fe.addBinaryOperation(a.keywordLike,fe,ue);Ie.addBinaryOperation(a.concatenation,Ie,Ie);Ie.addBinaryOperation(a.concatenation,Le,Ie);Ie.addBinaryOperation(a.concatenation,fe,fe);fe.addBinaryOperation(a.concatenation,fe,fe);Ie.addBinaryOperation(a.keywordLike,Ie,ue);Ie.addBinaryOperation(a.keywordLike,fe,ue);fe.addBinaryOperation(a.keywordLike,fe,ue);ue.addBinaryOperation(a.equal,ue,ue);let nr=[a.plus,a.minus,a.multiplication,a.division,a.modulo],Ut=[a.lower,a.lowerOrEqual,a.greater,a.greaterOrEqual,a.equal,a.notEqual];for(let c=0;c<Ge.length;c++){for(let e=c;e<Ge.length;e++)Ge[c].addBinaryOperation(nr,Ge[e],Ge[e]),Ge[c].addBinaryOperation(Ut,Ge[e],ue);Ge[c].unaryOperators=[a.minus]}hi.addBinaryOperation(nr,hi,hi);let We=[Le,fe];for(let c=0;c<We.length;c++)for(let e=c;e<We.length;e++)We[c].addBinaryOperation(a.concatenation,We[e],We[e]),We[c].addBinaryOperation(Ut,We[e],ue);for(let c=0;c<Wt.length;c++){Wt[c].addBinaryOperation(Ut,Wt[c],ue);for(let e=0;e<We.length;e++)Wt[c].addBinaryOperation(Ut,We[e],ue),We[e].addBinaryOperation(Ut,Wt[c],ue)}let Fs=[a.keywordAnd,a.keywordOr];ue.addBinaryOperation(Fs,ue,ue);ue.unaryOperators=[a.keywordNot];ir.forEach(c=>c.unaryOperators=c.unaryOperators.concat([a.isNull,a.isNotNull]));const ut=class ut{constructor(){w(this,"module");w(this,"pos");w(this,"tokenList");w(this,"errorList");w(this,"lookahead",4);w(this,"ct");w(this,"lastToken");w(this,"cct");w(this,"tt");w(this,"position");w(this,"lastComment");w(this,"endToken",{position:{line:0,column:0,length:1},tt:a.endofSourcecode,value:"das Ende des Programms"});w(this,"beginStatementKeywords",["select","insert into","update","create table","create view","delete from","alter table","drop table","drop view"]);w(this,"identifierMap",{year:"int",binary:"varchar",varbinary:"varchar"})}parse(e){if(this.module=e,this.tokenList=e.tokenList,this.errorList=[],e.completionHints=new Map,this.tokenList.length==0){this.module.sqlStatements=[],this.module.errors[1]=this.errorList,this.module.addCompletionHint({line:0,column:0,length:0},{line:2e4,column:100,length:0},!1,!1,this.beginStatementKeywords);return}this.pos=0,this.initializeLookahead();let t=this.tokenList[this.tokenList.length-1];this.endToken.position={line:t.position.line,column:t.position.column+t.position.length,length:1},this.module.sqlStatements=this.parseMain(),this.module.errors[1]=this.errorList}initializeLookahead(){this.ct=[];for(let e=0;e<this.lookahead;e++){let t=this.endToken;for(;!(this.pos>=this.tokenList.length);){let i=this.tokenList[this.pos];if(i.tt==a.comment&&(this.lastComment=i),i.tt!=a.newline&&i.tt!=a.space&&i.tt!=a.comment){t=i,this.lastComment!=null&&(t.commentBefore=this.lastComment,this.lastComment=null);break}this.pos++}this.ct.push(t),e<this.lookahead-1&&this.pos++}this.cct=this.ct[0],this.tt=this.cct.tt,this.position=this.cct.position}nextToken(){let e;for(this.lastToken=this.cct;;){if(this.pos++,this.pos>=this.tokenList.length){e=this.endToken;break}if(e=this.tokenList[this.pos],e.tt==a.comment&&(this.lastComment=e),e.tt!=a.newline&&e.tt!=a.space&&e.tt!=a.comment){e.commentBefore=this.lastComment,this.lastComment=null;break}}for(let t=0;t<this.lookahead-1;t++)this.ct[t]=this.ct[t+1];this.ct[this.lookahead-1]=e,this.cct=this.ct[0],this.tt=this.cct.tt,this.position=this.cct.position}pushError(e,t="error",i,r){i==null&&(i=Object.assign({},this.position)),this.errorList.push({text:e,position:i,quickFix:r,level:t})}skip(e){Array.isArray(e)||(e=[e]),e.indexOf(this.tt)>=0&&this.nextToken()}expect(e,t=!0,i=!1){if(this.tt!=e&&!(Array.isArray(e)&&e.indexOf(this.tt)>=0)){if(e==a.semicolon&&this.tt==a.endofSourcecode)return!0;let r=this.cct.position;e==a.semicolon&&this.lastToken!=null&&this.lastToken.position.line<r.line&&(r={line:this.lastToken.position.line,column:this.lastToken.position.column+this.lastToken.position.length,length:1});let o=null;e==a.semicolon&&this.lastToken.position.line<this.cct.position.line&&!this.isOperatorOrDot(this.lastToken.tt)&&(o={title:"Strichpunkt hier einfügen",editsProvider:f=>[{resource:f,edit:{range:{startLineNumber:r.line,startColumn:r.column,endLineNumber:r.line,endColumn:r.column,message:"",severity:monaco.MarkerSeverity.Error},text:";"}}]},i&&this.module.main.getSemicolonAngel().register(r,this.module));let u;if(Array.isArray(e)){u=e.map(g=>he[g]);let f=u.join(", ");this.pushError("Erwartet wird eines der folgenden: "+f+" - Gefunden wurde: "+he[this.tt],"error",r,o)}else u=[he[e]],this.pushError("Erwartet wird: "+he[e]+" - Gefunden wurde: "+he[this.tt],"error",r,o);return!1}return t&&this.nextToken(),!0}getEndOfPosition(e){return{line:e.line,column:e.column+e.length,length:0}}isOperatorOrDot(e){if(e==a.dot)return!0;for(let t of ut.operatorPrecedence)for(let i of t)if(e==i)return!0}isEnd(){return this.cct==this.endToken}comesToken(e,t=!1){if(!Array.isArray(e)){let r=this.tt==e;return r&&t&&this.nextToken(),r}let i=e.indexOf(this.tt)>=0;return i&&t&&this.nextToken,i}getCurrentPosition(){return Object.assign({},this.position)}getCurrentPositionPlus(e){if(this.tt==a.endofSourcecode)return{line:this.endToken.position.line,column:100,length:1};let t=0,i=e,r=0;for(;t<this.lookahead-1&&(r=this.ct[t].position.length)<i;)i-=r,t++;let o=this.ct[t].position;return o==null&&(o=this.getCurrentPosition()),{line:o.line,column:o.column+i,length:1}}getEndOfCurrentToken(){let e=this.getCurrentPosition();return e.column=e.column+this.position.length,e.length=0,e}parseMain(){let e=[],t={column:0,line:0,length:0},i=!0;for(this.module.addCompletionHint(t,this.getCurrentPositionPlus(8),!1,!1,this.beginStatementKeywords);!this.isEnd();){let r=this.pos,o=this.errorList.length;for(;[a.space,a.newline,a.comment,a.semicolon].indexOf(this.cct.tt)>=0;)this.nextToken();let u=this.getCurrentPosition(),f=this.parseStatement();for(t={line:this.lastToken.position.line+1,column:0,length:0},i=this.tt==a.semicolon;this.tt==a.semicolon;)this.nextToken();let g=!1;for(let y=o;y<this.errorList.length;y++)this.errorList[y].level=="error"&&(g=!0);if(f!=null&&e.push({ast:f,from:u,to:this.getEndOfPosition(this.lastToken.position),hasErrors:g,acceptedBySQLite:!1,resultTypes:[]}),this.getCurrentPosition(),this.pos==r){let y=[a.keywordSelect,a.keywordUpdate,a.keywordCreate,a.keywordInsert,a.keywordDelete,a.keywordDrop,a.keywordAlter],C=!0;for(;!this.isEnd()&&y.indexOf(this.tt)<0;)[a.space,a.newline].indexOf(this.tt)<0&&C&&(this.pushError("Erwartet wird eines dieser Schlüsselwörter: "+y.map(T=>he[T]).join(", ")+"; Gefunden wurde: "+this.cct.value),C=!0),this.nextToken()}(i||this.cct.position.line-t.line>0)&&this.module.addCompletionHint(t,this.getCurrentPositionPlus(8),!1,!1,this.beginStatementKeywords)}return this.module.addCompletionHint(t,{line:this.endToken.position.line+1,column:0,length:0},!1,!1,this.beginStatementKeywords),e}parseStatement(e=!0){let t=null;switch(this.tt){case a.keywordSelect:return this.parseSelect();case a.keywordInsert:return this.parseInsert();case a.keywordCreate:return this.parseCreateTableOrDatabaseOrView();case a.keywordUpdate:return this.parseUpdate();case a.keywordDelete:return this.parseDelete();case a.keywordDrop:return this.parseDropTableOrView();case a.keywordAlter:return this.parseAlterTable();case a.keywordCommit:return this.pushError("Die Aweisung commit ist unnötig, da jede Anweisung automatisch commited wird.","info"),this.nextToken(),null;case a.keywordSet:return this.parseSet();case a.keywordUse:return this.parseUse();case a.keywordStart:return this.pushError("Die Aweisung 'start transaction' ist unnötig, da jede Anweisung automatisch commited wird.","info"),this.nextToken(),this.expect(a.keywordTransaction,!0),null;case a.keywordLock:case a.keywordUnlock:return this.parseLockUnlock(),null;default:let i=he[this.tt];i==null&&(i=""),i!=this.cct.value&&(i+="("+this.cct.value+")"),i+=" wird hier nicht erwartet.",this.pushError(i),this.nextToken();break}return t}parseLockUnlock(){this.nextToken(),this.expect(a.keywordTables,!0),this.skip(a.identifier),this.skip([a.keywordWrite,a.keywordRead]),this.skip(a.semicolon)}parseSet(){this.pushError("Das SET-Statement wird von SQLite nicht unterstützt. Diese Anweisung wird daher einfach überlesen.","info");let e={type:a.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};return this.nextToken(),this.comesToken(a.keywordDatabase)&&this.nextToken(),this.expect(a.identifier,!0),this.comesToken(a.equal,!0),this.expect([a.identifier,a.stringConstant,a.integerConstant,a.charConstant,a.booleanConstant,a.floatingPointConstant],!0),e.endPosition=this.getCurrentPosition(),e}parseUse(){this.pushError("Das USE-Statement wird von SQLite nicht unterstützt. Diese Anweisung wird daher einfach überlesen. Sie können eine andere Datenbank auswählen indem Sie in der Datenbankliste links darauf klicken.","info");let e={type:a.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};return this.nextToken(),this.expect(a.identifier,!0),e.endPosition=this.getCurrentPosition(),e}parseAlterTable(){let e=this.getCurrentPosition();this.nextToken();let t={type:a.keywordAlter,kind:null,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null};if(this.expect(a.keywordTable,!0)||this.addCompletionHintHere(!1,!1,["table"],1),this.addCompletionHintHere(!1,!0,[],1),!this.expect(a.identifier,!1))return t;switch(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,["rename to","rename column","add column","drop column"],1),this.tt){case a.keywordRename:this.parseRenameTableOrColumn(t);break;case a.keywordAdd:this.parseAlterTableAdd(t);break;case a.keywordDrop:this.parseDropColumn(t);break;default:this.pushError("Erwartet wird rename to, rename column, add column oder drop column")}return t}parseRenameTableOrColumn(e){switch(this.nextToken(),this.comesToken(a.keywordTo)||this.addCompletionHintHere(e.tableIdentifier,!1,["column","to"],3),e.endPosition=this.getEndOfCurrentToken(),this.tt){case a.keywordTo:this.nextToken(),e.endPosition=this.getEndOfCurrentToken(),e.kind="renameTable",this.comesToken(a.identifier)?(e.newTableName=this.cct.value,this.nextToken(),e.endPosition=this.getEndOfCurrentToken()):this.pushError("Erwartet wird der neue Tabellenname.");return;case a.keywordColumn:if(this.nextToken(),e.endPosition=this.getEndOfCurrentToken(),this.addCompletionHintHere(e.tableIdentifier,!1,[],3),!this.comesToken(a.identifier)){this.pushError("Erwartet wird der Name einer Spalte der Tabelle "+e.tableIdentifier+".");return}if(e.kind="renameColumn",e.oldColumnName=this.cct.value,e.oldColumnPosition=this.getCurrentPosition(),this.nextToken(),this.addCompletionHintHere(!1,!1,["to"],3),e.endPosition=this.getEndOfCurrentToken(),!this.expect(a.keywordTo,!0))return;e.endPosition=this.getEndOfCurrentToken(),this.comesToken(a.identifier)?(e.newColumnName=this.cct.value,this.nextToken(),e.endPosition=this.getEndOfCurrentToken()):this.pushError("Erwartet wird der neue Spaltenname.");return;default:this.pushError("Erwartet wird das Schlüsselwort 'to' (zum Umbenennen der Tabelle) oder das Schlüsselwor 'column' (zum Umbenennen einer Spalte).");return}}parseDropColumn(e){this.nextToken(),this.comesToken(a.keywordColumn,!0),e.oldColumnPosition=this.getCurrentPosition(),this.addCompletionHintHere(e.tableIdentifier,!1,[],3),e.kind="dropColumn",e.endPosition=this.getEndOfCurrentToken(),this.comesToken(a.identifier)?(e.oldColumnName=this.cct.value,this.nextToken()):this.pushError("Erwartet wird der Bezeichner der Spalte, die gelöscht werden soll.")}parseAlterTableAdd(e){do{this.nextToken(),this.comesToken(a.keywordAdd,!0);let t=!1;switch(this.tt){case a.keywordColumn:this.parseAddColumn(e);break;case a.keywordPrimary:this.parseAddPrimaryKey(e);break;case a.keywordUnique:this.nextToken(),t=!0,this.expect([a.keywordIndex,a.keywordKey],!1);case a.keywordKey:case a.keywordIndex:this.parseAddIndex(e,t);break;case a.keywordModify:this.parseModifyColumn(e);break;case a.keywordConstraint:this.parseAddConstraint(e);break;default:this.parseAddColumn(e);break}}while(this.tt==a.comma)}parseAddConstraint(e){if(this.nextToken(),!!this.expect(a.identifier)&&this.comesToken(a.keywordForeign)){let t=this.parseForeignKeyDefinition();t!=null&&(e.foreignKeys==null&&(e.foreignKeys=[]),e.foreignKeys.push(t),e.kind="omittedKind")}}parseForeignKeyDefinition(){let e={column:"",referencesTable:"",referencesColumn:"",referencesPosition:this.getCurrentPosition()};if(this.expect(a.keywordForeign)&&this.expect(a.keywordKey)&&this.expect(a.leftBracket)){if(!this.comesToken(a.identifier)){this.pushError("Der Bezeichner der Fremdschlüsselspalte wird erwartet.");return}if(e.column=this.cct.value,this.nextToken(),!!this.expect(a.rightBracket))return this.parseReferences(e),e}}parseReferences(e){if(!this.expect(a.keywordReferences))return;if(this.addCompletionHintHere(!1,!0,[]),!this.comesToken(a.identifier)){this.pushError("Der Bezeichner der referenzierten Tabelle wird erwartet.");return}e.referencesTable=this.cct.value,this.nextToken();let t=this.lastToken.position,i=this.getCurrentPosition();if(this.module.addCompletionHint(this.getEndOfPosition(t),i,e.referencesTable,!1,[]),!!this.expect(a.leftBracket)){if(!this.comesToken(a.identifier)){this.pushError("Der Bezeichner der referenzierten Spalte wird erwartet.");return}if(e.referencesColumn=this.cct.value,this.nextToken(),!!this.expect(a.rightBracket))for(;this.tt==a.keywordOn;){this.nextToken();let r="";switch(this.tt){case a.keywordDelete:r="onDelete";break;case a.keywordUpdate:r="onUpdate";break}switch(r==""?(this.pushError("Nach 'on' wird 'delete' oder 'update' erwartet."),this.comesToken([a.keywordCascade,a.keywordRestrict,a.keywordSet,a.keywordNo])||(this.nextToken(),r="onDelete")):this.nextToken(),this.tt){case a.keywordCascade:e[r]=this.cct.value,this.nextToken();break;case a.keywordRestrict:e[r]=this.cct.value,this.nextToken();break;case a.keywordSet:e[r]="set ",this.nextToken(),[a.keywordNull,a.keywordDefault].indexOf(this.tt)>=0?(e[r]+=this.cct.value,this.nextToken()):this.pushError("Nach 'on delete/update set' wird 'null' oder 'default' erwartet.");break;case a.keywordNo:this.nextToken(),this.expect(a.keywordAction),e[r]="no action";break;default:this.pushError("Nach 'on delete/update' wird 'cascade', 'set null', 'set default' oder 'no action' erwartet.");break}}}}parseModifyColumn(e){this.nextToken();let t=this.parseColumnDefinition(!1);t!=null&&(e.modifyColumnInfo==null&&(e.modifyColumnInfo=[]),e.modifyColumnInfo.push(t))}parseAddPrimaryKey(e){if(this.nextToken(),e.primaryKeys=[],this.expect(a.keywordKey,!0)&&this.expect(a.leftBracket,!1))do this.nextToken(),this.tt==a.identifier&&(e.primaryKeys.push(this.cct.value),this.nextToken());while(this.tt==a.comma);return this.expect(a.rightBracket,!0)?(e.kind="omittedKind",e):null}parseAddIndex(e,t){this.nextToken();let i={index_name:"",column:"",unique:t};if(this.tt==a.identifier)i.index_name=this.cct.value+"_idx",this.nextToken();else return this.pushError("Erwartet wird der Bezeichner des Index."),null;if(!this.expect(a.leftBracket,!0))return null;if(this.tt==a.identifier)i.column=this.cct.value,this.nextToken(),e.indices==null&&(e.indices=[]),e.indices.push(i);else return this.pushError("Erwartet wird der Bezeichner der Spalte, für die ein Index erstellt werden soll."),null;return e.kind="omittedKind",this.expect(a.rightBracket,!0),null}parseAddColumn(e){e.kind="addColumn",this.comesToken(a.keywordColumn,!0),e.columnDefBegin=this.getCurrentPosition(),e.columnDef=this.parseColumnDefinition(!1)}parseDropTableOrView(){let e=this.getCurrentPosition();this.nextToken();let t={type:a.keywordDrop,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,ifExists:!1};return this.expect([a.keywordTable,a.keywordView],!0)||this.addCompletionHintHere(!1,!1,["table","view"],1),this.comesToken(a.keywordIf,!0)&&(t.ifExists=!0,this.expect(a.keywordExists,!0)),this.addCompletionHintHere(!1,!0,[],1,"",";"),this.expect(a.identifier,!1)&&(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition()),t}parseDelete(){let e=this.getCurrentPosition();this.nextToken();let t={type:a.keywordDelete,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,whereNode:null,whereNodeBegin:null,whereNodeEnd:null};return this.expect(a.keywordFrom,!0)||this.addCompletionHintHere(!1,!1,["from"],1),this.addCompletionHintHere(!1,!0,[],1,"",` where
	`),!this.expect(a.identifier,!1)||(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,[`where
	`],1),this.tt!=a.keywordWhere)||(this.nextToken(),t.endPosition=this.getCurrentPosition(),t.whereNodeBegin=this.getEndOfPosition(this.lastToken.position),t.whereNode=this.parseTerm(),t.whereNodeEnd=this.getCurrentPosition(),this.module.addCompletionHint(t.whereNodeBegin,this.getCurrentPositionPlus(3),t.tableIdentifier,!1,[]),t.endPosition=this.getCurrentPosition()),t}parseUpdate(){let e=this.getCurrentPosition();this.nextToken();let t={type:a.keywordUpdate,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,columnIdentifiers:[],columnIdentifierPositions:[],values:[],valuePosBegin:[],valuePosEnd:[],whereNode:null,whereNodeBegin:null,whereNodeEnd:null};if(this.addCompletionHintHere(!1,!0,[],1,"",` set
	`),!this.expect(a.identifier,!1)||(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,[`set
	`],1),!this.expect(a.keywordSet)))return t;let i=!0;do{if(this.addCompletionHintHere(t.tableIdentifier,!1,i?[]:["where"],1,null," = "),i=!1,this.tt!=a.identifier){this.pushError("Hier wird der Bezeichner derjenigen Spalte der Tabelle "+t.tableIdentifier+" erwaretet, deren Wert verändert werden soll.","error");break}t.columnIdentifiers.push(this.cct.value),t.columnIdentifierPositions.push(this.getCurrentPosition()),this.nextToken(),this.expect(a.equal,!0),t.valuePosBegin.push(this.getCurrentPosition()),t.values.push(this.parseTerm()),t.valuePosEnd.push(this.getCurrentPosition())}while(this.comesToken(a.comma,!0));if(t.endPosition=this.getCurrentPosition(),this.lastToken.tt!=a.comma||this.comesToken(a.keywordWhere)){if(!this.expect(a.keywordWhere,!0))return t;t.whereNodeBegin=this.getEndOfPosition(this.lastToken.position),t.whereNode=this.parseTerm(),t.whereNodeEnd=this.getCurrentPosition(),this.module.addCompletionHint(t.whereNodeBegin,t.whereNodeEnd,t.tableIdentifier,!1,[]),t.endPosition=this.getCurrentPosition()}else this.comesToken(a.keywordWhere,!0);return t}parseCreateTableOrDatabaseOrView(){switch(this.ct[1].tt){case a.keywordDatabase:return this.parseCreateDatabase();case a.keywordTable:return this.parseCreateTable();case a.keywordView:return this.parseCreateView();case a.keywordSchema:default:return this.nextToken(),this.pushError("Nach 'create' wird 'table' erwartet."),this.nextToken(),null}}parseCreateDatabase(){let e={type:a.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};for(this.nextToken(),this.pushError("Die CREATE-DATABASE-Anweisung wird von der SQLite-Engine nicht unterstützt. Sie können eine neue Datenbank anlegen, indem Sie auf den entsprechenden Button oberhalb der Liste der Datenbanken (linke Seite des Fensters) klicken. Diese Anweisung wird überlesen.","info");this.tt!=a.semicolon&&this.tt!=a.endofSourcecode;)e.endPosition=this.getEndOfCurrentToken(),this.nextToken();return e}parseCreateView(){let e=this.getCurrentPosition();this.nextToken(),this.nextToken();let t=!1;this.comesToken(a.keywordIf)&&(this.nextToken(),this.expect(a.keywordNot,!0),this.expect(a.keywordExists,!0),t=!0);let i="";if(!this.expect(a.identifier,!1))return null;i=this.cct.value,this.nextToken();let r=[];if(this.comesToken(a.leftBracket,!0)){do this.expect(a.identifier,!1)&&r.push(this.cct.value),this.nextToken();while(this.comesToken(a.comma,!0));this.expect(a.rightBracket,!0)}if(!this.expect(a.keywordAs,!0))return this.module.addCompletionHint(this.getCurrentPosition(),this.getCurrentPositionPlus(2),!1,!1,["as"]),null;if(!this.expect(a.keywordSelect,!1))return this.module.addCompletionHint(this.getCurrentPosition(),this.getCurrentPositionPlus(2),!1,!1,["select"]),null;let o=this.parseSelect();return{type:a.keywordView,identifier:i,position:e,endPosition:this.getCurrentPosition(),symbolTable:null,ifNotExists:t,columnIdentifierList:r,selectStatement:o}}parseCreateTable(){let e=this.getCurrentPosition();this.nextToken(),this.expect(a.keywordTable,!0)||this.module.addCompletionHint(e,this.getCurrentPositionPlus(3),!1,!1,["table"]);let t=!1;this.comesToken(a.keywordIf)&&(this.nextToken(),this.expect(a.keywordNot,!0),this.expect(a.keywordExists,!0),t=!0);let i="";if(this.expect(a.identifier,!1)){i=this.cct.value;let f=this.getCurrentPosition(),g=this.getCurrentPositionPlus(i.length+3);this.nextToken(),this.comesToken(a.leftBracket)||this.module.addCompletionHint(f,g,!1,!1,["("])}let r={type:a.keywordCreate,identifier:i,position:e,endPosition:null,columnList:[],symbolTable:null,combinedPrimaryKeyColumns:[],foreignKeyInfoList:[],ifNotExists:t,uniqueConstraints:[]};if(!this.expect(a.leftBracket,!0))return r;let o=!1,u=!0;for(;this.tt!=a.rightBracket;){switch(u||this.expect(a.comma,!0),u=!1,this.comesToken(a.keywordConstraint,!0)&&(this.expect(a.identifier,!0),this.expect([a.keywordForeign,a.keywordPrimary,a.keywordUnique],!1)),this.tt){case a.keywordPrimary:o&&this.pushError("Je Tabelle darf nur ein einziger Primärschlüssel definiert werden.","error",this.getCurrentPosition()),this.parsePrimaryKeyTerm(o,r),o=!0;break;case a.keywordKey:this.nextToken(),this.comesToken(a.identifier,!0),this.comesToken(a.leftBracket,!0),this.comesToken(a.identifier,!0),this.comesToken(a.rightBracket,!0);break;case a.keywordUnique:this.parseUniqueTerm(r);break;case a.keywordForeign:let f=this.parseForeignKeyDefinition();f!=null&&r.foreignKeyInfoList.push(f);break;case a.identifier:let g=this.parseColumnDefinition(o);r.columnList.push(g),o=o||g.isPrimary;break;default:this.pushError(he[this.tt]+" wird hier nicht erwartet.","error");break}if(!this.comesToken(a.comma))break}for(this.expect(a.rightBracket,!0);[a.keywordAutoincrement,a.keywordEngine,a.keywordDefault,a.keywordCollate].indexOf(this.tt)>=0;)switch(this.tt){case a.keywordCollate:this.nextToken(),this.skip(a.equal),this.expect(a.identifier,!0);break;case a.keywordEngine:this.nextToken(),this.skip(a.equal),this.expect(a.identifier,!0);break;case a.keywordDefault:this.nextToken(),this.expect([a.keywordCharset,a.keywordCharacter],!0),this.skip(a.keywordSet),this.skip(a.equal),this.expect(a.identifier,!0);break;case a.keywordAutoincrement:this.nextToken(),this.expect(a.equal,!0),this.expect(a.integerConstant,!0);break}for(let f of r.columnList)f.isAutoIncrement&&!(f.isPrimary||r.combinedPrimaryKeyColumns.indexOf(f.identifier)>=0)&&this.pushError("autoincrement gibt es nur bei Primärschlüsseln, d.h. es fehlt wahrscheinlich 'primary key'.","warning",r.position);return r.endPosition=this.getCurrentPosition(),r}parsePrimaryKeyTerm(e,t){e&&this.pushError("Die Tabelle kann nur einen einzigen Primärschlüssel haben."),this.nextToken(),this.expect(a.keywordKey,!0);let i=t.columnList.map(r=>r.identifier);if(this.addCompletionHintHere(!1,!1,i),this.comesToken(a.leftBracket)){for(this.addCompletionHintHere(!1,!1,i),this.nextToken();;)if(this.comesToken(a.identifier))if(t.combinedPrimaryKeyColumns.push(this.cct.value),this.nextToken(),this.addCompletionHintHere(!1,!1,i,1),this.comesToken(a.comma))this.nextToken(),this.addCompletionHintHere(!1,!1,i);else break;else{this.pushError("Der Bezeichner einer Spalte wird erwartet. Gefunden wurde: "+this.cct.value);break}this.expect(a.rightBracket,!0)}else this.pushError("( erwartet.")}parseUniqueTerm(e){this.nextToken();let t=e.columnList.map(r=>r.identifier),i=[];if(e.uniqueConstraints.push(i),this.addCompletionHintHere(!1,!1,t),this.comesToken(a.leftBracket)){for(this.addCompletionHintHere(!1,!1,t),this.nextToken();;)if(this.comesToken(a.identifier))if(i.push(this.cct.value),this.nextToken(),this.addCompletionHintHere(!1,!1,t,1),this.comesToken(a.comma))this.nextToken(),this.addCompletionHintHere(!1,!1,t);else break;else{this.pushError("Der Bezeichner einer Spalte wird erwartet. Gefunden wurde: "+this.cct.value);break}this.expect(a.rightBracket,!0)}else this.pushError("( erwartet.")}parseColumnDefinition(e){let t=this.getCurrentPosition(),i=this.cct.value;this.nextToken();let r={type:a.columnDef,identifier:i,isPrimary:!1,isAutoIncrement:!1,position:t,baseType:null,notNull:!1};return this.parseType(r,e),r}addCompletionHintHere(e,t,i,r=0,o="",u=""){let f=this.lastToken.position,g=this.getCurrentPosition();g.column+=1+r,this.module.addCompletionHint(this.getEndOfPosition(f),g,e,t,i,null,o,u)}parseType(e,t){let i=K.baseTypes.map(u=>u.toString());if(this.addCompletionHintHere(!1,!1,i),!this.expect([a.identifier,a.keywordEnum],!1)){this.pushError("Erwartet wird ein Datentyp. Gefunden wurde: "+this.cct.value);return}let r;if(this.cct.tt==a.keywordEnum){if(this.nextToken(),this.expect(a.leftBracket,!0)){let u=[];for(;!this.comesToken(a.rightBracket,!0)&&!this.isEnd();){let f=this.parseConstant();f!=null&&u.push(f),this.comesToken(a.comma)&&this.nextToken()}if(u.length>0)switch(u[0].constantType){case a.integerConstant:case a.floatingPointConstant:r=new Vt(u.map(f=>f.constant));break;default:r=new Kt(u.map(f=>""+f.constant));break}else r=new Kt([]);e.baseType=r}}else{let u=this.cct.value,f=this.getCurrentPosition(),g=this.identifierMap[u.toLocaleLowerCase()];if(g!=null&&(u=g),r=K.getBaseType(u),r==null&&this.pushError("Erwartet wird ein Datentyp. Gefunden wurde: "+u),e.baseType=r,this.nextToken(),this.tt==a.leftBracket){for(this.nextToken(),e.parameters=[];this.tt==a.integerConstant&&(e.parameters.push(this.cct.value),this.nextToken(),this.tt==a.comma);)if(this.nextToken(),this.tt!=a.integerConstant){this.pushError("Erwartet wird eine ganze Zahl, gefunden wurde: "+this.cct.value);break}r!=null&&e.parameters.length>r.parameterDescriptions.length&&this.pushError("Der Datentyp "+r.toString()+" hat höchstens "+r.parameterDescriptions.length+" Parameter."),this.expect(a.rightBracket,!0)}if(u!=null&&e.parameters==null)switch(u.toLocaleLowerCase()){case"char":e.parameters=[1];break;case"varchar":e.parameters=[1],this.pushError("Hinter dem Datentyp varchar wird zwingend eine Längenangabe in Klammern erwaretet, also z.B. varchar(30)","error",f);break}}this.tt!=a.comma&&this.addCompletionHintHere(!1,!1,["primary key","references","not null"]);let o=[];for(;[a.keywordOn,a.keywordCharacter,a.keywordComment,a.keywordAutoincrement,a.keywordKey,a.keywordPrimary,a.keywordNot,a.keywordReferences,a.keywordCollate,a.keywordDefault].indexOf(this.tt)>=0;)switch(o.indexOf(this.tt)>=0&&this.pushError("Das Schlüsselwort "+he[this.tt]+" darf bei der Definition einer Spalte nicht öfters als ein Mal vorkommen."),o.push(this.tt),this.tt){case a.keywordAutoincrement:this.nextToken(),e.isAutoIncrement=!0,this.tt==a.equal?(this.nextToken(),this.expect(a.integerConstant)):this.tt==a.comma&&this.ct[1].tt==a.keywordAutoincrement&&this.nextToken();break;case a.keywordPrimary:t&&this.pushError("In einer Tabelle darf es nur einen einzigen primary key geben."),this.nextToken(),this.expect(a.keywordKey,!0)?this.comesToken(a.comma)||this.addCompletionHintHere(!1,!1,[`autoincrement, 
`]):this.addCompletionHintHere(!1,!1,["key"]),e.isPrimary=!0;break;case a.keywordReferences:let u={column:e.identifier,referencesColumn:"",referencesTable:"",referencesPosition:this.getCurrentPosition()};e.foreignKeyInfo=u,this.parseReferences(u);break;case a.keywordNot:this.nextToken(),this.expect(a.keywordNull,!0)?this.addCompletionHintHere(!1,!1,["references"]):this.addCompletionHintHere(!1,!1,["null"]),e.notNull=!0;break;case a.keywordCollate:this.nextToken(),e.collate=this.cct.value,this.expect(a.identifier,!0);break;case a.keywordCharacter:this.nextToken(),this.expect(a.keywordSet,!0),this.expect(a.identifier,!0);break;case a.keywordDefault:if(this.nextToken(),this.ct[1].tt==a.leftBracket&&this.ct[2].tt==a.rightBracket){this.nextToken(),this.nextToken(),this.nextToken();break}if(e.defaultValue=this.cct.value,typeof this.cct.value=="string"&&e.defaultValue.toLowerCase()!="null"&&(e.defaultValue="'"+e.defaultValue+"'"),this.tt==a.keywordNull){this.nextToken();break}else[a.identifier,a.integerConstant,a.floatingPointConstant,a.stringConstant].indexOf(this.tt)>=0&&(K.fromConstantType(this.tt).canCastTo(r)||this.pushError("Die Konstante hinter 'default' passt nicht zum Datentyp der Spalte."),this.nextToken());break;case a.keywordComment:this.nextToken(),this.expect(a.stringConstant,!0);break;case a.keywordOn:for(this.nextToken(),this.expect([a.keywordUpdate],!0);!this.comesToken([a.comma,a.endofSourcecode,a.rightBracket]);)this.nextToken();this.lastToken.tt==a.leftBracket&&this.tt==a.rightBracket&&this.nextToken();break}}parseInsert(){let e=this.getCurrentPosition(),t=e;this.nextToken(),this.expect(a.keywordInto,!0);let i={type:a.keywordInsert,position:e,endPosition:this.getCurrentPosition(),valuesPosition:null,columnsPosition:null,symbolTable:null,columnList:[],values:[],table:null};if(this.tt==a.identifier?(i.table={type:a.table,identifier:this.cct.value,alias:null,position:this.getCurrentPosition()},i.columnsPosition={line:i.table.position.line,column:i.table.position.column+i.table.position.length,length:0},this.nextToken()):this.pushError("Hier wird der Bezeichner einer Tabelle erwartet. Gefunden wurde: "+this.cct.value,"error"),this.tt==a.leftBracket){this.nextToken();let r=!0;for(;r||this.tt==a.comma;)r||this.nextToken(),r=!1,this.tt==a.identifier?i.columnList.push({type:a.identifier,identifier:this.cct.value+"",position:this.getCurrentPosition()}):this.pushError("Erwartet wird der Bezeichner einer Spalte. Gefunden wurde: "+this.cct.value,"error"),this.nextToken();t=this.getCurrentPosition(),this.expect(a.rightBracket,!0)}switch(i.valuesPosition=this.getCurrentPosition(),this.tt){case a.keywordValues:this.nextToken(),this.parseValueLists(i.values);break;case a.keywordSelect:case a.leftBracket:if(this.getCurrentPosition().line<=t.line+1){let r=this.parseSelect();i.select=r}break}return i.endPosition=this.getCurrentPosition(),i}parseValueLists(e){let t=[a.keywordNull,a.charConstant,a.stringConstant,a.booleanConstant,a.floatingPointConstant,a.integerConstant],i=!0;for(;i||this.tt==a.comma;){i||this.nextToken(),i=!1;let r=this.getCurrentPosition();if(!this.expect(a.leftBracket,!0))break;let o=[],u=!0;for(;u||this.tt==a.comma;){if(u||this.nextToken(),u=!1,this.tt==a.identifier)if(this.cct.isDoubleQuotedIdentifier)this.tt=a.stringConstant;else{let f=(this.cct.value+"").toLocaleLowerCase();["date","_binary"].indexOf(f)>=0&&this.nextToken()}t.indexOf(this.tt)<0?(this.pushError("Erwartet wird eine Konstante oder null. Gefunden wurde: "+this.cct.value,"error"),this.nextToken()):(o.push({constantType:this.tt,position:this.getCurrentPosition(),constant:this.cct.value,type:a.constantNode}),this.nextToken())}this.expect(a.rightBracket,!0),o.length==0?this.pushError("Eine Zeile kann nur dann in die Tabelle eingefügt werden, wenn sie mindestens einen Spaltenwert besitzt.","error",r):e.push(o)}}parseConstant(){let e={constantType:this.tt,position:this.getCurrentPosition(),constant:this.cct.value,type:a.constantNode};return this.nextToken(),e}parseSelect(){let e=this.getCurrentPosition();this.nextToken();let t={line:e.line,column:e.column+6,length:1},i={type:a.keywordSelect,position:e,endPosition:this.getCurrentPosition(),symbolTableEndPosition:this.getCurrentPosition(),symbolTable:null,columnList:[],fromNode:null,whereNode:null,parentStatement:null};i.columnList=this.parseColumnList([a.keywordFrom,a.semicolon,a.endofSourcecode],!0);let r=["distinct","as","*","from"];i.columnList.findIndex(f=>f.type==a.allColumns)>=0&&(r=["from"]),this.module.addCompletionHint(t,this.getCurrentPositionPlus(2),!0,!0,r);let o=this.comesToken(a.keywordFrom,!0),u=["where","join","left","right","inner","outer","natural","on","as",", "];if(!o)r.unshift("from");else{i.fromStartPosition={line:this.lastToken.position.line,column:this.lastToken.position.column+this.lastToken.position.length,length:0};let f=[];i.fromNode=this.parseTableOrSubQuery(f),u.splice(u.indexOf(this.lastToken.value+""),1);let g=this.getCurrentPositionPlus(2);this.comesToken(a.semicolon)&&(g=this.getCurrentPosition()),i.fromEndPosition=this.getCurrentPosition();let y=["like","union"];if(this.tt==a.keywordWhere){this.getCurrentPosition();let T=this.getCurrentPosition();this.nextToken(),i.whereNode=this.parseTerm(),this.module.addCompletionHint(T,this.getCurrentPositionPlus(4),!0,!0,y)}else u.push("where");let C=[];if(this.tt==a.keywordGroup){let T=this.getCurrentPosition();i.groupByNode=this.parseGroupBy(),this.module.addCompletionHint(T,this.getCurrentPosition(),!0,!0,C)}else y.push("group by");if(this.tt==a.keywordOrder){let T=this.getCurrentPosition();i.orderByNode=this.parseOrderBy(),this.module.addCompletionHint(T,this.getCurrentPosition(),!0,!0,["asc","desc"])}else y.push("order by"),C.push("order by");this.tt==a.keywordLimit&&(i.limitNode=this.parseLimit()),i.symbolTableEndPosition=this.getCurrentPosition(),this.comesToken(a.keywordUnion,!0)?this.expect(a.keywordSelect,!1)&&(i.union=this.parseSelect()):o&&i.fromNode!=null&&u.push("union"),this.module.addCompletionHint(i.fromStartPosition,g,!1,!0,u,f)}return i.endPosition=this.getCurrentPosition(),i.endPosition.column+=3,i}parseLimit(){let e=this.getCurrentPosition();this.nextToken();let t=this.parseTerm(),i={type:a.keywordLimit,position:e,numberOfRows:t};return this.tt==a.keywordOffset&&(this.nextToken(),i.offset=this.parseTerm()),i}parseGroupBy(){let e=this.getCurrentPosition();this.expect(a.keywordGroup,!0),this.expect(a.keywordBy,!0);let t={type:a.keywordGroup,columnList:[],position:e},i=[a.keywordHaving,a.keywordSelect,a.keywordOrder,a.keywordLimit,a.rightBracket,a.semicolon];return t.columnList=this.parseColumnList(i,!1).map(r=>r.term),this.tt==a.keywordHaving&&(this.nextToken(),t.having=this.parseTerm()),t}parseOrderBy(){this.expect(a.keywordOrder,!0),this.expect(a.keywordBy,!0);let e=[],t=!0;do{t?t=!1:this.expect(a.comma,!0);let i=this.parseTerm(),r={type:a.keywordOrder,position:this.getCurrentPosition(),column:i};[a.keywordAscending,a.keywordDescending].indexOf(this.tt)>=0&&this.nextToken(),this.tt==a.keywordNulls&&(this.nextToken(),this.expect([a.keywordFirst,a.keywordLast],!0)),e.push(r)}while(this.tt==a.comma);return e}parseTableOrSubQuery(e){let t=this.parseAtomicTableOrSubQuery(e),i=this.getCurrentPosition();for(;this.parseJoinOperator();){let r=this.parseAtomicTableOrSubQuery(e);t={type:a.keywordJoin,firstOperand:t,secondOperand:r,position:i},this.tt==a.keywordOn&&(this.nextToken(),t.on=this.parseTerm())}return t}parseJoinOperator(){if(this.tt==a.comma)return this.nextToken(),!0;switch(this.tt==a.keywordNatural&&this.nextToken(),this.tt){case a.keywordLeft:return this.nextToken(),this.tt==a.keywordOuter&&this.nextToken(),this.expect(a.keywordJoin,!0);case a.keywordInner:case a.keywordCross:return this.nextToken(),this.expect(a.keywordJoin,!0);case a.keywordJoin:return this.nextToken(),!0;default:return!1}}parseAtomicTableOrSubQuery(e){if(!this.expect([a.identifier,a.leftBracket],!1))return null;if(this.tt==a.leftBracket){this.nextToken();let t;if(this.tt==a.keywordSelect){let i=this.getCurrentPosition(),r=this.parseSelect();t={type:a.subquery,alias:null,position:i,query:r}}else t=this.parseTableOrSubQuery(e);return this.expect(a.rightBracket,!0),this.tt==a.keywordAs&&t.type==a.subquery&&(this.nextToken(),this.expect(a.identifier,!1)&&(t.alias=this.cct.value,this.nextToken(),e.push(t.alias))),t}if(this.tt==a.identifier){let t={type:a.table,identifier:this.cct.value,alias:null,position:this.getCurrentPosition()};e.push(t.identifier),this.nextToken();let i=this.tt==a.keywordAs;return(i||this.tt==a.identifier)&&(i&&this.nextToken(),this.expect(a.identifier,!1)&&(t.alias=this.cct.value,this.nextToken(),e.push(t.alias))),t}}parseColumnList(e,t){let i=[];for(;[a.stringConstant,a.integerConstant,a.floatingPointConstant,a.booleanConstant,a.identifier,a.multiplication,a.leftBracket,a.keywordDistinct].indexOf(this.tt)>=0;){if(this.tt==a.multiplication)i.push({term:null,alias:null,distinct:!1,position:this.getCurrentPosition(),type:a.allColumns}),this.nextToken();else{let r=this.comesToken(a.keywordDistinct,!0),o=this.parseTerm();if(o!=null){let u={type:a.column,term:o,distinct:r,position:o.position};i.push(u),(this.comesToken(a.keywordAs)||this.comesToken(a.identifier))&&(this.skip(a.keywordAs),this.expect(a.identifier,!1)&&(u.alias=""+this.cct.value),this.nextToken())}}if(e.indexOf(this.tt)>=0||this.isEnd())break;this.expect(a.comma,!0)}return i.length==0&&this.pushError("Es fehlt die kommaseparierte Liste der gewünschten Spalten.","error"),i}parseTerm(){return this.parseTermBinary(0)}parseTermBinary(e){let t;e<ut.operatorPrecedence.length-1?t=this.parseTermBinary(e+1):t=this.parseUnary();let i=ut.operatorPrecedence[e];if(t==null||i.indexOf(this.tt)<0)return t;let r=!0;if(this.tt==a.keywordBetween)return this.parseBetween(t);for(;r||i.indexOf(this.tt)>=0;){let o=this.tt;r=!1;let u=this.getCurrentPosition();this.nextToken();let f;e<ut.operatorPrecedence.length-1?f=this.parseTermBinary(e+1):f=this.parseUnary(),t={type:a.binaryOp,position:u,operator:o,firstOperand:t,secondOperand:f}}return t}parseBetween(e){let t=this.getCurrentPosition();this.nextToken();let i=this.parseTermBinary(2);if(this.expect(a.keywordAnd,!0)){let r=this.parseTermBinary(2);return{type:a.keywordBetween,position:t,firstOperand:e,secondOperand:i,thirdOperand:r}}return null}parseUnary(){let e,t=this.getCurrentPosition();switch(this.tt){case a.leftBracket:return this.parseBracket();case a.keywordNot:return t=t,this.nextToken(),e=this.parseTermBinary(2),{type:a.unaryOp,position:t,operand:e,operator:a.keywordNot};case a.minus:t=this.position;let i=this.tt;return this.nextToken(),e=this.parseUnary(),{type:a.unaryOp,position:t,operand:e,operator:i};case a.integerConstant:case a.charConstant:case a.floatingPointConstant:case a.stringConstant:case a.booleanConstant:e={type:a.constantNode,position:this.getCurrentPosition(),constantType:this.tt,constant:this.cct.value};let r=this.tt==a.stringConstant;return this.nextToken(),r?this.parseDotChains(e):e;case a.identifier:let o=this.cct.value,u=this.getCurrentPosition();if(this.nextToken(),this.tt==a.leftBracket){let f=this.parseMethodCallParameters(),g=f.rightBracketPosition;e={type:a.callMethod,position:u,rightBracketPosition:g,operands:f.nodes,identifier:o,commaPositions:f.commaPositions,distinctBeforeParameters:f.distinctBeforeParameters}}else if(e={type:a.identifier,identifier:o,position:t},this.tt==a.dot){let f=this.getCurrentPosition();this.nextToken(),this.expect(a.identifier,!1);let g={type:a.identifier,identifier:this.cct.value,position:this.getCurrentPosition()};this.nextToken(),e={type:a.dot,identifierLeft:e,identifierRight:g,position:f}}else[a.isNull,a.isNotNull].indexOf(this.tt)>=0&&(e={type:a.unaryOp,operand:e,operator:this.tt,position:t},this.nextToken());return e;default:return this.pushError("Erwartet wird eine Variable, ein Methodenaufruf oder eine Konstante. Gefunden wurde: "+this.cct.value),null}}parseList(){let e={type:a.list,position:this.getCurrentPosition(),elements:[]},t=[a.charConstant,a.stringConstant,a.booleanConstant,a.floatingPointConstant,a.integerConstant];for(;t.indexOf(this.tt)>=0&&(e.elements.push({type:a.constantNode,constant:this.cct.value,constantType:this.tt,position:this.cct.position}),this.nextToken(),this.tt==a.comma);)this.nextToken();return e}parseBracket(){this.getCurrentPosition();let e=this.lastToken;if(this.nextToken(),this.tt==a.keywordSelect){let t=this.parseSelect();return this.expect(a.rightBracket,!0),t}else if([a.comma,a.rightBracket].indexOf(this.ct[1].tt)>=0&&[a.keywordIn,a.keywordNotIn].indexOf(e.tt)>=0){let t=this.parseList();return this.expect(a.rightBracket,!0),t}else{let t=this.parseTerm(),i=this.getCurrentPosition();return this.expect(a.rightBracket,!0),{position:i,type:a.rightBracket,termInsideBrackets:t}}}parseMethodCallParameters(){this.nextToken();let e=this.comesToken(a.keywordDistinct,!0);if(this.tt==a.rightBracket){let u=this.getCurrentPosition();return this.nextToken(),{rightBracketPosition:u,nodes:[],commaPositions:[],distinctBeforeParameters:e}}let t=[],i=[];for(;;){let u=this.pos;if(this.tt==a.multiplication)this.nextToken(),t.push({type:a.allColumns,position:this.getCurrentPosition()});else{let f=this.parseTerm();f!=null&&t.push(f)}if(this.tt!=a.comma)break;i.push(this.getCurrentPosition()),this.nextToken(),this.pos==u&&this.nextToken()}let r=this.getCurrentPosition();return{rightBracketPosition:this.expect(a.rightBracket,!0)?r:null,nodes:t,commaPositions:i,distinctBeforeParameters:e}}parseDotChains(e){if(e==null)return null;for(;this.comesToken([a.dot]);)if(this.tt==a.dot){if(this.nextToken(),this.tt!=a.identifier)return this.pushError("Erwartet wird der Bezeichner eines Attributs oder einer Methode, gefunden wurde: "+this.cct.value),e;let t=this.cct.value,i=this.getCurrentPosition();if(this.nextToken(),this.tt==a.leftBracket){let r=this.parseMethodCallParameters();e={type:a.callMethod,position:i,rightBracketPosition:r.rightBracketPosition,operands:r.nodes,identifier:t,commaPositions:r.commaPositions,distinctBeforeParameters:r.distinctBeforeParameters}}}return e}};w(ut,"operatorPrecedence",[[a.keywordOr],[a.keywordAnd],[a.keywordBetween],[a.lower,a.lowerOrEqual,a.greater,a.greaterOrEqual,a.equal,a.notEqual,a.keywordLike],[a.concatenation,a.plus,a.minus],[a.multiplication,a.division,a.modulo],[a.keywordIn,a.keywordNotIn]]);let gi=ut;class Gt{constructor(e,t,i,r,o,u,f){w(this,"references");w(this,"fromColumnStructure");w(this,"notNull");this.identifier=e,this.type=t,this.table=i,this.isPrimaryKey=r,this.isNullable=o,this.defaultValue=u,this.isAutoIncrement=f}static fromColumnStructure(e,t){let i=/^(\w*) *(?:\((.*)\))?.*$/,r=e.completeTypeSQL.match(i),o=r[1],u=r[2],f=[];u!=null&&(f=u.split(",").map(C=>parseInt(C.trim())));let g;if(o.indexOf("Enum")>=0)switch(o){case"textEnum":g=new Kt(e.enumValues);break;case"realEnum":g=new Vt(e.enumValues.map(C=>Number.parseFloat(C)));break;case"integerEnum":g=new Vt(e.enumValues.map(C=>Number.parseInt(C)));break}else g=K.getBaseType(o);f.length>0&&g!=null&&(g=new zt(g,f));let y=new Gt(e.name,g,t,e.isPrimaryKey,!e.isPrimaryKey,e.defaultValue,e.isAutoIncrement);return y.notNull=e.notNull,y.fromColumnStructure=e,y}}class ct{constructor(e){w(this,"columns",[]);w(this,"size");w(this,"type");this.identifier=e}static fromTableStructure(e){let t=new ct(e.name);return t.columns=e.columns.map(i=>Gt.fromColumnStructure(i,t)),t.size=e.size,t.type=e.type,t}static fromTableStructureList(e){e==null&&(e=[]);let t=e.map(r=>ct.fromTableStructure(r)),i=new Map;for(let r of t)for(let o of r.columns)i.set(o.fromColumnStructure,o);for(let r of t)for(let o of r.columns){let u=o.fromColumnStructure.references;if(u!=null){let f=i.get(u);o.references=f}}return t}}class fi{constructor(e,t,i){w(this,"parent");w(this,"positionFrom");w(this,"positionTo");w(this,"childSymbolTables",[]);w(this,"symbols",new Map);w(this,"symbolList",[]);this.parent=e,this.positionFrom=t,this.positionTo=i,this.parent!=null&&this.parent.childSymbolTables.push(this)}extractDatabaseStructure(e){for(let t of ct.fromTableStructureList(e==null?void 0:e.tables))this.storeTableSymbols(t)}storeTableSymbols(e){this.storeSymbol({identifier:e.identifier,posOfDefinition:null,referencedOnPositions:[],table:e});for(let t of e.columns)this.storeSymbol({identifier:t.identifier,posOfDefinition:null,referencedOnPositions:[],column:t})}storeSymbol(e){let t=this.symbols.get(e.identifier.toLowerCase());t==null?(t=[e],this.symbols.set(e.identifier.toLowerCase(),t)):t.push(e),this.symbolList.push(e)}findTableAtPosition(e,t){if(!this.containsPosition(e,t))return null;let i=null,r=1e7;for(let o of this.childSymbolTables)if(o.containsPosition(e,t)){let u=o.findTableAtPosition(e,t);u.positionTo.line-u.positionFrom.line<r&&(i=u,r=u.positionTo.line-u.positionFrom.line)}return i??this}containsPosition(e,t){return!(e<this.positionFrom.line||e>this.positionTo.line||e==this.positionFrom.line&&t<this.positionFrom.column||e==this.positionTo.line&&t>this.positionTo.column+1)}findTable(e){let t=this.findTables(e);return t.length==0?null:t[0].table}findTables(e){let t=this;for(;t!=null;){let i=t.symbols.get(e.toLowerCase());if(i!=null&&(i=i.filter(r=>r.table!=null),i.length>0))return i;t=t.parent}return[]}findColumn(e){let t=this;for(;t!=null;){let i=t.symbols.get(e.toLowerCase());if(i!=null&&(i=i.filter(r=>r.column!=null),i.length>0))return i;t=t.parent}return[]}}class di{constructor(e,t){w(this,"type");this.identifier=e,this.type=K.getBaseType(t)}}class Ui{constructor(e,t,i,r){w(this,"acceptsStarParameter",!1);w(this,"returnType");this.identifier=e,this.isAggregating=t,this.parameters=r,this.returnType=K.getBaseType(i)}}const bi=class bi{constructor(){w(this,"methods",[]);this.pushOneParameterMethod("abs","float","float"),this.pushOneParameterMethod("sin","float","float"),this.pushOneParameterMethod("cos","float","float"),this.pushOneParameterMethod("tan","float","float"),this.pushOneParameterMethod("max","integer","integer"),this.pushOneParameterMethod("max","float","float"),this.pushOneParameterMethod("max","date","date"),this.pushOneParameterMethod("max","time","time"),this.pushOneParameterMethod("max","datetime","datetime"),this.pushOneParameterMethod("max","timestamp","timestamp"),this.pushOneParameterMethod("min","integer","integer"),this.pushOneParameterMethod("min","float","float"),this.pushOneParameterMethod("min","date","date"),this.pushOneParameterMethod("min","time","time"),this.pushOneParameterMethod("min","datetime","datetime"),this.pushOneParameterMethod("min","timestamp","timestamp"),this.pushOneParameterMethod("avg","integer","integer"),this.pushOneParameterMethod("avg","float","float"),this.pushOneParameterMethod("sum","float","float"),this.pushOneParameterMethod("sum","integer","integer"),this.pushOneParameterMethod("concat","text","text"),this.pushOneParameterMethod("upper","text","text"),this.pushOneParameterMethod("lower","text","text"),this.pushOneParameterMethod("length","integer","text"),this.pushOneParameterMethod("month","integer","date"),this.pushOneParameterMethod("day","integer","date"),this.pushOneParameterMethod("year","integer","date");let e=new Ui("count",!0,"integer",[new di("spalte","text")]);e.acceptsStarParameter=!0,this.methods.push(e);let t=new Ui("strftime",!1,"text",[new di("formatstring","text"),new di("date","date")]);t.acceptsStarParameter=!0,this.methods.push(t)}static getInstance(){return this.instance==null&&(this.instance=new bi),this.instance}getMethods(e){return this.methods.filter(t=>t.identifier==e.toLowerCase())}pushOneParameterMethod(e,t,i){this.methods.push(new Ui(e,!0,t,[new di("spalte",i)]))}};w(bi,"instance");let Gi=bi;function Xi(c){return c.replace(/['"]+/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Rs(c){return`${Vn(c.getDate())}.${Vn(c.getMonth())}.${c.getFullYear()}`}function Vn(c){return c<10?"0"+c:""+c}function qs(c){let e=c.match(/^(\d{2})\.(\d{2})\.(\d{4}), (\d{2}):(\d{2})$/);return new Date(Number.parseInt(e[3]),Number.parseInt(e[2]),Number.parseInt(e[1]),Number.parseInt(e[4]),Number.parseInt(e[5]))}function Qs(c){if(c==null||typeof c!="string")return!1;var e=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;if(c.match(e)){var t=c.split("/"),i=c.split("-"),r=t.length,o=i.length;if(r>1)var u=c.split("/");else if(o>1)var u=c.split("-");if(u.length!=3)return!1;var f=parseInt(u[2]),g=parseInt(u[1]),y=parseInt(u[0]),C=[31,28,31,30,31,30,31,31,30,31,30,31];if((g==1||g>2)&&f>C[g-1])return!1;if(g==2){var T=!1;return(!(y%4)&&y%100||!(y%400))&&(T=!0),!(T==!1&&f>=29||T==!0&&f>29)}return!0}else return!1}function Ws(c){if(c==null||typeof c!="string")return!1;var e=/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;if(c.match(e)){var t=c.split(" "),i=t[0];if(i.length!=10)return!1;var r=parseInt(i.substring(8,10)),o=parseInt(i.substring(5,7)),u=parseInt(i.substring(0,4)),f=[31,28,31,30,31,30,31,31,30,31,30,31];if((o==1||o>2)&&r>f[o-1])return!1;if(o==2){var g=!1;return(!(u%4)&&u%100||!(u%400))&&(g=!0),!(g==!1&&r>=29||g==!0&&r>29)}return!0}else return!1}function Hs(c){if(c==null||typeof c!="string")return!1;var e=/^([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;return c.match(e)!=null}class zs{constructor(e){w(this,"symbolTableStack",[]);w(this,"errorList");w(this,"module");w(this,"databaseTool");w(this,"tables");var t;this.databaseTool=e,this.tables=ct.fromTableStructureList((t=e.databaseStructure)==null?void 0:t.tables)}start(e){this.module=e,this.symbolTableStack=[],this.errorList=[],e.mainSymbolTable=new fi(null,{column:0,line:0,length:0},{column:0,line:1e5,length:0}),this.symbolTableStack.push(e.mainSymbolTable);for(let t of this.module.sqlStatements){let i=this.errorList.length,r=t.ast;if(r!=null){switch(r.type){case a.keywordSelect:this.resolveSelect(r,t.resultTypes),this.symbolTableStack.pop();break;case a.keywordInsert:this.resolveInsert(r),this.symbolTableStack.pop();break;case a.keywordCreate:this.resolveCreateTable(r),this.symbolTableStack.pop();break;case a.keywordUpdate:this.resolveUpdate(r),this.symbolTableStack.pop();break;case a.keywordDelete:this.resolveDelete(r),this.symbolTableStack.pop();break;case a.keywordDrop:this.resolveDropTable(r),this.symbolTableStack.pop();break;case a.keywordAlter:this.resolveAlterTable(r),this.symbolTableStack.pop();break;case a.keywordView:this.resolveCreateView(r),this.symbolTableStack.pop()}t.hasErrors=t.hasErrors||this.errorList.length>i}}e.errors[2]=this.errorList}pushError(e,t="error",i,r){this.errorList.push({text:e,position:i,quickFix:r,level:t})}getCurrentSymbolTable(){return this.symbolTableStack[this.symbolTableStack.length-1]}pushNewSymbolTable(e,t){t==null&&(t={line:1e5,column:1,length:1});let i=new fi(this.getCurrentSymbolTable(),e,t);return this.symbolTableStack.push(i),i}resolveSelect(e,t){let i=new ct(null);e.symbolTable=this.pushNewSymbolTable(e.position,e.symbolTableEndPosition);let r=[];this.resolveTableOrSubQuery(e.fromNode,r),e.fromStartPosition!=null&&new fi(this.getCurrentSymbolTable(),e.fromStartPosition,e.fromEndPosition).extractDatabaseStructure(this.databaseTool.databaseStructure);for(let o of e.columnList)if(o.type==a.allColumns)for(let u of r)for(let f of u.columns){let g=new Gt(f.identifier,f.type,i,!1,!0,f.defaultValue,f.isAutoIncrement);i.columns.push(g),t.push(f.type)}else{this.resolveTerm(o.term);let u=new Gt(o.alias,o.term.sqlType,i,!1,!0,null,!1);i.columns.push(u),t.push(o.term.sqlType),u.identifier!=null&&e.symbolTable.storeSymbol({identifier:u.identifier,posOfDefinition:o.term.position,referencedOnPositions:[],column:u})}if(e.whereNode!=null){let o=this.resolveTerm(e.whereNode);o!=null&&o.getBaseTypeName()!="boolean"&&this.pushError("Das Ergebnis des where-Teils einer select-Anweisung muss vom Typ boolean sein.","error",e.whereNode.position)}return e.union!=null&&(this.symbolTableStack.pop(),this.resolveSelect(e.union,[]).columns.length!=i.columns.length&&this.pushError("Die select-Anweisungen links und rechts vom Schlüsselwort 'union' müssen dieselbe Anzahl von Spalten besitzen.","error",e.symbolTableEndPosition)),i}resolveDropTable(e){e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),e.tableIdentifier!=null&&(e.ifExists||e.symbolTable.findTable(e.tableIdentifier)==null&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition))}resolveDelete(e){if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),e.tableIdentifier==null)return;let t=e.symbolTable.findTable(e.tableIdentifier);if(t==null&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition),e.whereNode!=null){let i=this.pushNewSymbolTable(e.whereNodeBegin,e.whereNodeEnd);t!=null&&i.storeTableSymbols(t),this.resolveTerm(e.whereNode),this.symbolTableStack.pop()}}resolveAlterTable(e){if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),e.tableIdentifier==null)return;let t=e.symbolTable.findTable(e.tableIdentifier);t==null&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition);let i=null;switch(e.oldColumnName!=null&&(i=t.columns.find(r=>r.identifier.toLocaleLowerCase()==e.oldColumnName.toLocaleLowerCase()),i==null&&this.pushError("Die Tabelle "+e.tableIdentifier+" hat keine Spalte mit dem Bezeichner "+e.oldColumnName,"error",e.oldColumnPosition)),e.kind){case"dropColumn":break;case"addColumn":let r=e.columnDef;if(r==null)break;if(r.foreignKeyInfo!=null&&r.baseType!=null){let o=r.foreignKeyInfo,u=this.getCurrentSymbolTable().findTables(o.referencesTable);if(u.length==1){let f=u[0].table,g=f.columns.find(y=>y.identifier==o.referencesColumn);g!=null&&g.type!=null&&(g.isPrimaryKey||this.pushError("Die referenzierte Spalte "+o.referencesTable+"."+o.referencesColumn+" ist kein Primärschlüssel.","warning",r.referencesPosition),g.type.canCastTo(r.baseType)||this.pushError("Der Datentyp "+r.baseType.toString()+" der Spalte "+r.identifier+" kann nich in den Datentyp "+g.type.toString()+" der referenzierten Spalte "+f.identifier+"."+g.identifier+" umgewandelt werden.","error",r.referencesPosition))}}break}}resolveUpdate(e){if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),e.tableIdentifier==null)return;let t=e.symbolTable.findTable(e.tableIdentifier);if(t==null)this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition);else{for(let i=0;i<e.columnIdentifiers.length;i++){let r=e.columnIdentifiers[i],o=e.columnIdentifierPositions[i],u=e.values[i];if(r==null||(t.columns.find(y=>y.identifier==r)==null&&this.pushError(r+" ist kein Bezeichner einer Spalte der Tabelle "+e.tableIdentifier+".","error",o),u==null))continue;this.pushNewSymbolTable(e.valuePosBegin[i],e.valuePosEnd[i]).storeTableSymbols(t),this.resolveTerm(u),this.symbolTableStack.pop()}e.whereNodeBegin!=null&&this.pushNewSymbolTable(e.whereNodeBegin,e.whereNodeEnd).storeTableSymbols(t),e.whereNode!=null&&this.resolveTerm(e.whereNode)}this.symbolTableStack.pop()}resolveCreateTable(e){e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure);let t={identifier:e.identifier,columns:null,size:0,type:"table"};t.columns=e.columnList.map(i=>({identifier:i.identifier,isNullable:!1,isPrimaryKey:i.isPrimary,isAutoIncrement:i.isAutoIncrement,notNull:!1,references:null,table:t,type:i.baseType,defaultValue:i.defaultValue})),e.symbolTable.storeTableSymbols(t);for(let i of e.columnList)if(e.columnList.filter(r=>r.identifier.toLocaleLowerCase()==i.identifier.toLocaleLowerCase()).length>1&&this.pushError("Der Spaltenbezeichner "+i.identifier+" darf in einer Tabelle nur ein einziges Mal verwendet werden","error",i.position),i.foreignKeyInfo!=null&&i.baseType!=null){let r=i.foreignKeyInfo,o=this.getCurrentSymbolTable().findTables(r.referencesTable);if(o.length==1){let u=o[0].table,f=u.columns.find(g=>g.identifier==r.referencesColumn);f!=null&&f.type!=null&&(f.isPrimaryKey||this.pushError("Die referenzierte Spalte "+r.referencesTable+"."+r.referencesColumn+" ist kein Primärschlüssel.","warning",i.referencesPosition),f.type.canCastTo(i.baseType)||this.pushError("Der Datentyp "+i.baseType.toString()+" der Spalte "+i.identifier+" kann nich in den Datentyp "+f.type.toString()+" der referenzierten Spalte "+u.identifier+"."+f.identifier+" umgewandelt werden.","error",i.referencesPosition))}}for(let i of e.foreignKeyInfoList){let r=e.columnList.find(u=>u.identifier==i.column);if(r==null)continue;let o=this.getCurrentSymbolTable().findTables(i.referencesTable);if(o.length==1){let u=o[0].table,f=u.columns.find(g=>g.identifier==i.referencesColumn);f!=null&&f.type!=null&&(f.isPrimaryKey||this.pushError("Die referenzierte Spalte "+i.referencesTable+"."+i.referencesColumn+" ist kein Primärschlüssel.","warning",i.referencesPosition),f.type.canCastTo(r.baseType)||this.pushError("Der Datentyp "+r.baseType.toString()+" der Spalte "+r.identifier+" kann nich in den Datentyp "+f.type.toString()+" der referenzierten Spalte "+u.identifier+"."+f.identifier+" umgewandelt werden.","error",i.referencesPosition))}}}resolveTableOrSubQuery(e,t){if(e!=null)switch(e.type){case a.table:let i=this.tables.filter(r=>r.identifier.toLowerCase()==e.identifier.toLowerCase());if(i.length==0)this.pushError(e.identifier+" ist nicht der Name einer Tabelle.","error",e.position);else if(i.length>1)this.pushError("Der Bezeichner "+e.identifier+" ist hier nicht eindeutig.","error",e.position);else{let r=i[0];t.push(r),this.storeTableIntoSymbolTable(r,e.position,e.alias)}break;case a.keywordJoin:this.resolveTableOrSubQuery(e.firstOperand,t),this.resolveTableOrSubQuery(e.secondOperand,t);break;case a.subquery:e.table=this.resolveSelect(e.query,[]),t.push(e.table),e.alias!=null&&(e.table.identifier=e.alias,this.storeTableIntoSymbolTable(e.table,e.position));break}}storeTableIntoSymbolTable(e,t,i){let r=this.getCurrentSymbolTable();r.storeSymbol({identifier:i==null?e.identifier.toLowerCase():i.toLowerCase(),posOfDefinition:t,table:e,referencedOnPositions:[]});for(let o of e.columns)r.storeSymbol({identifier:o.identifier.toLowerCase(),posOfDefinition:null,column:o,tableAlias:i,referencedOnPositions:[]})}resolveTerm(e){if(e==null)return null;switch(e.type){case a.keywordBetween:let t=this.resolveTerm(e.firstOperand),i=this.resolveTerm(e.secondOperand),r=this.resolveTerm(e.thirdOperand);return t==null||i==null||r==null?null:t.canCastTo(K.getBaseType("double"))?i.canCastTo(K.getBaseType("double"))?(r.canCastTo(K.getBaseType("double"))||this.pushError("Hier wird eine Zahl erwartet.","error",e.thirdOperand.position),K.getBaseType("boolean")):(this.pushError("Hier wird eine Zahl erwartet.","error",e.secondOperand.position),null):(this.pushError("Hier wird eine Zahl erwartet.","error",e.firstOperand.position),null);case a.binaryOp:if([a.keywordIn,a.keywordNotIn].indexOf(e.operator)>=0)return this.resolveNotIn(e);let o=this.resolveTerm(e.firstOperand),u=this.resolveTerm(e.secondOperand);if(o!=null&&u!=null){let y=o.getBinaryResultType(e.operator,u);return y==null&&this.pushError("Der Operator "+he[e.operator]+" ist für die Datentypen "+o.toString()+" und "+u.toString()+" nicht definiert.","error",e.position),e.sqlType=y,y}else return null;case a.unaryOp:let f=this.resolveTerm(e.operand);if(f!=null){let y=f.getUnaryResultType(e.operator);return y==null&&this.pushError("Der Operator "+he[e.operator]+" ist für einen Operanden des Datentyps "+f.toString()+" nicht definiert.","error",e.position),e.sqlType=y,y}else return null;case a.callMethod:return this.resolveMethodCall(e);case a.constantNode:return e.sqlType=K.fromConstantType(e.constantType),e.sqlType;case a.identifier:return this.resolveIdentifier(e);case a.dot:return this.resolveDot(e);case a.keywordSelect:let g=this.resolveSelect(e,[]);return g.columns.length!=1?(this.pushError("Die Ergebnistabelle einer Unterabfrage an dieser Stelle muss genau eine Spalte besitzen.","error",e.position),null):g.columns[0].type;case a.rightBracket:return e.sqlType=this.resolveTerm(e.termInsideBrackets),e.sqlType;case a.allColumns:this.pushError("Das Zeichen * kann hier nicht verwendet werden.","error",e.position);break;case a.list:this.pushError("Eine Liste wird hier nicht erwartet.","error",e.position);break}}resolveDot(e){let t=this.getCurrentSymbolTable().findTables(e.identifierLeft.identifier);if(t.length==0)return this.pushError("Die Tabelle "+e.identifierLeft.identifier+" kann nicht gefunden werden.","error",e.identifierLeft.position),null;if(t.length>1)return this.pushError("Der Tabellenbezeichner "+e.identifierLeft.identifier+" ist nicht eindeutig.","error",e.identifierLeft.position),null;let r=t[0].table.columns.filter(u=>u.identifier.toLowerCase()==e.identifierRight.identifier.toLowerCase());if(r.length==0){this.pushError("Die Tabelle "+e.identifierLeft.identifier+" hat keine Spalte mit dem Bezeichner "+e.identifierRight.identifier+".","error",e.identifierRight.position);return}if(r.length>1){this.pushError("Die Tabelle "+e.identifierLeft.identifier+" hat mehrere Spalten mit dem Bezeichner "+e.identifierRight.identifier+".","error",e.identifierRight.position);return}let o=r[0];return e.sqlType=o.type,o.type}resolveIdentifier(e){let t=this.getCurrentSymbolTable().findColumn(e.identifier);if(t.length==0)return this.pushError("Der Bezeichner "+e.identifier+" ist an dieser Stelle nicht bekannt.","error",e.position),null;if(t.length>1)return this.pushError("Der Bezeichner "+e.identifier+" ist nicht eindeutig.","error",e.position),null;let i=t[0];return e.sqlType=i.column.type,i.column.type}resolveMethodCall(e){let i=Gi.getInstance().getMethods(e.identifier);if(e.identifier.toLocaleLowerCase()=="concat"){if(e.operands.length==0)return this.pushError("Die Methode concat benötigt mindestens einen Parameter.","error",e.position),null;let r=i[0];return e.sqlType=r.returnType,e.sqlType}else{let r=e.identifier.toLocaleLowerCase()=="count";if(r||(i=i.filter(o=>o.parameters.length==e.operands.length)),e.operands.length==1&&e.operands[0].type==a.allColumns)return i=i.filter(o=>o.acceptsStarParameter),e.sqlType=i[0].returnType,e.sqlType;if(i.length==0)return this.pushError("Es gibt keine passende Methode mit dem Bezeichner '"+e.identifier+"'.","error",e.position),null;for(let o of e.operands)if(this.resolveTerm(o)==null)return e.sqlType=i[0].returnType,e.sqlType;for(let o of i){let u=!0;for(let f=0;f<o.parameters.length;f++){let g=o.parameters[f];if(!e.operands[f].sqlType.canCastTo(g.type)){u=!1;break}}if(u||r)return e.sqlType=o.returnType,e.sqlType}return this.pushError("Es gibt keine passende Methode mit dem Bezeichner '"+e.identifier+"'.","error",e.position),null}}resolveNotIn(e){if(e.firstOperand==null||e.secondOperand==null)return null;let t=he[e.operator];this.resolveTerm(e.firstOperand);let i=e.firstOperand.sqlType;if(i!=null)if(e.secondOperand.type==a.keywordSelect){let r=e.secondOperand;r.columnList.length!=1&&this.pushError("Wenn rechts vom Operator '"+t+"' eine Unterabfrage steht, muss die Ergebnistabelle dieser Unterabfrage genau eine Spalte haben.","error",r.position),this.resolveSelect(r,[]);let o=r.columnList[0].term.sqlType;o.canCastTo(i)||this.pushError("Der Datentyp der Ergebnisspalte der Unterabfrage ist "+o.toString()+". Dieser kann nicht in den Datentyp "+i.toString()+" umgewandelt werden.","error",r.position)}else if(e.secondOperand.type==a.list){let r=e.secondOperand;for(let o of r.elements){let u=K.fromConstantType(o.constantType);o.sqlType=u,u.canCastTo(i)||this.pushError("Der Datentyp des Listenelements "+o.constant+" ist "+u.toString()+". Er kann nicht in den Datentype "+i.toString()+" des Operanden auf der linken Seite des Operators '"+t+"' umgewandelt werden.","error",o.position)}}else this.pushError("Der rechte Operand der Operatoren 'in' und 'not in' muss eine Unterabfrage oder eine Liste sein.","error",e.secondOperand.position);return K.getBaseType("boolean")}resolveCreateView(e){let t=this.pushNewSymbolTable(e.position,e.endPosition);this.resolveSelect(e.selectStatement,[]),t.childSymbolTables.push(this.symbolTableStack.pop())}resolveInsert(e){let t=null,i=this.pushNewSymbolTable(e.position,e.endPosition);e.table!=null&&(e.table.table=this.tables.find(f=>f.identifier.toLowerCase()==e.table.identifier.toLocaleLowerCase()),e.table.table==null?this.pushError("Die Tabelle "+e.table.identifier+" gibt es nicht.","error",e.table.position):(t=e.table.table,i.storeTableSymbols(t)));let r=e.endPosition;e.valuesPosition!=null&&(r=e.valuesPosition),e.columnsPosition!=null&&(r=e.columnsPosition),this.module.addCompletionHint(e.position,r,!1,!0,["into","values"]),t!=null&&this.module.addCompletionHint(r,e.valuesPosition==null?e.endPosition:e.valuesPosition,!0,!1,["values"]),this.pushNewSymbolTable(e.position,r).extractDatabaseStructure(this.databaseTool.databaseStructure);let u=[];if(e.columnList.length==0)t!=null&&(u=t.columns);else if(t!=null)for(let f of e.columnList){let g=t.columns.find(y=>y.identifier.toLowerCase()==f.identifier.toLowerCase());g==null?this.pushError("Die Tabelle "+t.identifier+" besitzt keine Spalte mit dem Bezeichner "+f.identifier+".","error",f.position):u.push(g)}if(u.length>0)if(e.select!=null){let f=this.resolveSelect(e.select,[]);if((f==null?void 0:f.columns)!=null)if(u.length!=f.columns.length)this.pushError("Die insert-Anweisung erwartet "+u.length+" Werte je Datensatz, die select-Anweisung liefert aber "+f.columns.length+".","error",e.position);else for(let g=0;g<u.length;g++){let y=u[g],C=f.columns[g];y.type!=null&&C.type!=null&&(C.type.canCastTo(y.type)||this.pushError("Der Datentyp "+C.type.toString()+" der "+(g+1)+"-ten Spalte des select-Terms kann nicht in den Datentyp "+y.type.toString()+" der entsprechenden Spalte der insert-Anweisung umgewandelt werden.","error",e.position))}}else for(let f of e.values)if(f.length!=u.length&&f.length>0)this.pushError("Erwartet werden "+u.length+" Elemente, hier stehen aber "+f.length+" Elemente in der Liste.","error",f[0].position);else for(let g=0;g<f.length;g++){let y=f[g],C=u[g];y.sqlType=K.fromConstantType(y.constantType);let T=C.type.toString().toLocaleLowerCase();if(y.constantType==a.keywordNull)(!C.isNullable||C.notNull)&&this.pushError("Die Spalte "+C.identifier+" ist nicht nullable, daher kann null hier nicht eingefügt werden.","error",y.position);else if(y.sqlType.canCastTo(C.type)){if(T=="date"){if(!Qs(y.constant)){let D=`'${y.constant}' ist kein date-Wert.<br><b>Tipp: </b>Datumswerte haben die Form 'yyyy-mm-dd', also z.B. '2022-06-15'.`;this.pushError(D,"error",y.position)}}else if(T=="datetime"||T=="timestamp"){if(!Ws(y.constant)){let D=`'${y.constant}' ist kein ${T}-Wert.<br><b>Tipp: </b>Timestamps haben die Form 'yyyy-mm-dd hh:min:ss', also z.B. '2022-06-15 07:56:22'.`;this.pushError(D,"error",y.position)}}else if(T=="time"&&!Hs(y.constant)){let D=`'${y.constant}' ist kein ${T}-Wert.<br><b>Tipp: </b>Time-Werte haben die Form 'hh:min:ss', also z.B. '07:56:22'.`;this.pushError(D,"error",y.position)}}else{let D="Der Wert "+y.constant+" vom Datentyp "+y.sqlType.toString()+" kann nicht in den Datentyp "+C.type.toString()+" der Spalte "+C.identifier+" umgewandelt werden.";T=="date"&&(D+="<br><b>Tipp: </b>Datumswerte haben die Form 'yyyy-mm-dd', also z.B. '2022-06-15'."),(T=="datetime"||T=="timestamp")&&(D+="<br><b>Tipp: </b>Timestamps haben die Form 'yyyy-mm-dd hh:min:ss', also z.B. '2022-06-15 07:56:22'."),this.pushError(D,"error",y.position)}}this.symbolTableStack.pop()}}var Zi=(c=>(c[c.compiling=0]="compiling",c[c.error=1]="error",c[c.compiledButNothingToRun=2]="compiledButNothingToRun",c[c.readyToRun=3]="readyToRun",c))(Zi||{});class Us{constructor(e){w(this,"compilerStatus",2);w(this,"atLeastOneModuleIsStartable");this.main=e}compile(e){this.compilerStatus=0;let t=performance.now(),i=new tn;for(let y of e.getModules(!1)){y.file.dirty=!1,y.clear();let C=i.lex(y.getProgramTextFromMonacoModel());y.errors[0]=C.errors,y.tokenList=C.tokens,y.bracketError=C.bracketError}this.main.getSemicolonAngel().startRegistering();let r=new gi;for(let y of e.getModules(!1))r.parse(y);let o=this.main.getDatabaseTool(),u=new zs(o);for(let y of e.getModules(!1))u.start(y);let f=performance.now()-t;f=Math.round(f*100)/100;let g="Compiled in "+f+" ms.";return this.main.getCurrentWorkspace().compilerMessage=g,this.main.getSemicolonAngel().healSemicolons(),this.compilerStatus=3,null}}const it=class it{constructor(e,t){w(this,"file");w(this,"uri");w(this,"model");w(this,"oldErrorDecorations",[]);w(this,"lastSavedVersionId");w(this,"editorState");w(this,"errors",[[],[],[],[]]);w(this,"tokenList");w(this,"sqlStatements");w(this,"mainSymbolTable");w(this,"identifierPositions",{});w(this,"methodCallPositions",{});w(this,"bracketError");w(this,"completionHints",new Map);if(this.main=t,e==null||this.main==null)return;this.file=e;let i=e.name,r=it.uriMap[i];r==null?r=0:r++,it.uriMap[i]=r,r>0&&(i+=" ("+r+")"),this.uri=monaco.Uri.from({path:i,scheme:"inmemory"});let o=e.text.replaceAll("&#x27;","'").replaceAll("&quot;",'"').replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll(/&amp;/g,"&");this.model=monaco.editor.createModel(o,"vscSQL",this.uri),this.model.updateOptions({tabSize:3}),this.lastSavedVersionId=this.model.getAlternativeVersionId();let u=this;this.model.onDidChangeContent(()=>{let f=u.model.getAlternativeVersionId();if(f!=u.lastSavedVersionId&&(u.file.dirty=!0,u.file.saved=!1,u.lastSavedVersionId=f),!u.main.isEmbedded()){let g=t;g.workspacesOwnerId!=g.user.id?(u.file.text_before_revision==null||u.file.student_edited_after_revision)&&(u.file.student_edited_after_revision=!1,u.file.text_before_revision=u.file.text,u.file.saved=!1,g.networkManager.sendUpdates(null,!1),g.bottomDiv.homeworkManager.showHomeWorkRevisionButton(),g.projectExplorer.renderHomeworkButton(u.file)):u.file.student_edited_after_revision=!0}})}addCompletionHint(e,t,i,r,o,u,f="",g=""){let y={fromColumn:e.column,fromLine:e.line,toColumn:t.column,toLine:t.line,hintColumns:typeof i=="boolean"?i:!0,hintColumnsOfTable:typeof i=="string"?i:null,hintTables:r,hintKeywords:o==null?null:o.map(C=>C.toUpperCase()),dontHint:u,praefix:f,suffix:g};for(let C=y.fromLine;C<=y.toLine;C++){let T=this.completionHints.get(C);T==null&&(T=[],this.completionHints.set(C,T)),T.push(y)}}getSQLSTatementsAtSelection(e){let t={line:e.startLineNumber,column:e.startColumn},i={line:e.endLineNumber,column:e.endColumn};return this.sqlStatements==null?[]:this.sqlStatements.filter(r=>!(this.compare(r.to,t)<0||this.compare(r.from,i)>0))}compare(e,t){return e.line>t.line?1:e.line<t.line?-1:e.column>t.column?1:e.column<t.column?-1:0}getSQLStatementAtPosition(e){return this.sqlStatements.find(t=>!(t.from.line>e.lineNumber||t.from.line==e.lineNumber&&t.from.column>e.column||t.to.line<e.lineNumber||t.to.line==e.lineNumber&&t.to.column<e.column))}getCompletionHint(e,t){let i=this.completionHints.get(e);if(i==null||i.length==0)return null;let r=e*1e3+t;if(i=i.filter(f=>r>=f.fromLine*1e3+f.fromColumn&&r<=f.toLine*1e3+f.toColumn),i.length==0)return;let o=i[0],u=(o.toLine-o.fromLine)*1e3+(o.toColumn-o.fromColumn);for(let f=1;f<i.length;f++){let g=i[f],y=(g.toLine-g.fromLine)*1e3+(g.toColumn-g.fromColumn);y<u&&(o=g,u=y)}return o}static restoreFromData(e,t){let i={name:e.name,text:e.text,text_before_revision:e.text_before_revision,submitted_date:e.submitted_date,student_edited_after_revision:!1,dirty:!0,saved:!0,version:e.version,id:e.id};return new it(i,t)}getFileData(e){let t=this.file;return{id:t.id,name:t.name,text:t.text,text_before_revision:t.text_before_revision,submitted_date:t.submitted_date,student_edited_after_revision:t.student_edited_after_revision,version:t.version,workspace_id:e.id,forceUpdate:!1,file_type:11}}findSymbolTableAtPosition(e,t){return this.mainSymbolTable==null?null:((e>this.mainSymbolTable.positionTo.line||e==this.mainSymbolTable.positionTo.line&&t>this.mainSymbolTable.positionTo.column)&&(e=this.mainSymbolTable.positionTo.line,t=this.mainSymbolTable.positionTo.column-1),this.mainSymbolTable.findTableAtPosition(e,t))}getErrorCount(){let e=0;for(let t of this.errors)t.forEach(i=>e+=i.level=="error"?1:0);return e}getProgramTextFromMonacoModel(){return this.model.getValue(monaco.editor.EndOfLinePreference.LF,!1)}addIdentifierPosition(e,t){let i=this.identifierPositions[e.line];i==null&&(i=[],this.identifierPositions[e.line]=i),i.push({position:e,element:t})}getElementAtPosition(e,t){let i=this.identifierPositions[e];if(i==null)return null;let r=null;for(let o of i)t>=o.position.column&&t<o.position.column+o.position.length&&o.position.length>0&&r==null&&(r=o);return r==null?null:r.element}copy(){let e=new it(this.file,this.main);return e.model=this.model,e.mainSymbolTable=this.mainSymbolTable,this.mainSymbolTable=null,this.file.dirty=!0,e}clear(){this.identifierPositions={},this.file!=null&&this.file.dirty&&(this.tokenList=null,this.errors[0]=[],this.errors[1]=[]),this.errors[2]=[],this.errors[3]=[],this.mainSymbolTable=new fi(null,{line:1,column:1,length:1},{line:1e5,column:1,length:0}),this.methodCallPositions={}}hasErrors(){for(let e of this.errors)if(e.find(t=>t.level=="error"))return!0;return!1}getSortedAndFilteredErrors(){let e=[];for(let t of this.errors)e=e.concat(t);e.sort((t,i)=>t.position.line>i.position.line?1:i.position.line>t.position.line?-1:t.position.column>=i.position.column?1:-1);for(let t=0;t<e.length-1;t++){let i=e[t],r=e[t+1];i.position.line==r.position.line&&i.position.column+10>r.position.column&&(this.errorLevelCompare(i.level,r.level)==1?e.splice(t+1,1):e.splice(t,1),t--)}return e}errorLevelCompare(e,t){return e=="error"?1:t=="error"?2:e=="warning"?1:t=="warning"?2:1}};w(it,"maxUriNumber",0),w(it,"uriMap",{});let dt=it;class nn{constructor(e){w(this,"modules",[]);w(this,"moduleMap",new Map);w(this,"dirty",!1);this.main=e}findModuleById(e){for(let t of this.modules)if(t.file.id==e)return t;return null}copy(){let e=new nn(this.main);for(let t of this.modules)e.putModule(t.copy());return e}findModuleByFile(e){for(let t of this.modules)if(t.file==e)return t;return null}hasErrors(){for(let e of this.modules)if(e.hasErrors())return!0;return!1}getFirstModule(){if(this.modules.length>0)for(let e of this.modules)return e;return null}isDirty(){if(this.dirty)return this.dirty=!1,!0;let e=!1;for(let t of this.modules)if(t.file.dirty){e=!0;break}return e}getModules(e,t){let i=[];for(let r of this.modules)r.file.name!=t&&i.push(r);return i}putModule(e){this.modules.push(e),this.moduleMap[e.file.name]=e}removeModuleWithFile(e){for(let t of this.modules)if(t.file==e){this.removeModule(t);break}}removeModule(e){this.modules.indexOf(e)<0||(this.modules.splice(this.modules.indexOf(e),1),this.moduleMap[e.file.name]=void 0,this.dirty=!0)}getModule(e){return this.moduleMap[e]}}function Vs(c,e,t,i=null){let r=window.PointerEvent?"pointer":"mouse";e==null&&(e=c);let o=jQuery('<input type="text" class="jo_inplaceeditor" spellcheck="false">');o.css({width:e.css("width"),height:e.css("height"),color:e.css("color"),position:e.css("position"),"background-color":e.css("background-color"),"font-size":e.css("font-size"),"font-weight":e.css("font-weight"),"box-sizing":"border-box"}),o.val(c.text()),o.on(r+"down",u=>{u.stopPropagation()}),i!=null&&o[0].setSelectionRange(i.start,i.end),e.after(o),e.hide(),setTimeout(()=>{o.focus()},300),o.on("keydown.me",u=>{if(u.key=="Enter"||u.key=="Escape"){o.off("keydown.me"),o.off("focusout.me"),o.remove(),e.show();let f=Xi(o.val());t(f);return}}),o.on("focusout.me",u=>{o.off("keydown.me"),o.off("focusout.me"),o.remove(),e.show();let f=Xi(o.val());t(f)})}function Tt(c,e,t){let i=window.PointerEvent?"pointer":"mouse",r=jQuery('<div class="jo_contextmenu"></div>'),o=null,u=null;for(let D of c){let Q=D.caption;D.link!=null&&(Q=`<a href="${D.link}" target="_blank" class="jo_menulink">${D.caption}</a>`);let N=jQuery("<div>"+Q+(D.subMenu!=null?'<span style="float: right"> &nbsp; &nbsp; &gt;</span>':"")+"</div>");if(D.color!=null&&N.css("color",D.color),D.link==null)N.on(i+"up.contextmenu",M=>{M.stopPropagation(),jQuery(".jo_contextmenu").remove(),jQuery(document).off(i+"up.contextmenu"),jQuery(document).off(i+"down.contextmenu"),jQuery(document).off("keydown.contextmenu"),D.callback()}),N.on(i+"down.contextmenu",M=>{M.stopPropagation()});else{let M=N.find("a");M.on(i+"up",H=>{H.stopPropagation(),setTimeout(()=>{N.hide()},500)}),M.on(i+"down",H=>{H.stopPropagation()})}N.on(i+"move.contextmenu",()=>{D!=u&&o!=null&&(o.remove(),u=null,o=null),D.subMenu!=null&&(o=Tt(D.subMenu,N.offset().left+N.width(),N.offset().top))}),r.append(N)}jQuery(document).on(i+"down.contextmenu",D=>{jQuery(document).off(i+"down.contextmenu"),jQuery(document).off("keydown.contextmenu"),jQuery(".jo_contextmenu").remove()}),jQuery(document).on("keydown.contextmenu",D=>{D.key=="Escape"&&(jQuery(document).off(i+"up.contextmenu"),jQuery(document).off("keydown.contextmenu"),jQuery(".jo_contextmenu").remove())});let f=e>window.innerWidth*.8?"right":"left",g=e>window.innerWidth*.8?window.innerWidth-e:e,y=t>window.innerHeight*.8?"bottom":"top",C=t>window.innerHeight*.8?window.innerHeight-t:t,T={};return T[f]=g+"px",T[y]=C+"px",r.css(T),jQuery("body").append(r),r.show(),r}function rn(c){let e=c.find(".jo_tabheadings>div").not(".jo_noHeading"),t=c.find(".jo_tabs>div"),i=window.PointerEvent?"pointer":"mouse";e.on(i+"down",r=>{let o=jQuery(r.target);e.removeClass("jo_active"),o.addClass("jo_active");let u=c.find("."+o.data("target"));t.removeClass("jo_active"),t.trigger("myhide"),u.addClass("jo_active"),u.trigger("myshow")})}function Ct(c,e="",t="",i){let r="";e!=null&&e!=""&&(r+=` class="${e}"`);let o=jQuery(`<div${r}></div>`);return t!=null&&t!=""&&o.text(t),o}var pi=!1;function Ks(){matchMedia("(pointer:fine)").matches&&(pi=!0)}function Kn(c,e,t,i){let r="rgba("+t[0]+", "+t[1]+", "+t[2]+", ",o=1,u=o/(i/20),f=()=>{c.css(e,r+o+")"),o-=u,o<0?c.css(e,""):setTimeout(f,20)};f()}function sn(c,e,t=!1){var i=t?c:new Blob([typeof c=="string"?c:JSON.stringify(c)],{type:"text/plain"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,e);else{var r=document.createEvent("MouseEvents"),o=document.createElement("a");o.download=e,o.href=window.URL.createObjectURL(i),console.log(o.href),o.dataset.downloadurl=["text/plain",o.download,o.href].join(":"),r.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r),o.remove()}}function Gs(c){var e=document.createElement("textarea");e.value=c,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var t=document.execCommand("copy")}catch(i){console.error("Fallback: Oops, unable to copy",i)}document.body.removeChild(e)}function rr(c){if(!navigator.clipboard){Gs(c);return}navigator.clipboard.writeText(c).then(function(){},function(e){console.error("Async: Could not copy text: ",e)})}function Xs(c){const e=new RegExp(`(^| )${c}=([^;]+)`),t=document.cookie.match(e);if(t)return t[2]}class sr{constructor(e,t){w(this,"$dialog");this.main=e,this.workspace=t,this.init()}init(){this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery(`<div class="jo_ds_heading">Datenbank-Einstellungen</div>
            <div style="width: 100%; padding-left: 10px; box-sizing: border-box">
                <div class="jo_ds_settings" style="margin-left: 0px">
                <div class="jo_ds_settings_caption">Name der Datenbank:</div><div><input class="dialog-input jo_databasename" value="Neue Datenbank"></input></div>
                </div>

                <div class="jo_ds_settings_caption"> Eigentümer/in: <span class='jo_ds_settings_owner' style='font-weight: normal' ></span></div>
                <div class="jo_ds_settings_caption" style="margin-top: 20px">
                <div class="jo_ds_settings_caption" style="margin-top: 20px">
                    Beschreibung:
                </div>
                <div>
                    <textarea class="jo_ds_settings_description" maxlength="5000"></textarea>
                </div>

                <div id="jo_ds_ownerSettings">
                <div class="jo_ds_settings_caption" style="margin-top: 20px">
                    Zugriffscodes für andere Benutzer:
                    </div>
                                    
                    <div>
                        <table class="jo_ds_secret_table">
                        <tr>
                            <td>Nur Lesen:</td><td class="jo_ds_secret jo_ds_secret_read"></td><td id="copySecretTdread"></td><td><button class="jo_small_button jo_button_code_read">Neuen Code generieren</button></td>
                        <tr>
                            <td>Lesen und schreiben:</td><td class="jo_ds_secret jo_ds_secret_write"></td><td id="copySecretTdwrite"></td><td><button class="jo_small_button jo_button_code_write">Neuen Code generieren</button></td>
                        </tr>
                        <tr>
                            <td>Lesen, schreiben und Struktur verändern:</td><td class="jo_ds_secret jo_ds_secret_ddl"></td><td id="copySecretTdddl"></td><td><button class="jo_small_button jo_button_code_ddl">Neuen Code generieren</button></td>
                        </tr>
                        </table>
                    </div>


                    <div class="jo_ds_settings_caption" style="margin-top: 20px">
                    Datenbank freigeben als Vorlage für andere Benutzer:
                    </div>

                    <fieldset id="jo_ds_publishedTo">
                        <input type="radio" id="b0" name="publishedFilter" value="0" checked="checked"><label for="b0">Keine Freigabe</label>
                        <input type="radio" id="b1" name="publishedFilter" value="1"><label for="b1">Freigabe für meine Klasse(n)</label>
                        <input type="radio" id="b2" name="publishedFilter" value="2" style="visibility: none"><label id="lb2" for="b2" style="visibility: none">Freigabe für meine Schule</label>
                        <input type="radio" id="b3" name="publishedFilter" value="3" style="visibility: none"><label id="lb3" for="b3" style="visibility: none">Freigabe für alle Schulen</label>
                    </fieldset>

                    <div class="jo_ds_settings_caption" style="margin-top: 5px">
                    Wichtiger Hinweis:
                    </div>
                    <div style="font-weight: normal">
                    Beim erstmaligen Freigeben wird der aktuelle Zustand der Datenbank als Vorlage für andere Benutzer/innen hochgeladen und bereitgestellt. Änderungen, die danach 
                    in der Datenbank vorgenommen werden, werden nur dann in die Vorlage integriert, wenn explizit "Datenbank -> Aktuellen Zustand als Vorlage hochladen" aufgerufen wird.
                    </div>
                </div>
            </div>


             <div class="dialog-buttonRow jo_ds_buttonRow">
                <button id="jo_ds_cancel_button">Abbrechen</button>
                <button id="jo_ds_save_button">Speichern</button>
             </div>
            `));let e=this;this.$dialog.css("visibility","visible"),this.main.user.is_teacher||(jQuery("#b2").next().remove(),jQuery("#b2").remove()),this.main.user.is_admin||this.main.user.username=="DB-Vorlagen"||(jQuery("#b3").next().remove(),jQuery("#b3").remove()),jQuery("#jo_ds_cancel_button").on("click",()=>{this.showMainWindow()}),jQuery("#jo_ds_save_button").on("click",()=>{this.saveNameAndPublishedTo()}),this.setValues(),["read","write","ddl"].forEach(t=>{jQuery(".jo_button_code_"+t).on("pointerdown",()=>{e.main.networkManager.setNewSecret(e.workspace.id,t,r=>{jQuery(".jo_ds_secret_"+t).text(r)})});let i=jQuery('<button class="jo_small_button jo_copy_secret_button jo_active">Kopieren</button>');jQuery("#copySecretTd"+t).append(i),i.on("pointerdown",()=>{rr(jQuery(".jo_ds_secret_"+t).text())})})}saveNameAndPublishedTo(){let e=0;jQuery("#jo_ds_publishedTo").find("input").each((o,u)=>{let f=jQuery(u);u.checked&&(e=Number.parseInt(f.attr("value")))});let t=jQuery(".jo_databasename").val(),i=jQuery(".jo_ds_settings_description").val();this.workspace.name=t,this.workspace.panelElement.$htmlFirstLine.find(".jo_filename").text(t),this.workspace.saved=!1;let r=this.workspace.database;this.main.networkManager.setNameAndPublishedTo(this.workspace.id,t,e,i,()=>{this.workspace.name=t,r.published_to==0&&e>0&&new wi().uploadCurrentDatabase(this.workspace.id,this.main,null,"publishDatabaseAsTemplate"),r.published_to=e,r.description=i,this.showMainWindow()})}setValues(){jQuery(".jo_databasename").val(this.workspace.database.name),this.main.networkManager.getDatabaseSettings(this.workspace.id,e=>{let t=e.owner;!e.userIsOwner&&e.secrets!=null&&(t+=" (hat aber keinen mit der Datenbank verbundenen Workspace)"),jQuery(".jo_ds_settings_owner").text(t),["read","write","ddl"].forEach(i=>{let r="---";e.secrets!=null&&(r=e.secrets[i]),jQuery(".jo_ds_secret_"+i).text(r)}),(this.main.user.is_admin||this.main.user.username=="DB-Vorlagen")&&(jQuery("#b3").css("visibility","visible"),jQuery("#lb3").css("visibility","visible")),this.main.user.is_schooladmin&&(jQuery("#b2").css("visibility","visible"),jQuery("#lb2").css("visibility","visible")),jQuery("#b"+e.publishedTo).prop("checked",!0),jQuery("#jo_upload_db").prop("checked",e.publishedTo!=0),jQuery(".jo_ds_settings_description").val(this.workspace.database.description),e.secrets==null?(this.$dialog.find("input, textarea").attr("readonly","").css("background-color","#888"),this.$dialog.find("#jo_ds_ownerSettings").hide(),this.$dialog.find("#jo_ds_save_button").hide()):(this.$dialog.find("input, textarea").removeAttr("readonly").css("background-color","#fff"),this.$dialog.find("#jo_ds_ownerSettings").show(),this.$dialog.find("#jo_ds_save_button").show())})}showMainWindow(){jQuery("#main").css("visibility","visible"),this.$dialog.css("visibility","hidden"),this.$dialog.empty()}}class Xt{constructor(e,t,i){w(this,"name");w(this,"path","");w(this,"isFolder");w(this,"id");w(this,"owner_id");w(this,"version");w(this,"moduleStore");w(this,"panelElement");w(this,"currentlyOpenModule");w(this,"saved",!0);w(this,"compilerMessage");w(this,"databaseId");w(this,"database");w(this,"sql_history");w(this,"permissions");this.main=t,this.name=e,this.owner_id=i,this.moduleStore=new nn(t),this.sql_history=""}getWorkspaceData(e){let t={name:this.name,id:this.id,owner_id:this.owner_id,currentFileId:this.currentlyOpenModule==null?null:this.currentlyOpenModule.file.id,files:[],sql_history:this.sql_history,path:this.path,isFolder:!1,permissions:this.permissions,database_id:this.databaseId};if(e)for(let i of this.moduleStore.getModules(!1))t.files.push(i.getFileData(this));return t}renderSettingsButton(e){var o;let t=(o=e==null?void 0:e.$htmlFirstLine)==null?void 0:o.find(".jo_additionalButtonSettings");if(t==null)return;let i=jQuery('<div class="jo_settingsButton img_settings jo_button jo_active" title="Datenbank-Einstellungen..."></div>');t.append(i);let r=this;i.on("pointerdown",u=>u.stopPropagation()),i.on("pointerup",u=>{u.stopPropagation(),new sr(r.main,r)}),i[0].addEventListener("contextmenu",u=>{u.preventDefault(),u.stopPropagation()},!1)}static restoreFromData(e,t){let i=new Xt(e.name,t,e.owner_id);i.id=e.id,i.path=e.path,i.isFolder=e.isFolder,i.owner_id=e.owner_id,i.sql_history=e.sql_history,i.permissions=e.permissions,i.databaseId=e.database_id;for(let r of e.files){let o=dt.restoreFromData(r,t);i.moduleStore.putModule(o),r.id==e.currentFileId&&(i.currentlyOpenModule=o)}return i}hasErrors(){return this.moduleStore.hasErrors()}getModuleByMonacoModel(e){for(let t of this.moduleStore.getModules(!1))if(t.model==e)return t;return null}}class Zs{constructor(e,t){w(this,"actions",{});w(this,"keyEntries",{});w(this,"buttons",{});this.$mainElement=e,this.main=t}init(){let e=this.$mainElement;e==null&&(e=jQuery(document));let t=this;e.on("keydown",function(i){i!=null&&t.executeKeyDownEvent(i)})}trigger(e){let t=this.actions[e];t!=null&&t.action(e,null,"")}registerAction(e,t,i,r="",o){let u={action:i,identifier:e,keys:t,text:r,active:!0};this.actions[e]=u;for(let f of t)this.keyEntries[f.toLowerCase()]==null&&(this.keyEntries[f.toLowerCase()]=[]),this.keyEntries[f.toLowerCase()].push(u);if(o!=null){this.buttons[e]==null&&(this.buttons[e]=[]),this.buttons[e].push(o);let f=r;t.length>0&&(f+=" ["+t.join(", ")+"]"),o.attr("title",f),o.on("mousedown",()=>{u.active&&i(e,null,"mousedown")})}}isActive(e){let t=this.actions[e];return t==null?!1:t.active}setActive(e,t){let i=this.actions[e];i!=null&&(i.active=t);let r=this.buttons[e];if(r!=null)for(let o of r)t?o.addClass("jo_active"):o.removeClass("jo_active")}executeKeyDownEvent(e){if(document.activeElement.tagName.toLowerCase()=="input"||e.keyCode<=18&&e.keyCode>=16)return;let t="";e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.key!=null&&(t+=e.key.toLowerCase());let i=this.keyEntries[t];if(i!=null){for(let r of i)if(r.active){e.stopPropagation(),e.preventDefault(),r.action(r.identifier,null,t);break}}}}class Ys{constructor(e,t,i){w(this,"oldDecorations",[]);w(this,"oldErrorDecorations",[]);w(this,"$errorDiv");w(this,"minimapColor",{});w(this,"lightBulbOnClickFunctionList",[]);this.main=e,this.$bottomDiv=t,this.$mainDiv=i,this.minimapColor.error="#bc1616",this.minimapColor.warning="#cca700",this.minimapColor.info="#75beff";let r=this;i.find(".jo_pw_undo").on("click",()=>{r.main.getMonacoEditor().trigger(".","undo",{})}).attr("title","Undo")}showErrors(e){this.main.getResultsetPresenter().showErrorDecorations([]),this.lightBulbOnClickFunctionList=[];let t=new Map;this.$errorDiv=this.$bottomDiv.find(".jo_tabs>.jo_errorsTab"),this.$errorDiv.empty();let i=!1,r=e.moduleStore,o=this.main.getMonacoEditor();for(let u of r.getModules(!1)){let f=[],g=[],y=[],C=u.getSortedAndFilteredErrors();t.set(u,u.getErrorCount());for(let T of C){let D,Q,N=this.minimapColor[T.level];switch(T.level){case"error":D="jo_revealErrorLine",Q="jo_borderLeftError";break;case"warning":D="jo_revealWarningLine",Q="jo_borderLeftWarning";break;case"info":D="jo_revealInfoLine",Q="jo_borderLeftInfo";break}if(T.quickFix!=null){let H=T.quickFix,F="lb_"+Math.trunc(Math.random()*1e6);D="jo_yellowLightBulb "+Q+" "+F,this.lightBulbOnClickFunctionList.push({class:"."+F,onClickFunction:()=>{let Ye=H.editsProvider(u.model.uri);o.executeEdits("",Ye.map(ye=>{let de=ye.edit.range;return{range:new monaco.Range(de.startLineNumber,de.startColumn,de.endLineNumber,de.endColumn),text:ye.edit.text,forceMoveMarkers:!0}}))},title:H.title})}this.processError(T,u,y);let M;switch(T.level){case"error":M=monaco.MarkerSeverity.Error;break;case"warning":M=monaco.MarkerSeverity.Warning;break;case"info":M=monaco.MarkerSeverity.Info;break}f.push({startLineNumber:T.position.line,startColumn:T.position.column,endLineNumber:T.position.line,endColumn:T.position.column+T.position.length,message:T.text,severity:M,relatedInformation:T.quickFix}),g.push({range:{startLineNumber:T.position.line,startColumn:T.position.column,endLineNumber:T.position.line,endColumn:T.position.column+T.position.length},options:{linesDecorationsClassName:D,minimap:{position:monaco.editor.MinimapPosition.Inline,color:N}}})}if(monaco.editor.setModelMarkers(u.model,"test",f),u.oldErrorDecorations=u.model.deltaDecorations(u.oldErrorDecorations,g),this.oldDecorations=this.main.getMonacoEditor().deltaDecorations(this.oldDecorations,[]),y.length>0&&this.$errorDiv.length>0){i=!0;let T=jQuery('<div class="jo_error-filename">'+u.file.name+"&nbsp;</div>");this.$errorDiv.append(T);for(let D of y)this.$errorDiv.append(D)}}return!i&&this.$errorDiv.length>0&&this.$errorDiv.append(jQuery('<div class="jo_noErrorMessage">Keine Fehler gefunden :-)</div>')),this.registerLightbulbOnClickFunctions(),t}registerLightbulbOnClickFunctions(){let e=this;setTimeout(()=>{for(let t of e.lightBulbOnClickFunctionList)jQuery(t.class).off("click",t.onClickFunction),jQuery(t.class).on("click",t.onClickFunction).attr("title",t.title)},500)}processError(e,t,i){let r=jQuery('<div class="jo_error-line"></div>'),o=jQuery('<span class="jo_error-position">[Z&nbsp;<span class="jo_linecolumn">'+e.position.line+'</span> Sp&nbsp;<span class="jo_linecolumn">'+e.position.column+"</span>]</span>:&nbsp;"),u="";switch(e.level){case"error":break;case"warning":u='<span class="jo_warning_category">Warnung: </span>';break;case"info":u='<span class="jo_info_category">Info: </span>';break}let f=jQuery('<div class="jo_error-text">'+u+e.text+"</div>");r.append(o).append(f);let g=this;r.on("mousedown",y=>{this.$errorDiv.find(".jo_error-line").removeClass("jo_active"),r.addClass("jo_active"),g.showError(t,e)}),i.push(r)}showError(e,t){this.main instanceof Zt&&e!=this.main.projectExplorer.getCurrentlyEditedModule()&&this.main.projectExplorer.setModuleActive(e);let i=t.position,r={startColumn:i.column,startLineNumber:i.line,endColumn:i.column+i.length,endLineNumber:i.line};this.main.getMonacoEditor().revealRangeInCenter(r);let o="";switch(t.level){case"error":o="jo_revealError";break;case"warning":o="jo_revealWarning";break;case"info":o="jo_revealInfo";break}this.oldDecorations=this.main.getMonacoEditor().deltaDecorations(this.oldDecorations,[{range:r,options:{className:o}}])}}class Js{constructor(e,t){w(this,"$homeworkTab");w(this,"$homeworkTabLeft");w(this,"$homeworkTabRight");w(this,"$showRevisionButton");w(this,"showRevisionActive",!1);w(this,"diffEditor");this.main=e,this.$bottomDiv=t,this.$homeworkTab=t.find(".jo_tabs>.jo_homeworkTab")}initGUI(){let e=this;this.$homeworkTab.append(this.$homeworkTabLeft=Ct("","jo_homeworkTabLeft jo_scrollable")),this.$homeworkTab.append(this.$homeworkTabRight=Ct("","jo_homeworkTabRight jo_scrollable")),jQuery("#view-mode").prepend(this.$showRevisionButton=Ct("","jo_button jo_active jo_homeworkRevisionButton","")),this.$showRevisionButton.on("click",()=>{this.showRevisionActive?this.hideRevision():this.showRevision(e.main.getCurrentlyEditedModule())}),this.$showRevisionButton.hide(),jQuery("#diffEditor").hide()}showHomeWorkRevisionButton(){this.$showRevisionButton.text(this.showRevisionActive?"Normalansicht":"Korrekturen zeigen"),this.$showRevisionButton.show()}hideHomeworkRevisionButton(){this.$showRevisionButton.hide()}showRevision(e){e.file.text=e.getProgramTextFromMonacoModel();let t=e.file;jQuery("#editor").hide(),jQuery("#diffEditor").show();var i=monaco.editor.createModel(t.text_before_revision,"myJava"),r=monaco.editor.createModel(t.text,"myJava");this.diffEditor=monaco.editor.createDiffEditor(document.getElementById("diffEditor"),{enableSplitViewResizing:!0,originalEditable:!1,readOnly:!0,renderSideBySide:!0}),this.diffEditor.setModel({original:i,modified:r}),this.showRevisionActive=!0,this.showHomeWorkRevisionButton()}hideRevision(){this.showRevisionActive&&(jQuery("#diffEditor").hide(),this.diffEditor.dispose(),this.diffEditor=null,jQuery("#editor").show(),this.showRevisionActive=!1,this.showHomeWorkRevisionButton())}attachToWorkspaces(e){let t=[],i={};e.forEach(u=>{u.moduleStore.getModules(!1).forEach(f=>{let g=f.file.submitted_date;if(g!=null){let y=qs(g),C=Rs(y),T=i[C];T==null&&(T={date:y,day:C,modules:[]},i[C]=T,t.push(T)),T.modules.push({module:f,workspace:u})}})}),this.$homeworkTabLeft.empty(),this.$homeworkTabRight.empty();let r=this;this.$homeworkTabLeft.append(Ct("","jo_homeworkHeading","Abgabetage:")),t.sort((u,f)=>u.date.getFullYear()!=f.date.getFullYear()?-Math.sign(u.date.getFullYear()-f.date.getFullYear()):u.date.getMonth()!=f.date.getMonth()?-Math.sign(u.date.getMonth()-f.date.getMonth()):u.date.getDate()!=f.date.getDate()?-Math.sign(u.date.getDate()-f.date.getDate()):0);let o=!0;t.forEach(u=>{u.modules.sort((g,y)=>g.module.file.name.localeCompare(y.module.file.name));let f=Ct("","jo_homeworkDate",u.day);this.$homeworkTabLeft.append(f),f.on("click",g=>{this.$homeworkTabLeft.find(".jo_homeworkDate").removeClass("active"),f.addClass("jo_active"),r.select(u)}),o&&(o=!1,f.addClass("jo_active"),r.select(u))})}select(e){this.$homeworkTabRight.empty(),this.$homeworkTabRight.append(Ct("","jo_homeworkHeading","Abgegebene Dateien:"));let t=this;e.modules.forEach(i=>{let r=jQuery(`<div class="jo_homeworkEntry">Workspace <span class="jo_homework-workspace">
                    ${i.workspace.name}</span>, Datei <span class="jo_homework-file">
                    ${i.module.file.name}</span> (Abgabe: ${i.module.file.submitted_date} )</div>`);t.$homeworkTabRight.append(r),r.on("click",()=>{t.main.projectExplorer.setWorkspaceActive(i.workspace),t.main.projectExplorer.setModuleActive(i.module),t.main.projectExplorer.fileListPanel.select(i.module,!1)})})}}class eo{constructor(e,t,i){w(this,"errorManager");w(this,"homeworkManager");this.main=e,this.$bottomDiv=t,this.$mainDiv=i,this.$bottomDiv.find(".jo_tabheadings>.jo_homeworkTabheading").length>0&&(this.homeworkManager=new Js(e,t)),this.errorManager=new Ys(e,t,i)}initGUI(){rn(this.$bottomDiv),this.homeworkManager!=null&&this.homeworkManager.initGUI(),this.$bottomDiv.find(".jo_tabs").children().first().trigger("click")}showHomeworkTab(){jQuery(".jo_homeworkTabheading").css("visibility","visible"),jQuery(".jo_homeworkTabheading").trigger("mousedown")}hideHomeworkTab(){jQuery(".jo_homeworkTabheading").css("visibility","hidden"),jQuery(".jo_tabheadings").children().first().trigger("mousedown")}}class to{constructor(e){w(this,"isConsole");w(this,"triggerCharacters",[".","abcdefghijklmnopqrstuvwxyzäöüß_ABCDEFGHIJKLMNOPQRSTUVWXYZÄÖÜ"," ",",","("]);w(this,"keywordCompletionItems",new Map);w(this,"first",!0);w(this,"keywordToSnippetMap",{"(":`(
	$0
)`,varchar:"varchar($1) $0",decimal:"decimal($1, $2) $0"});this.main=e,this.setupKeywordCompletionItems()}provideCompletionItems(e,t,i,r){let o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);return o==null||o.mainSymbolTable==null?null:new Promise((u,f)=>{let g=this,y=function(){o.file.dirty?setTimeout(()=>{y()},100):u(g.provideCompletionItemsIntern(e,t,i,r))};y()})}provideCompletionItemsIntern(e,t,i,r){setTimeout(()=>{let F=this.main.getMonacoEditor()._contentWidgets["editor.widget.suggestWidget"].widget;this.first&&(F.toggleDetails(),this.first=!1)},500);let o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(o==null||o.mainSymbolTable==null||this.isStringLiteral(o,t))return null;let u=e.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column}),f=e.getValueInRange({startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber+5,endColumn:1}),g=o.mainSymbolTable.findTableAtPosition(t.lineNumber,t.column),y=o.getCompletionHint(t.lineNumber,t.column);y==null&&(y={fromColumn:0,toColumn:0,fromLine:0,toLine:0,hintColumns:!1,hintTables:!1,hintKeywords:[]});let C=[];this.addKeywordCompletionItems(y,C);let T=u.match(/.*\s([\wöäüÖÄÜß]*)(\.)([\wöäüÖÄÜß]*)$/),D=f.match(/^([\wöäüÖÄÜß]*)/),Q="";D!=null&&D.length>0&&(Q=D[0]),T==null?this.addIdentifierCompletionItems(y,g,C):this.addDotCompletionItems(t,T,Q,g,C);let N=e.getWordUntilPosition(t),M={startColumn:N.startColumn,startLineNumber:t.lineNumber,endColumn:N.endColumn,endLineNumber:t.lineNumber},H={startColumn:t.column,startLineNumber:t.lineNumber,endColumn:t.column,endLineNumber:t.lineNumber};for(let F of C)F.range==null&&(F.insertText.startsWith(",")?F.range=H:F.range=M);return y.dontHint!=null&&(C=C.filter(F=>y.dontHint.indexOf(F.insertText)<0)),{suggestions:C}}addDotCompletionItems(e,t,i,r,o){let u=t[3],f=t[1];e.column-u.length-1;let g={startLineNumber:e.lineNumber,startColumn:e.column-u.length,endLineNumber:e.lineNumber,endColumn:e.column+i.length};for(let y of r.symbolList)if(y.table!=null){let C=y.table.identifier;if(y.tableAlias!=null&&(C=y.tableAlias),C.toLowerCase()==f)for(let T of y.table.columns)o.push({label:T.identifier,detail:"Spalte "+T.identifier+" der Tabelle "+y.table.identifier,filterText:T.identifier,insertText:T.identifier,insertTextRules:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:monaco.languages.CompletionItemKind.Field,range:g})}}addIdentifierCompletionItems(e,t,i){var C,T;let r=e.praefix==null?"":e.praefix,o=e.suffix==null?"":e.suffix;if(!(e.hintTables||e.hintColumns))return;let u={},f=t,g={},y=[];for(;f!=null;){for(let D of f.symbolList)if(D.column!=null){let Q=D.column.identifier;g[Q]==null?(g[Q]=[D],y.push(Q)):g[Q].push(D)}else if(D.table!=null&&e.hintTables&&!u[D.identifier]){let Q=r+D.identifier+o;i.push({label:D.identifier,detail:"Tabelle "+D.table.identifier,filterText:D.identifier,insertText:Q,insertTextRules:Q.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:Q.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Class,range:void 0,sortText:"aa"+D.identifier}),u[D.identifier]=!0}f=f.parent}if(e.hintColumns)for(let D of y){let Q=g[D],N=Q.length>1&&e.hintColumnsOfTable==null;for(let M of Q){let H=M.identifier;if(N&&M.identifier==M.column.identifier.toLowerCase()&&(H=(M.tableAlias==null?M.column.table.identifier:M.tableAlias)+"."+H),e.hintColumnsOfTable==null||((T=(C=M.column)==null?void 0:C.table)==null?void 0:T.identifier)==e.hintColumnsOfTable){let F=r+H+o;i.push({label:H,detail:"Die Spalte "+M.column.identifier+" der Tabelle "+M.column.table.identifier,filterText:H,insertText:F,insertTextRules:F.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:F.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Field,range:void 0})}}}}addKeywordCompletionItems(e,t){let i=e.praefix==null?"":e.praefix,r=e.suffix==null?"":e.suffix;for(let o of e.hintKeywords){let u=i+o+r,f=this.keywordToSnippetMap[o],g=this.keywordCompletionItems.get(o);if(g!=null)t.push(g);else if(f!=null){let y=f.replace("$0","").replace("$1","").replace("$2","").replace(/ /g,"").replace(/\n/g,"").replace(/\t/g,"");t.push({label:y,detail:"",filterText:o,insertText:f,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0})}else t.push({label:o,detail:"",filterText:o,insertText:o,insertTextRules:u.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:u.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Keyword,range:void 0,sortText:o=="from"?"*":void 0})}}isStringLiteral(e,t){let i=e.tokenList;if(i==null||i.length==0)return!1;let r=0,o=i.length-1,u,f=1e3;for(;;){let g=u;if(u=Math.round((o+r)/2),g==u||(f--,f==0))return!1;let y=i[u],C=y.position;if(C.line<t.lineNumber||C.line==t.lineNumber&&C.column+C.length<t.column){r=u;continue}if(C.line>t.lineNumber||C.line==t.lineNumber&&C.column>t.column){o=u;continue}return y.tt==a.stringConstant}}setupKeywordCompletionItems(){this.keywordCompletionItems.set("delete from",{label:"delete from <Tabelle> where <Bedingung>",detail:"Anweisung zum Löschen von Datensätzen",filterText:"delete from",insertText:"delete from ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("drop table",{label:"drop table <Tabelle>",detail:"Anweisung zum Löschen einer Tabelle",filterText:"drop table",insertText:"drop table ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("alter",{label:"alter table <Tabelle> <rename to, rename column, add column, drop column>",detail:"Anweisung zum Ändern des Schemas (alter table <Tabelle> <rename to, rename column, add column, drop column>)",filterText:"alter",insertText:"alter table ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("select",{label:"select <Spalten> from <Tabellen> where <Bedingung>",detail:"Select-Anweisung",filterText:"select",insertText:`select * from $1
where $0
`,command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("create table",{label:"create table <Tabellenbezeichner> (<Spaltendefinitionen>)",detail:"Create table-Anweisung (Erstellt eine neue Tabelle)",filterText:"create",insertText:`create table $1 (
	$0
);`,command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0})}}class io{constructor(e){w(this,"signatureHelpTriggerCharacters",["(",",",";","<",">","="]);w(this,"signatureHelpRetriggerCharacters",[]);this.main=e}provideSignatureHelp(e,t,i,r){let o=this;return new Promise((u,f)=>{setTimeout(()=>{this.main.compileIfDirty(),u(o.provideSignatureHelpLater(e,t,i,r))},300)})}provideSignatureHelpLater(e,t,i,r){e!=this.main.getMonacoEditor().getModel();let o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(o==null)return null;let u=o.methodCallPositions[t.lineNumber];if(u==null)return null;let f=null,g=-1;for(let y=u.length-1;y>=0;y--){let C=u[y];C.identifierPosition.column+C.identifierPosition.length<t.column&&C.identifierPosition.column>g&&(C.rightBracketPosition==null||t.lineNumber<=C.rightBracketPosition.line&&t.column<=C.rightBracketPosition.column||t.lineNumber<C.rightBracketPosition.line)&&(f=C,g=C.identifierPosition.column)}return f==null?null:this.getSignatureHelp(f,t)}getSignatureHelp(e,t){let i=0;for(let o of e.commaPositions)(o.line<t.lineNumber||o.line==t.lineNumber&&o.column<t.column)&&i++;let r=[];return Promise.resolve({value:{activeParameter:i,activeSignature:0,signatures:r},dispose:()=>{}})}}const yi=class yi{constructor(e){this.editor=e}provideHover(e,t,i){var f;let r=this.editor.editor.getSelection();if(r!=null&&(r.startLineNumber!=r.endLineNumber||r.startColumn!=r.endColumn)&&(r.startLineNumber<t.lineNumber||r.startLineNumber==t.lineNumber&&r.startColumn<=t.column)&&(r.endLineNumber>t.lineNumber||r.endLineNumber==t.lineNumber&&r.endColumn>=t.column))return;let o=(f=this.editor.main.getCurrentWorkspace())==null?void 0:f.getModuleByMonacoModel(e);if(o==null)return null;for(let g of o.errors)for(let y of g)if(y.position.line==t.lineNumber&&y.position.column<=t.column&&y.position.column+y.position.length>=t.column)return null;if(o.getElementAtPosition(t.lineNumber,t.column)==null){let g=this.getWordUnderCursor(e,t),y=yi.keywordDescriptions[g];if(y!=null)return{range:null,contents:[{value:y}]}}}getWordUnderCursor(e,t){let i=e.getValueLengthInRange({startColumn:0,startLineNumber:0,endLineNumber:t.lineNumber,endColumn:t.column}),r=e.getValue(),o="",u=i;for(;u<r.length&&this.isInsideIdentifierOrArrayDescriptor(r.charAt(u));)u++;let f=i;for(;f>0&&this.isInsideIdentifierOrArrayDescriptor(r.charAt(f-1));)f--;if(u-f>1)o=r.substring(f,u);else{for(u=i;u<r.length&&this.isInsideOperator(r.charAt(u));)u++;for(f=i;f>0&&this.isInsideOperator(r.charAt(f-1));)f--;u-f>0&&(o=r.substring(f,u))}return o}widenDeclaration(e,t,i){let r=e.getValueLengthInRange({startColumn:0,startLineNumber:0,endLineNumber:t.lineNumber,endColumn:t.column}),o=e.getValue(),u=r;for(;u<o.length&&this.isInsideIdentifierOrArrayDescriptor(o.charAt(u));)u++;let f=r;for(;f>0&&this.isInsideIdentifierChain(o.charAt(f-1));)f--;return(i==null?void 0:i.length)==null||i.length,u-f>length?o.substring(f,u):i}isInsideIdentifierChain(e){return e.toLocaleLowerCase().match(/[a-z0-9äöüß_\[\]\.]/i)}isInsideOperator(e){return e.toLocaleLowerCase().match(/[!%<>=\+\-\*\/]/i)}isInsideIdentifierOrArrayDescriptor(e){return e.toLocaleLowerCase().match(/[a-z0-9äöüß\[\]]/i)}};w(yi,"keywordDescriptions",{select:"```\nselect spalte1, spalte2, ..., spalteN from tabelle where <Bedingung>\n``` \nsucht alle Zeilen der Tabelle, die der Bedingung genügen (**Selektion**) und gibt davon die angegebenen Spalten aus (**Projektion**). Das Ergebnis der ```select```-Anweisung ist wieder eine Tabelle. \n ",from:"```\nselect spalte1, spalte2, ..., spalteN from tabelle where <Bedingung>\n``` \nsucht alle Zeilen der Tabelle, die der Bedingung genügen (**Selektion**) und gibt davon die angegebenen Spalten aus (**Projektion**). Das Ergebnis der ```select```-Anweisung ist wieder eine Tabelle. \n ",where:"```\n... where <Bedingung>\n``` \nHinter ```where``` steht immer eine Bedingung, d.h. ein Term mit booleschem Wert (```true``` oder ```false```). Die Anweisung wird für alle Zeilen ausgeführt, die der Bedingung genügen, d.h. für die der Term den Wert ```true``` ergibt. \n ",delete:"```\ndelete from tabelle where <Bedingung>\n``` \nlöscht alle Zeilen der Tabelle, die der Bedingung genügen. \n ",insert:"```\ninsert (spalte1, spalte2, ..., spalteN) into tabelle values (Wert1, ..., WertN), (Wert1, ..., WertN), ... \n``` \nFügt Datensätze in eine Tabelle ein. Die Werte ```wert1, ..., wertN``` müssen den angegebenen Spalten ```Spalte1, ..., SpalteN``` entsprechen.\n ",values:"```\ninsert (spalte1, spalte2, ..., spalteN) into tabelle values (Wert1, ..., WertN), (Wert1, ..., WertN), ... \n``` \nFügt Datensätze in eine Tabelle ein. Die Werte ```wert1, ..., wertN``` müssen den angegebenen Spalten ```Spalte1, ..., SpalteN``` entsprechen.\n ",update:"```\nupdate tabelle set Spalte1 = Wert1, Spalte2 = Wert2, ..., SpalteN = WertN where <Bedingung> \n``` \nÄndert in allen Datensätze der Tabelle, die der Bedingung genügen, die Werte in den angegebenen Spalten ```Spalte1, ..., SpalteN```.\n ","%":"```\na % b\n```  \n (sprich: 'a modulo b') berechnet den **Rest** der ganzzahligen Division a/b.","=":"```\na = b\n```  \nergibt genau dann ```true```, wenn ```a``` und ```b``` gleich sind.  \n```=``` nennt man **Vergleichsoperator**. \n\n**Tipp:** In SQL gibt es auch einen **Ungleich-Operator**: ```<>```","<=":"```\na <= b\n```  \nergibt genau dann ```true```, wenn der Wert von ```a``` kleiner oder gleich dem Wert von ```b``` ist.",">=":"```\na <= b\n```  \nergibt genau dann ```true```, wenn der Wert von ```a``` größer oder gleich dem Wert von ```b``` ist.","<>":"```\na <> b\n```  \nergibt genau dann ```true```, wenn ```a``` und ```b``` **un**gleich sind.  \n```<>``` nennt man **Ungleich-Operator**."});let Yi=yi;class no{constructor(e){this.main=e}provideCodeActions(e,t,i,r){return{actions:i.markers.map(u=>{let f=u.relatedInformation;return f==null?null:{title:f.title,diagnostics:[u],kind:"quickfix",edit:{edits:f.editsProvider(e.uri)},isPreferred:!0}}),dispose:()=>{}}}}class ro{constructor(e){this.main=e}provideReferences(e,t,i,r){let o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(o==null)return null;let u=o.getElementAtPosition(t.lineNumber,t.column);if(u==null)return;let f=u.usagePositions,g=[];return f.forEach((y,C)=>{if(y!=null)for(let T of y)g.push({uri:C.uri,range:{startColumn:T.column,startLineNumber:T.line,endLineNumber:T.line,endColumn:T.column+T.length}})}),g}}function so(){monaco.languages.register({id:"vscSQL",extensions:[".sql"]});let c={onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:monaco.languages.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:monaco.languages.IndentAction.None,removeText:1}},{beforeText:/^(\t|(\ \ ))*\ \*[^/]*\*\/\s*$/,action:{indentAction:monaco.languages.IndentAction.None,removeText:1}}],comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},e={defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],escapes:/\\(?:[abfnrtv\\"'])/,keywords:["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT","ENGINE","CHARSET"],operators:["AND","BETWEEN","IN","LIKE","NOT","OR","IS","NULL","INTERSECT","UNION","INNER","JOIN","LEFT","OUTER","RIGHT"],builtinFunctions:["abs","changes","char","coalesce","count","glob","hex","ifnull","iif","instr","last_insert_rowid","length","like","likelihood","likely","lower","ltrim","max","min","nullif","quote","random","randomblob","replace","round","rtrim","sign","soundex","sqlite_version","substr","substring","total_changes","trim","typeof","unicode","unlikely","upper","zeroblob"],builtinVariables:[],pseudoColumns:[],tokenizer:{root:[{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[a-z_$äöü][\w$äöüßÄÖÜ]*(?=\()/,{cases:{"@builtinFunctions":"functions","@keywords":"keyword","@default":"identifier"}}],[/[\w@#$]+/,{cases:{"@keywords":"keyword","@operators":"operator","@builtinVariables":"predefined","@default":"identifier"}}],[/[<>=!%&+\-*/|~^]/,"operator"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/'/,{token:"string",next:"@string"}]],string:[[/[^\\']+/,"string"],[/\\./,"string.escape.invalid"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[]}};monaco.languages.setLanguageConfiguration("vscSQL",c),monaco.languages.setMonarchTokensProvider("vscSQL",e)}class nt{static openHelper(e,t,i){let r=jQuery(".jo_arrow_box");r.removeClass(["jo_arrow_box_left","jo_arrow_box_right","jo_arrow_box_top","jo_arrow_box_bottom"]),r.addClass("jo_arrow_box_"+i),r.css({left:"",right:"",top:"",bottom:""});let o=t.offset(),u=jQuery("body"),f=34;switch(i){case"bottom":r.css({left:o.left+t.width()/2-f,bottom:u.height()-o.top+f});break;case"top":r.css({left:o.left+t.width()/2-f,top:o.top+t.height()+26});break;case"left":r.css({left:o.left+t.width()+f,top:o.top+t.height()/2-f});break;case"right":r.css({right:u.width()-o.left,top:o.top+t.height()/2-f});break}r.find("span").html(e);let g=r.find(".jo_button");g.on("click",y=>{y.stopPropagation(),g.off("click"),nt.close()}),r.fadeIn(800)}static close(){jQuery(".jo_arrow_box").fadeOut(800)}static showHelper(e,t,i){let r;if(t instanceof Zt)r=t;else return;let o=r.user;if(o==null)return;let u=o.settings.helperHistory,f=e+"Done";if(u!=null&&(u[f]==null||!u[f])){u[f]=!0,r.networkManager.sendUpdateUserSettings(()=>{});let g="",y="left";switch(e){case"newDatabaseHelper":g=`Es gibt noch keine Datenbank. <br> Nutzen Sie den Button
                        <span class='img_add-database-dark jo_inline-image'></span> um eine Datenbank anzulegen.
                        `,y="left";break;case"newSQLFileHelper":g=`Es gibt noch keine Datei mit SQL-Anweisungen. <br> Nutzen Sie den Button 
                            <span class='img_add-file-dark jo_inline-image'></span> um eine neue Datei anzulegen.
                            `,y="left";break;case"homeButtonHelper":g="Mit dem Home-Button <span class='img_home-dark jo_inline-image'></span> können Sie wieder zu Ihren eigenen Workspaces wechseln.",y="top",i=jQuery(".img_home-dark");break;case"playButtonHelper":g=`Mit dem "Start-Button"
                        (<span class='img_start-dark jo_inline-image'></span>) 
                        oder der Tastenkombination &lt;Strg&gt;&nbsp;+&nbsp&lt;Enter&gt; 
                        wird die Anweisung ausgeführt, in der der Cursor gerade steht. 
                        <br> Wollen Sie mehrere Anweisungen hintereinander ausführen, so markieren 
                        Sie alle Anweisungen und klicken Sie dann auf <span class='img_start-dark jo_inline-image'></span>
                        oder drücken Sie  &lt;Strg&gt;&nbsp;+&nbsp&lt;Enter&gt;. `,y="top";break;case"consoleHelper":g=`
                        Hier können Sie Anweisungen oder Terme eingeben, die nach Bestätigung mit der Enter-Taste ausgeführt/ausgewertet werden. Das Ergebnis sehen Sie im Bereich über der Eingabezeile. <br>
                        Falls das Programm gerade pausiert (z.B. bei Ausführung in Einzelschritten) können Sie auch auf die Variablen des aktuellen Sichtbarkeitsbereiches zugreifen.
                    `,y="bottom"}g!=""&&i!=null&&i.length>0&&nt.openHelper(g,i,y)}}}class oo{constructor(e,t,i){w(this,"editor");w(this,"cw",null);w(this,"dontPushNextCursorMove",0);w(this,"lastTime",0);w(this,"elementDecoration",[]);this.main=e,this.showMinimap=t,this.isEmbedded=i}initGUI(e){so(),monaco.editor.defineTheme("myCustomThemeDark",{base:"vs-dark",inherit:!0,rules:[{token:"functions",foreground:"dcdcaa",fontStyle:"italic"},{token:"string.sql",foreground:"3DC9B0"},{token:"number",foreground:"7bef3f"},{token:"type",foreground:"499cd6"},{token:"identifier",foreground:"effefe"},{token:"statement",foreground:"9cdcfe",fontStyle:"bold"},{token:"keyword",foreground:"619ceb",fontStyle:"bold"},{token:"table",foreground:"ff0000",fontStyle:"bold"},{token:"delimiter",foreground:"e8eb38"}],colors:{"editor.background":"#1e1e1e",jo_highlightStatementGreen:"#004000",jo_highlightStatementYellow:"#404000",jo_highlightStatementRed:"#402020"}}),monaco.editor.defineTheme("myCustomThemeLight",{base:"vs",inherit:!0,rules:[{token:"functions",foreground:"694E16",fontStyle:"italic bold"},{token:"string.sql",foreground:"a03030"},{token:"number",foreground:"404040"},{token:"type",foreground:"0000ff",fontStyle:"bold"},{token:"identifier",foreground:"8000e0"},{token:"statement",foreground:"001080",fontStyle:"bold"},{token:"keyword",foreground:"00a000",fontStyle:"bold"},{token:"comment",foreground:"808080",fontStyle:"italic"}],colors:{"editor.background":"#FFFFFF","editor.foreground":"#000000","editor.inactiveSelectionBackground":"#E5EBF1","editorIndentGuide.background":"#D3D3D3","editorIndentGuide.activeBackground":"#939393","editor.selectionHighlightBackground":"#ADD6FF80","editorSuggestWidget.background":"#F3F3F3","activityBarBadge.background":"#007ACC","sideBarTitle.foreground":"#6F6F6F","list.hoverBackground":"#E8E8E8","input.placeholderForeground":"#767676","searchEditor.textInputBorder":"#CECECE","settings.textInputBorder":"#CECECE","settings.numberInputBorder":"#CECECE","statusBarItem.remoteForeground":"#FFF","statusBarItem.remoteBackground":"#16825D",jo_highlightStatementGreen:"#004000",jo_highlightStatementYellow:"#404000",jo_highlightStatementRed:"#400000"}}),this.editor=monaco.editor.create(e[0],{language:"vscSQL",lightbulb:{enabled:!0},lineDecorationsWidth:0,peekWidgetDefaultFocus:"tree",fixedOverflowWidgets:!0,quickSuggestions:!0,quickSuggestionsDelay:10,fontSize:14,fontFamily:"Consolas, Roboto Mono",fontWeight:"500",roundedSelection:!0,selectOnLineNumbers:!1,automaticLayout:!0,scrollBeyondLastLine:!1,occurrencesHighlight:!1,autoIndent:"full",dragAndDrop:!0,formatOnType:!0,formatOnPaste:!0,suggestFontSize:16,suggestLineHeight:22,suggest:{localityBonus:!0,insertMode:"replace"},parameterHints:{enabled:!0,cycle:!0},mouseWheelZoom:this.isEmbedded,minimap:{enabled:this.showMinimap},scrollbar:{vertical:"auto",horizontal:"auto"},theme:"myCustomThemeDark"});let t=this,i=r=>{r.ctrlKey===!0&&(t.changeEditorFontSize(Math.sign(r.deltaY),!0),r.preventDefault())};return this.editor.onDidChangeConfiguration(r=>{r.hasChanged(monaco.editor.EditorOption.fontInfo)&&this.isEmbedded&&this.main.getBottomDiv().errorManager.registerLightbulbOnClickFunctions()}),this.editor.onDidChangeCursorPosition(r=>{t.onDidChangeCursorPosition(r.position)}),this.editor.onDidChangeModel(r=>{let o=e.find(".monaco-editor")[0];if(o!=null&&(o.removeEventListener("wheel",i),o.addEventListener("wheel",i,{passive:!1})),this.main.getCurrentWorkspace()==null)return;let u=this.main.getCurrentWorkspace().getModuleByMonacoModel(this.editor.getModel());this.main instanceof Zt&&u!=null&&this.main.projectExplorer.setActiveAfterExternalModelSet(u)}),monaco.languages.registerHoverProvider("vscSQL",new Yi(this)),monaco.languages.registerCompletionItemProvider("vscSQL",new to(this.main)),monaco.languages.registerCodeActionProvider("vscSQL",new no(this.main)),monaco.languages.registerReferenceProvider("vscSQL",new ro(this.main)),monaco.languages.registerSignatureHelpProvider("vscSQL",new io(this.main)),this.editor.onMouseDown(r=>{const o=r.target.detail;r.target.type!==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&r.target.type!==monaco.editor.MouseTargetType.GUTTER_LINE_NUMBERS||o.isAfterLines||t.onMarginMouseDown(r.target.position.lineNumber)}),setTimeout(()=>{monaco.editor.remeasureFonts()},2e3),this.addActions(),this.editor.onDidType(r=>{t.onDidType(r)}),this.editor}onDidType(e){const t=(i,r,o,u)=>{const f=new monaco.Range(i.lineNumber,i.column,i.lineNumber,i.column);this.editor.executeEdits("new-bullets",[{range:f,text:r}]),this.editor.setPosition({lineNumber:o,column:u})};if(e===`
`){const i=this.editor.getModel(),r=this.editor.getPosition(),o=i.getLineContent(r.lineNumber-1);if(o.trim().indexOf("/*")===0&&!o.trimRight().endsWith("*/")&&!(r.lineNumber<i.getLineCount()?i.getLineContent(r.lineNumber+1):"").trim().startsWith("*")){let f=o.substr(0,o.length-o.trimLeft().length);o.trim().indexOf("/**")===0?t(r,`
`+f+" */",r.lineNumber,r.column+3+f.length):t(r,` * 
`+f+" */",r.lineNumber,r.column+3+f.length)}}}setFontSize(e){let t=new Date().getTime();if(t-this.lastTime<150)return;this.lastTime=t;let i=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize);if(this.main instanceof Zt&&this.main.viewModeController.saveFontSize(e),e!=i){this.editor.updateOptions({fontSize:e});let o=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize)/e;this.editor.updateOptions({fontSize:e/o})}jQuery(".jo_editorFontSize").css("font-size",e+"px"),jQuery(".jo_editorFontSize").css("line-height",e+2+"px"),document.documentElement.style.setProperty("--breakpoint-size",e+"px"),document.documentElement.style.setProperty("--breakpoint-radius",e/2+"px"),this.main.getBottomDiv().errorManager.registerLightbulbOnClickFunctions()}changeEditorFontSize(e,t=!0){let i=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize);t&&(i<10?e*=1:i<20?e*=2:e*=4);let r=i+e;r>=6&&r<=80&&this.setFontSize(r)}addActions(){let e=this;this.editor.addAction({id:"Find bracket",label:"Finde korrespondierende Klammer",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_K],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(t){return t.getAction("editor.action.jumpToBracket").run(),null}}),this.editor.addAction({id:"Execute statement",label:"SQL-Anweisung ausführen",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1,run:function(t){return e.main.getActionManager().trigger("execute"),null}})}onMarginMouseDown(e){}onDidChangeCursorPosition(e){e==null&&(e=this.editor.getPosition());let t=this.getCurrentlyEditedModule();if(t==null){this.elementDecoration=this.editor.deltaDecorations(this.elementDecoration,[]);return}let i=t.getElementAtPosition(e.lineNumber,e.column),r=[];if(i!=null){let f=i.usagePositions.get(t);if(f!=null)for(let g of f)r.push({range:{startColumn:g.column,startLineNumber:g.line,endColumn:g.column+g.length,endLineNumber:g.line},options:{className:"jo_revealSyntaxElement",isWholeLine:!1,overviewRuler:{color:{id:"editorIndentGuide.background"},darkColor:{id:"editorIndentGuide.activeBackground"},position:monaco.editor.OverviewRulerLane.Left}}})}let o=!1;for(let u of t.getSQLSTatementsAtSelection(this.editor.getSelection())){let f="jo_highlightStatementGreen";u!=null&&(u.hasErrors?(f="jo_highlightStatementRed",u.acceptedBySQLite&&(f="jo_highlightStatementYellow",o=!0)):o=!0,r.push({range:{startColumn:u.from.column,startLineNumber:u.from.line,endColumn:u.to.column,endLineNumber:u.to.line},options:{className:f,isWholeLine:!1,overviewRuler:{color:{id:f},darkColor:{id:f},position:monaco.editor.OverviewRulerLane.Left},minimap:{color:{id:f},position:monaco.editor.MinimapPosition.Inline},zIndex:-100}}))}this.main.getActionManager().setActive("execute",o),o&&!this.main.isEmbedded()&&nt.showHelper("playButtonHelper",this.main,jQuery("div.img_start-dark")),this.elementDecoration=this.editor.deltaDecorations(this.elementDecoration,r)}getCurrentlyEditedModule(){return this.main.getCurrentlyEditedModule()}}class ao{constructor(){w(this,"autoFormatTriggerCharacters",[`
`]);w(this,"displayName","Java-Autoformat")}init(){monaco.languages.registerDocumentFormattingEditProvider("myJava",this),monaco.languages.registerOnTypeFormattingEditProvider("myJava",this)}provideOnTypeFormattingEdits(e,t,i,r,o){let u=this.format(e);return Promise.resolve(u)}deleteOverlappingRanges(e){for(let t=0;t<e.length-1;t++){let i=e[t],r=e[t+1];if(!(i.range.endLineNumber<r.range.startLineNumber)&&i.range.endLineNumber==r.range.startLineNumber){if(i.range.endColumn>=r.range.startColumn)e.splice(t+1,1);else if(i.range.endColumn==0&&i.text.length>0&&r.range.startColumn==1&&r.range.endColumn>r.range.startColumn&&r.text==""){let o=i.text.length-(r.range.endColumn-r.range.startColumn);o>0?(i.text=i.text.substr(0,o),e.splice(t+1,1)):o<0?(r.range.endColumn=r.range.startColumn-o,e.splice(t,1),t--):(e.splice(t,2),t--)}}}}provideDocumentFormattingEdits(e,t,i){let r=this.format(e);return Promise.resolve(r)}format(e){let t=[],i=e.getValue(monaco.editor.EndOfLinePreference.LF),r=new tn().lex(i).tokens;if(r==null)return[];let o=null,u=0,f=3,g=[],y=[],C=0,T=0;for(let D=0;D<r.length;D++){let Q=r[D];switch(C--,Q.tt){case a.leftCurlyBracket:if(u++,g.push(Q.position.line),o!=null){let M=o.tt;(M==a.rightBracket||M==a.identifier||M==a.leftRightSquareBracket)&&this.replaceBetween(o,Q,t," ")}if(D<r.length-1){let M=r[D+1];M.tt!=a.newline&&M.tt!=a.space&&this.insertSpaces(t,M.position.line,M.position.column,1)}break;case a.rightCurlyBracket:y[y.length-1]==u&&(y.pop(),u--,this.deleteSpaces(t,Q.position.line,1,3)),u--;let N=g.pop();if(N!=null&&N!=Q.position.line)o!=null&&o.position.line==Q.position.line&&this.replace(t,Q.position,Q.position,`
`+" ".repeat(u*f));else if(D>0){let M=r[D-1];M.tt!=a.space&&M.tt!=a.newline&&this.insertSpaces(t,Q.position.line,Q.position.column,1)}break;case a.leftBracket:if(T++,D<r.length-2){let M=r[D+1],H=r[D+2];M.tt==a.space&&H.tt!=a.newline&&(this.deleteSpaces(t,M.position.line,M.position.column,M.position.length),D++,H.tt==a.rightBracket&&(D++,T--))}if(D>1){let M=r[D-1],H=r[D-2];M.tt==a.space&&H.tt!=a.newline&&!this.isBinaryOperator(H.tt)&&M.position.length==1&&this.deleteSpaces(t,M.position.line,M.position.column,1)}break;case a.rightBracket:if(T--,D>1){let M=r[D-1],H=r[D-2];M.tt==a.space&&H.tt!=a.newline&&this.deleteSpaces(t,M.position.line,M.position.column,M.position.length)}break;case a.newline:if(C=2,D<r.length-2){let M=this.isBinaryOperator(o==null?void 0:o.tt),H=this.isBinaryOperator(this.getNextNonSpaceToken(D,r).tt),F=r[D+1],Ye=r[D+2],ye=0;if(F.tt==a.newline)break;let de=0;if(F.tt==a.space){if(Ye.tt==a.newline)break;ye=F.position.length,D++,Ye.tt==a.rightCurlyBracket&&(de=-1)}F.tt==a.rightCurlyBracket&&(de=-1),(H||M)&&(de=1);let Ae=u+de;T>0&&Ae++,Ae<0&&(Ae=0);let _e=Ae*f;_e>ye?this.insertSpaces(t,Q.position.line+1,0,_e-ye):_e<ye&&this.deleteSpaces(t,Q.position.line+1,0,ye-_e)}break;case a.space:D<r.length-1&&r[D+1].tt!=a.comment&&D>0&&r[D-1].tt!=a.newline&&Q.position.length>1&&this.deleteSpaces(t,Q.position.line,Q.position.column,Q.position.length-1);break;case a.comma:case a.semicolon:if(D>1){let M=r[D-1],H=r[D-2];M.tt!=a.newline&&H.tt!=a.newline&&!this.isBinaryOperator(H.tt)&&M.tt==a.space&&M.position.length==1&&this.deleteSpaces(t,M.position.line,M.position.column,1)}if(D<r.length-1){let M=r[D+1];M.tt!=a.comment&&M.tt!=a.space&&M.tt!=a.newline&&this.insertSpaces(t,M.position.line,M.position.column,1)}break;case a.rightSquareBracket:o!=null&&o.tt==a.leftSquareBracket&&this.replaceBetween(o,Q,t,"");break}if(this.isBinaryOperator(Q.tt)){let N=Q.tt==a.lower&&this.lowerBelongsToGenericExpression(D,r),M=Q.tt==a.greater&&this.greaterBelongsToGenericExpression(D,r);if(C<=0&&o!=null&&[a.leftBracket,a.comma].indexOf(o.tt)<0){if(D>0){let H=r[D-1],F=N||M?0:1;H.tt==a.space?H.position.length!=F&&this.insertSpaces(t,H.position.line,H.position.column,F-H.position.length):F==1&&this.insertSpaces(t,Q.position.line,Q.position.column,1)}if(D<r.length-1){let H=r[D+1],F=N?0:1;H.tt==a.space?(M&&D<r.length-2&&r[D+2].tt==a.leftBracket&&(F=0),H.position.length!=F&&this.insertSpaces(t,H.position.line,H.position.column,F-H.position.length)):(M&&H.tt==a.leftBracket&&(F=0),F==1&&this.insertSpaces(t,H.position.line,H.position.column,1))}}}Q.tt!=a.space&&Q.tt!=a.newline&&(o=Q)}return this.deleteOverlappingRanges(t),t}getNextNonSpaceToken(e,t){if(e==t.length-1)return t[e];let i=e+1;for(;i<t.length-1&&t[i].tt==a.space;)i++;return t[i]}lowerBelongsToGenericExpression(e,t){let i=e+1;for(;i<t.length;){let r=t[i].tt;if(r==a.greater)return!0;if([a.space,a.comma,a.identifier].indexOf(r)<0)return!1;i++}return!1}greaterBelongsToGenericExpression(e,t){let i=e-1;for(;i>=0;){let r=t[i].tt;if(r==a.lower)return!0;if([a.space,a.comma,a.identifier].indexOf(r)<0)return!1;i--}return!1}isBinaryOperator(e){return e!=null&&e>=a.modulo&&e<=a.equal}replaceBetween(e,t,i,r){let o={line:e.position.line,column:e.position.column+e.position.length},u={line:t.position.line,column:t.position.column};(o.line!=u.line||u.column-o.column!=r.length)&&this.replace(i,o,u,r)}deleteSpaces(e,t,i,r){e.push({range:{startColumn:i,startLineNumber:t,endColumn:i+r+(i==0?1:0),endLineNumber:t},text:""})}insertSpaces(e,t,i,r){if(r<0){this.deleteSpaces(e,t,i,-r);return}e.push({range:{startColumn:i,startLineNumber:t,endColumn:i,endLineNumber:t},text:" ".repeat(r)})}replace(e,t,i,r){e.push({range:{startColumn:t.column,startLineNumber:t.line,endColumn:i.column,endLineNumber:i.line},text:r})}}function ci(c,e){var t=new c.Database(e);return t.create_function("month",function(i){var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let o=i.match(r);return o?Number(o[1]):-1}),t.create_function("day",function(i){var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let o=i.match(r);return o?Number(o[2]):-1}),t.create_function("year",function(i){var r=/^(\d{4})[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;let o=i.match(r);return o?Number(o[1]):-1}),t.create_function("isDate",function(i){if(i==null)return!0;if(typeof i!="string")return!1;var r=/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/;if(i.match(r)){var o=i.split("/"),u=i.split("-"),f=o.length,g=u.length;if(f>1)var y=i.split("/");else if(g>1)var y=i.split("-");if(y.length!=3)return!1;var C=parseInt(y[2]),T=parseInt(y[1]),D=parseInt(y[0]),Q=[31,28,31,30,31,30,31,31,30,31,30,31];if((T==1||T>2)&&C>Q[T-1])return!1;if(T==2){var N=!1;return(!(D%4)&&D%100||!(D%400))&&(N=!0),!(N==!1&&C>=29||N==!0&&C>29)}return!0}else return!1}),t.create_function("isDateTime",function(i){if(i==null)return!0;if(typeof i!="string")return!1;var r=/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;if(i.match(r)){var o=i.split(" "),u=o[0];if(u.length!=10)return!1;var f=parseInt(u.substring(8,10)),g=parseInt(u.substring(5,7)),y=parseInt(u.substring(0,4)),C=[31,28,31,30,31,30,31,31,30,31,30,31];if((g==1||g>2)&&f>C[g-1])return!1;if(g==2){var T=!1;return(!(y%4)&&y%100||!(y%400))&&(T=!0),!(T==!1&&f>=29||T==!0&&f>29)}return!0}else return!1}),t.create_function("isTime",function(i){if(i==null)return!0;if(typeof i!="string")return!1;var r=/^([01][0-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/;return i.match(r)!=null}),t.create_function("concat",function(i){if(arguments==null)return"";let r="";for(let o=0;o<arguments.length;o++)r+=""+arguments[o];return r}),t}class lo{constructor(){w(this,"initsql",initSqlJs({locateFile:(e,t)=>"https://embed.learn-sql.de/include/lib/sql.js/sql-wasm.wasm"}));w(this,"db");w(this,"SQL");w(this,"onmessage");w(this,"onError")}postMessageToClient(e){this.onmessage({data:e})}postMessage(e){let t=this;t.db==null?t.initsql.then(i=>{t.SQL=i,t.db=ci(i,void 0),t.worker(e)}).catch(i=>(console.log(i),t.postMessageToClient({id:this.data.id,error:i.message}))):t.worker(e)}terminate(){}worker(e){var t,i,r=e.config?e.config:{};try{switch(e&&e.action){case"open":return t=e.buffer,this.db=ci(this.SQL,t&&new Uint8Array(t)),this.postMessageToClient({id:e.id,ready:!0});case"exec":if(this.db===null&&(this.db=ci(this.SQL,void 0)),!e.sql)throw"exec: Missing query string";return this.postMessageToClient({id:e.id,results:this.db.exec(e.sql,e.params,r)});case"each":this.db===null&&(this.db=ci(this.SQL,void 0));var o=function(g){return this.postMessage({id:e.id,row:g,finished:!1})},u=function(){return this.postMessage({id:e.id,finished:!0})};return this.db.each(e.sql,e.params,o,u,r);case"export":t=this.db.export(),i={id:e.id,results:[{buffer:t}]};try{return this.postMessageToClient(i)}catch{return this.postMessageToClient(i)}case"close":return this.db&&this.db.close(),this.postMessageToClient({id:e.id});default:throw new Error("Invalid action : "+(e&&e.action))}}catch(f){return this.postMessageToClient({id:e.id,error:f.message})}}}class Et{constructor(e){w(this,"databaseDirectoryEntries",null);w(this,"worker");w(this,"queryId",0);w(this,"querySuccessCallbacksMap",new Map);w(this,"queryErrorCallbackMap",new Map);w(this,"databaseStructure");w(this,"isReloading",!1);this.main=e}initializeWorker(e,t,i,r){this.main.getWaitOverlay().show("Bitte warten, die Datenbank wird initialisiert..."),this.worker!=null&&this.worker.terminate(),performance.now();let o="worker/sqljs-worker.js";this.main.isEmbedded()&&(o=window.javaOnlineDir+o),window.jo_doc?this.worker=new lo:this.worker=new Worker(o);let u=this,f=[];this.worker.onmessage=()=>{u.worker.onmessage=C=>{let T=C.data.id;if(C.data.error==null){let D=u.querySuccessCallbacksMap.get(T);D!=null&&D(C.data.results)}else{let D=u.queryErrorCallbackMap.get(T);D!=null&&D(C.data.error)}this.queryErrorCallbackMap.delete(T),this.querySuccessCallbacksMap.delete(T)},t==null&&(t=[]),t=t.slice(),t.unshift("PRAGMA foreign_keys = OFF;"),t.push("PRAGMA foreign_keys = ON;");let g=t.length,y=()=>{if(t.length>0){this.main.getWaitOverlay().setProgress(`${Math.round((1-t.length/g)*100)+" %"}`);let C=t.shift();u.executeQuery(C,T=>{y()},T=>{f.push("Error while setting up database: "+T+", query: "+C),y()})}else i!=null&&i(f),u.retrieveDatabaseStructure(()=>{r&&r(),this.main.getWaitOverlay().hide()})};y()},this.worker.onerror=g=>{f.push("Worker error: "+g.error),console.log("Worker error: "+g.error)},this.worker.postMessage({id:u.queryId++,action:"open",buffer:e})}executeQuery(e,t,i){var r;if(console.debug("Executing query:",e),this.main.isEmbedded()&&!this.isReloading){const o=this.main;if(((r=o.config)==null?void 0:r.databaseURL)!=null&&o.fetcher!=null&&!this.isSystemQuery(e)){this.isReloading=!0,o.fetcher.load(o.config.databaseURL).then(u=>{o.initialTemplateDump=u.binDump,this.initializeWorker(u.binDump,u.statements||[],()=>{this.isReloading=!1,this.executeQueryInternal(e,t,i),this.saveSQLutionDatabase()},()=>{})}).catch(u=>{this.isReloading=!1,console.error("Fehler beim automatischen Reload der Datenbank:",u),i("Database reload failed: "+u)});return}}this.executeQueryInternal(e,t,i)}saveSQLutionDatabase(){var t;if(console.debug("Saving SQLution database..."),!this.main.isEmbedded())return;const e=this.main;((t=e.config)==null?void 0:t.databaseURL)==null||e.fetcher==null||this.export(i=>{const r=i.buffer instanceof ArrayBuffer?i.buffer:new ArrayBuffer(i.buffer.byteLength);i.buffer instanceof ArrayBuffer||new Uint8Array(r).set(new Uint8Array(i.buffer));const o=new Blob([new Uint8Array(r)],{type:"application/octet-stream"}),u=document.querySelector("[name=csrfmiddlewaretoken]").value;fetch("/api/upload_db/",{method:"POST",headers:{"Content-Type":"application/octet-stream","X-CSRFToken":u},body:o}).then(f=>{f.ok||console.error(f)})},i=>{console.error("Export failed: "+i)})}isSystemQuery(e){const t=["PRAGMA","SELECT name, sql, type FROM sqlite_master","PRAGMA table_info(","PRAGMA foreign_key_list(","select count(*) from"],i=e.trim().toUpperCase();return t.some(r=>i.startsWith(r.toUpperCase()))}executeQueryInternal(e,t,i){console.debug("Actually executing query:",e);let r=this.queryId++;this.querySuccessCallbacksMap.set(r,t),this.queryErrorCallbackMap.set(r,i),this.worker.postMessage({id:r,action:"exec",sql:e,params:{}})}export(e,t){let i=this.queryId++;this.querySuccessCallbacksMap.set(i,r=>{e(r[0].buffer)}),this.queryErrorCallbackMap.set(i,t),this.worker.postMessage({id:i,action:"export",params:{}})}getDirectoryEntries(e){this.databaseDirectoryEntries!=null?e(this.databaseDirectoryEntries):jQuery.getJSON("assets/databases/directory.json",function(t){e(t)})}retrieveDatabaseStructure(e){let t="SELECT name, sql, type FROM sqlite_master WHERE type='table' or type='view';",i=this;this.executeQuery(t,r=>{var g;let o="",u=(g=r[0])==null?void 0:g.values,f=u==null?void 0:u.map(y=>y[2]);u==null||u.forEach(y=>o+=`PRAGMA table_info("${y[0]}");
PRAGMA foreign_key_list("${y[0]}");
select count(*) from "${y[0]}";

`),o!=""?this.executeQuery(o,y=>{i.databaseStructure=i.parseDatabaseStructure(r,y,f),e(i.databaseStructure)},y=>{console.log(y),i.databaseStructure={tables:[]},e(i.databaseStructure)}):(i.databaseStructure={tables:[]},e(i.databaseStructure))},r=>{console.log(r)})}parseDatabaseStructure(e,t,i){var u;this.databaseStructure={tables:[]};let r=new Map,o=0;for(let f=0;f<e[0].values.length;f++){let g=e[0].values[f][0],y=e[0].values[f][1],C={name:g,size:0,completeSQL:y,columns:[],type:i[f]};r.set(g.toLocaleLowerCase(),C),this.databaseStructure.tables.push(C);let T=t[o].values,D=null;t.length>o+1&&t[o+1].columns[0]=="id"&&(D=t[o+1].values,o++),o++;let Q=t[o].values[0][0];o++,C.size=Q,T.forEach(N=>{N[0];let M=N[1],H=N[2],F=N[3]==1,Ye=N[4],ye=N[5]!=0,de=[];if(H.indexOf("Enum")>=0){let _e=`"${M}" ${H} .* check\\("${M}" in \\((.*)\\)\\)`,h=new RegExp(_e),ht=y.match(h);ht!=null&&(de=ht[1].split(", "))}let Ae={name:M,isPrimaryKey:ye,isAutoIncrement:ye&&y.toLowerCase().indexOf("autoincrement")>=0,completeTypeSQL:H,enumValues:de,table:C,typeLengths:[],defaultValue:Ye,notNull:F};if(D!=null){let _e=D.find(h=>h[3].toLocaleLowerCase()==M.toLocaleLowerCase());_e!=null&&(Ae.referencesRawData=_e)}C.columns.push(Ae)})}for(let f of this.databaseStructure.tables)for(let g of f.columns)if(g.referencesRawData!=null){let y=r.get((u=g.referencesRawData[2])==null?void 0:u.toLocaleLowerCase());if(y==null)continue;let C=y.columns.find(T=>T.name.toLocaleLowerCase()==g.referencesRawData[4].toLocaleLowerCase());g.references=C}return this.databaseStructure}static getDumpType(e){let t=[83,81,76,105,116,101],i=120,r=!0;for(let o=0;o<t.length;o++)if(t[o]!=e[o]){r=!1;break}return r?"binaryUncompressed":e[0]==i?"binaryCompressed":"other"}}class or{constructor(){w(this,"MaxRowsPerInsert",300)}clean(e){switch(e.ast.type){case a.keywordCreate:return e.sqlCleaned=this.cleanCreateTableStatement(e.ast),e.sql;case a.keywordInsert:return e.ast.select!=null||(e.sqlCleaned=this.cleanInsertStatement(e.ast)),e.sql;default:return e.sql}}cleanInsertStatement(e){let t=`insert into ${e.table.identifier}`;e.columnList!=null&&e.columnList.length>0&&(t+=`(${e.columnList.map(o=>this.escapeIdentifier(o.identifier)).join(", ")})`),t+=`
values`;let i="",r=[];if(e.values!=null&&e.values.length>0)for(let o of e.values)r.push(`
(${o.map(u=>this.cleanValue(u)).join(", ")})`);for(;r.length>0;)i+=t,i+=r.splice(0,Math.max(this.MaxRowsPerInsert,r.length)).join(`,
`),i+=`;
`;return i}cleanValue(e){if(e.constantType==a.stringConstant){let t=e.constant;return t=t.replace(/'/g,"''"),`'${t}'`}else return e.constant}cleanCreateTableStatement(e){let t=`create table ${e.ifNotExists?" if not exists":""} ${this.escapeIdentifier(e.identifier)}(
   `;t+=e.columnList.map(r=>this.cleanColumnDef(r)).join(`,
   `),e.foreignKeyInfoList!=null&&e.foreignKeyInfoList.length>0&&(t+=`,
   `+e.foreignKeyInfoList.map(r=>this.cleanForeignKeyInfo(r)).join(`,
   `));let i=e.combinedPrimaryKeyColumns.slice();for(let r of e.columnList){let o=r.identifier;r.isAutoIncrement&&i.indexOf(o)>=0&&i.splice(i.indexOf(o),1)}return i.length>0&&(t+=`,
   primary key(${this.escapeIdentifiers(i).join(", ")})`),e.uniqueConstraints.length>0&&(t+=`,
   `+e.uniqueConstraints.map(r=>"unique("+this.escapeIdentifiers(r).join(", ")+")").join(`,
   `)),t+=`
);`,t}cleanForeignKeyInfo(e){let t=`foreign key (${this.escapeIdentifier(e.column)}) references ${this.escapeIdentifier(e.referencesTable)}(${this.escapeIdentifier(e.referencesColumn)})`;return e.onDelete&&(t+=" on delete "+e.onDelete),e.onUpdate&&(t+=" on update "+e.onUpdate),t}cleanColumnDef(e){let t=e.baseType.getSQLiteType();t=="int"&&e.isAutoIncrement&&(t="integer");let i=`${this.escapeIdentifier(e.identifier)} ${t}`;if(e.parameters!=null&&e.parameters.length>0&&!e.isAutoIncrement&&(i+=`(${e.parameters.join(", ")})`),e.notNull&&(i+=" not null"),e.defaultValue!=null&&(i+=" default "+e.defaultValue),(e.isPrimary||e.isAutoIncrement)&&(i+=" primary key"),e.isAutoIncrement&&(i+=" autoincrement"),e.foreignKeyInfo!=null){let u=e.foreignKeyInfo,f=u.referencesColumn;u.referencesTable&&(f=this.escapeIdentifier(u.referencesTable)+"("+this.escapeIdentifier(f)+")"),i+=" references "+f,u.onDelete&&(i+=" on delete "+u.onDelete),u.onUpdate&&(i+=" on update "+u.onUpdate)}if(e.collate!=null){let u=e.collate.toLocaleLowerCase();["binary","nocase","rtrim"].indexOf(u)>=0&&(i+=" collate "+u)}let r=e.parameters?e.parameters:[0,0],o=e.baseType.checkFunction(this.escapeIdentifier(e.identifier),r);return o!=""&&(i+=" "+o),i}escapeIdentifier(e){return'"'+e+'"'}escapeIdentifiers(e){return e.map(this.escapeIdentifier)}}class uo{constructor(e){w(this,"createTableNodes");w(this,"insertNodes");w(this,"tableModifyingNodes");this.main=e}async loadFromUrl(e){if(e==null)return;let t=null;return e.endsWith(".zip")?t=await this.unzipURL(e):t=await(await fetch(e)).text(),this.importFromText(t)}async loadFromFile(e){if(e!=null)if(e.name.endsWith(".zip")){let t=await this.unzipFile(e);return this.importFromText(t)}else return new Promise((t,i)=>{var r=new FileReader;r.onload=o=>{let u=o.target.result;t(this.importFromText(u))},r.readAsText(e)})}async unzipURL(e){const t=new zip.ZipReader(new zip.HttpReader(e));return this.unzipIntern(t)}async unzipFile(e){const t=new zip.ZipReader(new zip.BlobReader(e));return this.unzipIntern(t)}async unzipIntern(e){let t=await e.getEntries();t=t.filter(r=>r.filename.endsWith(".sql"));let i="";if(t.length)for(let r of t)i+=await r.getData(new zip.TextWriter,{onprogress:(o,u)=>{}});return await e.close(),i}async importFromText(e){if(e==null)return null;let i=new tn().lex(e),r=new gi,o=new dt({dirty:!1,name:"",saved:!0,student_edited_after_revision:!1,submitted_date:null,text:e,text_before_revision:null,version:0},this.main);o.tokenList=i.tokens,r.parse(o),this.createTableNodes=o.sqlStatements.filter(u=>u.ast.type==a.keywordCreate).map(u=>u.ast),this.insertNodes=o.sqlStatements.filter(u=>u.ast.type==a.keywordInsert).map(u=>u.ast),this.tableModifyingNodes=o.sqlStatements.filter(u=>u.ast.type==a.keywordAlter&&u.ast.kind=="omittedKind").map(u=>u.ast);for(let u of this.tableModifyingNodes){let f=this.findCreateTableNode(u.tableIdentifier);if(f!=null){if(u.primaryKeys!=null&&(f.combinedPrimaryKeyColumns=u.primaryKeys,f.columnList.forEach(g=>g.isPrimary=!1)),u.autoIncrementColumn!=null){let g=this.findCreateTableColumnNode(f,u.autoIncrementColumn);g!=null&&(g.isPrimary=!0)}if(u.modifyColumnInfo!=null)for(let g of u.modifyColumnInfo){let y=this.findCreateTableColumnNode(f,g.identifier),C=f.columnList.indexOf(y);f.columnList.splice(C,1,g)}if(u.foreignKeys!=null)for(let g of u.foreignKeys)f.foreignKeyInfoList.push(g);if(u.indices!=null)for(let g of u.indices)o.sqlStatements.push({acceptedBySQLite:!0,from:null,to:null,hasErrors:!1,ast:{type:a.keywordIndex,columnIdentifier:g.column,indexIdentifier:g.index_name,tableIdentifier:u.tableIdentifier,unique:g.unique,position:null,endPosition:null,symbolTable:null},sql:`create ${g.unique?"unique ":""}index ${g.index_name} on ${u.tableIdentifier}(${g.column});`,resultTypes:[]})}}return this.makeDatabase(o.sqlStatements)}findCreateTableNode(e){return e=e.toLocaleLowerCase(),this.createTableNodes.find(t=>t.identifier.toLocaleLowerCase()==e)}findCreateTableColumnNode(e,t){return t=t.toLocaleLowerCase(),e.columnList.find(i=>i.identifier.toLocaleLowerCase()==t)}async makeDatabase(e){let t=new or,i=e.filter(u=>u.ast.type!=a.omittedeStatement).map(u=>t.clean(u));i.unshift("PRAGMA foreign_keys = OFF;"),i.push("PRAGMA foreign_keys = ON;");let r=new Et(this.main);return new Promise((u,f)=>{r.initializeWorker(null,i,()=>{r.export(g=>{u({binDump:g})},g=>{f(g)})})})}}class ar{async loadFromFile(e,t){if(e!=null)if(t.getWaitOverlay().show("Lese Datei ein..."),e.name.endsWith(".sql")||e.name.endsWith(".zip")){let r=await new uo(t).loadFromFile(e);return t.getWaitOverlay().hide(),r}else{var i=new FileReader;return new Promise((r,o)=>{i.onload=u=>{let f=u.target.result,g=new Uint8Array(f);Et.getDumpType(g)=="binaryCompressed"&&(g=pako.inflate(g)),t.getWaitOverlay().hide(),r({binDump:g})},i.readAsArrayBuffer(e)})}}saveToFile(e){e.export(t=>{let i=prompt("Bitte geben Sie den Dateinamen ein","datenbank.sqLite");if(i==null){alert("Der Dateiname ist leer, daher wird nichts gespeichert.");return}i.endsWith(".sqLite")||(i=i+".sqLite"),sn(new Blob([t.buffer]),i,!0)},()=>{})}}class Ji{constructor(e,t,i){w(this,"$dialog");w(this,"database");this.main=e,this.owner_id=t,this.path=i,this.init()}init(){this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery(`<div class="jo_ds_heading">Neue Datenbank anlegen</div>

            <div class="jo_ds_settings">
               <div class="jo_ds_settings_caption">Name der Datenbank:</div><div><input class="dialog-input jo_databasename" value="Neue Datenbank"></input></div>
            </div>

             <div class="jo_tabheadings jo_cdtabheading">
             <div class="jo_tabheading" data-target="jo_createEmptyDatabaseTab">Leere Datenbank</div>
             <div class="jo_tabheading jo_active" data-target="jo_createDatabaseFromTemplateTab">Von Vorlage kopieren</div>
             <div class="jo_tabheading" data-target="jo_createDatabaseUseExistingTab">Bestehende Datenbank mitnutzen</div>
             <div class="jo_tabheading" data-target="jo_createDatabaseUseDumpFile">Import aus Dumpfile (SQLite- oder MySQL-Format)</div>
             </div>
             <div class="jo_tabs" style="width: 100%; margin-top: 10px">
                 <div class="jo_createEmptyDatabaseTab">
                    <div class="jo_createDatabaseDescription">
                        Erstellt wird eine leere Datenbank.
                    </div>
                 </div>
                 <div class="jo_createDatabaseFromTemplateTab jo_active">
                    <div class="jo_ds_settings">
                       <div class="jo_ds_settings_caption">Vorlage suchen:</div><div><input class="dialog-input jo_templatename"></input></div>
                    </div>
                    <div class="jo_templateListDiv">
                        <div class="jo_templateListOuter">
                            <div class="jo_templateListCaption">Vorlagen anderer Nutzer:</div> 
                            <div class="jo_scrollable jo_templatelist jo_templatelist_others"></div>
                        </div>
                        <div class="jo_templateListOuter">
                            <div class="jo_templateListCaption">Eigene Datenbank als Vorlage:</div> 
                            <div class="jo_scrollable jo_templatelist jo_templatelist_mine"></div>
                        </div>
                    </div>
                </div>
                <div class="jo_createDatabaseUseExistingTab">
                    <div class="jo_createDatabaseDescription">Wenn Du die Datenbank einer anderen Nutzerin/eines anderen Nutzers mitnutzen möchtest, brauchst Du einen Zugriffscode von ihr/ihm. Er ist unter Datenbank->Einstellungen zu finden.            
                    </div>
                    <div class="jo_ds_settings">
                       <div class="jo_ds_settings_caption">Zugriffscode:</div><div><input class="dialog-input jo_databasecodeinput"></input></div>
                    </div>
                 </div>
                <div class="jo_createDatabaseUseDumpFile">
                    <div class="jo_createDatabaseDescription">Wähle hier die Datei mit dem Datenbank-Dump aus (Endung .sqLite (SQLite-Datenbankdatei) oder .zip (gepackter MySql-Dump) oder .sql (MySql-Dump)):</div>
                    <input type="file" class="jo_dumpfile" name="dumpfile" style="padding: 10px"/>
                    <div class="jo_databaseimport_dropzone" style="width: 70vw; margin-left: 10px">Alternativ: Datei in dieses Feld ziehen</div>
                    <div class="jo_databaseimport_ok"></div>
                 </div>
             </div>

             <div class="dialog-buttonRow jo_ds_buttonRow">
                <button id="jo_ds_cancel_button">Abbrechen</button>
                <button id="jo_ds_create_database_button">Datenbank anlegen</button>
             </div>
            `)),rn(this.$dialog);let e=jQuery(".jo_templatelist_others"),t=jQuery(".jo_templatelist_mine"),i=this.main.user.id;this.main.networkManager.fetchTemplateList(u=>{u.sort((g,y)=>g.name.localeCompare(y.name)),u.forEach(g=>{let y=jQuery('<div class="jo_templateListEntry"></div>');y.append(jQuery(`<div class="jo_tle_firstline">${g.name} <span class="jo_tle_ownername"> (von ${g.ownerName})</span></div>`)),y.append(jQuery(`<div class="jo_tle_secondline">${g.description}</div>`)),y.data("templateId",g.id),y.data("name",g.name),g.ownerId==i?t.append(y):e.append(y),g.$tle=y,y.on("pointerdown",()=>{e.find(".jo_templateListEntry").removeClass("jo_active"),t.find(".jo_templateListEntry").removeClass("jo_active"),y.addClass("jo_active")})});let f=jQuery(".jo_templatename");f.on("input",()=>{let g=f.val();e.find(".jo_templateListEntry").hide(),t.find(".jo_templateListEntry").hide(),u.forEach(y=>{(y.name+y.ownerName+(y.description?y.description:"")).indexOf(g)>=0&&y.$tle.show()})})});let r=jQuery(".jo_databaseimport_dropzone");r.on("dragover",u=>{u.stopPropagation(),u.preventDefault(),u.originalEvent.dataTransfer.dropEffect="copy"}),r.on("drop",u=>{u.stopPropagation(),u.preventDefault();var f=u.originalEvent.dataTransfer.files;this.importFile(f)});let o=jQuery(".jo_dumpfile");o.on("change",u=>{var f=u.originalEvent.target.files;this.importFile(f).then(()=>{o.val(null)})}),this.$dialog.css("visibility","visible"),jQuery("#jo_ds_cancel_button").on("click",()=>{this.showMainWindow()}),jQuery("#jo_ds_create_database_button").on("click",()=>{let u="emptyDatabase";jQuery(".jo_createDatabaseFromTemplateTab").hasClass("jo_active")&&(u="fromTemplate"),jQuery(".jo_createDatabaseUseExistingTab").hasClass("jo_active")&&(u="useExistingDatabase"),jQuery(".jo_createDatabaseUseDumpFile").hasClass("jo_active")&&(u="useDumpFile");let f={id:null,isFolder:!1,name:jQuery(".dialog-input.jo_databasename").val(),path:this.path.join("/")};switch(u){case"emptyDatabase":this.createWorkspace(f);break;case"fromTemplate":let g=jQuery(".jo_templateListEntry.jo_active");if(g.length!=1){alert("Bitte wählen Sie genau eine Vorlage aus.");return}else f.template_database_id=g.data("templateId"),f.name=="Neue Datenbank"&&(f.name=g.data("name")),this.createWorkspace(f);break;case"useExistingDatabase":let y=jQuery(".jo_databasecodeinput").val(),C=y.indexOf("T");if(C==-1){alert("Der Zugriffscode muss das Zeichen T enthalten.");return}f.otherDatabaseId=Number.parseInt(y.substring(0,C)),f.secret=y.substring(C+1),this.createWorkspace(f);break;case"useDumpFile":if(this.database!=null)new wi().uploadCurrentDatabase(-1,this.main,this.database.binDump,"uploadBaseTemplateForWorkspace",T=>{f.template_id=T.newTemplateId,this.createWorkspace(f)});else{alert("Bitte laden Sie zuerst den Binärdump einer Datenbank hoch.");return}break}})}createWorkspace(e){this.main.networkManager.sendCreateWorkspace(e,this.owner_id,t=>{if(t!=null){alert(t);return}let i=this.main.createNewWorkspace(e.name,this.owner_id);i.path=e.path,i.id=e.id,i.sql_history="";let r=this.main.projectExplorer;this.main.workspaceList.push(i);let o={name:e.name,externalElement:i,iconClass:"workspace",isFolder:!1,path:this.path};r.workspaceListPanel.addElement(o,!0),i.panelElement=o,i.renderSettingsButton(o),r.workspaceListPanel.sortElements(),r.fileListPanel.sortElements(),r.setWorkspaceActive(i),this.showMainWindow()})}async importFile(e){let t=this,r=await new ar().loadFromFile(e[0],this.main),o=!1;if(Et.getDumpType(r.binDump)=="binaryCompressed"){let f=pako.inflate(r.binDump);Et.getDumpType(f)=="binaryUncompressed"&&(o=!0)}else Et.getDumpType(r.binDump)=="binaryUncompressed"&&(r.binDump=pako.deflate(r.binDump),o=!0);o?(t.database=r,jQuery(".jo_databaseimport_ok").html("Die Datenbankdatei wurde erfolgreich von Datei eingelesen. Sie können die Datenbank jetzt durch Klick auf den Button unten erstellen.")):alert("In der Datei befindet sich kein Binärdump einer Datenbank.")}showMainWindow(){jQuery("#main").css("visibility","visible"),this.$dialog.css("visibility","hidden"),this.$dialog.empty()}}class co{constructor(e){w(this,"currentSubmenu",{});w(this,"openSubmenusOnMousemove",!1);this.main=e}initGUI(e){let t=this,i=this.main.getMonacoEditor(),r={items:[{identifier:"Datei",subMenu:{items:[{identifier:"Speichern und Beenden",action:()=>{jQuery("#buttonLogout").trigger("click")}}]}},{identifier:"Bearbeiten",subMenu:{items:[{identifier:"Rückgängig (Strg + z)",action:()=>{i.trigger(".","undo",{})}},{identifier:"Wiederholen (Strg + y)",action:()=>{i.trigger(".","redo",{})}},{identifier:"-"},{identifier:"Kopieren (Strg + c)",action:()=>{i.getAction("editor.action.clipboardCopyAction").run()}},{identifier:"Ausschneiden (Strg + x)",action:()=>{i.getAction("editor.action.clipboardCutAction").run()}},{identifier:"Nach oben kopieren (Alt + Shift + Pfeil rauf)",action:()=>{i.getAction("editor.action.copyLinesUpAction").run()}},{identifier:"Nach unten kopieren (Alt + Shift + Pfeil runter)",action:()=>{i.getAction("editor.action.copyLinesDownAction").run()}},{identifier:"Nach oben verschieben (Alt + Pfeil rauf)",action:()=>{i.getAction("editor.action.moveLinesUpAction").run()}},{identifier:"Nach unten verschieben (Alt + Pfeil runter)",action:()=>{i.getAction("editor.action.moveLinesDownAction").run()}},{identifier:"-"},{identifier:"Suchen... (Strg + f)",action:()=>{i.getAction("actions.find").run()}},{identifier:"Ersetzen... (Strg + h)",action:()=>{i.getAction("editor.action.startFindReplaceAction").run()}},{identifier:"-"},{identifier:"Aus-/Einkommentieren (Strg + #)",action:()=>{i.getAction("editor.action.commentLine").run()}},{identifier:"Dokument formatieren (Alt + Shift + f)",action:()=>{i.getAction("editor.action.formatDocument").run()}},{identifier:"-"},{identifier:"Finde zugehörige Klammer (Strg + k)",action:()=>{i.getAction("editor.action.jumpToBracket").run()}},{identifier:"-"},{identifier:"Alles zusammenfalten",action:()=>{i.getAction("editor.foldAll").run()}},{identifier:"Alles auffalten",action:()=>{i.getAction("editor.unfoldAll").run()}},{identifier:"-"},{identifier:"Vorschlag auslösen (Strg + Leertaste)",action:()=>{i.focus(),setTimeout(()=>{i.getAction("editor.action.triggerSuggest").run()},200)}},{identifier:"Parameterhilfe (Strg + Shift + Leertaste)",action:()=>{i.getAction("editor.action.triggerParameterHints").run()}},{identifier:"Gehe zur Definition (Strg + Click)",action:()=>{i.focus(),setTimeout(()=>{i.getAction("editor.action.revealDefinition").run()},200)}}]}},{identifier:"Ansicht",subMenu:{items:[{identifier:"Theme",subMenu:{items:[{identifier:"Dark",action:()=>{t.switchTheme("dark")}},{identifier:"Light",action:()=>{t.switchTheme("light")}}]}},{identifier:"-"},{identifier:"Hoher Kontrast im Editor ein/aus",action:()=>{i.getAction("editor.action.toggleHighContrast").run()}},{identifier:"-"},{identifier:"Zoom out (Strg + Mausrad)",action:()=>{this.main.editor.changeEditorFontSize(-4)}},{identifier:"Zoom normal",action:()=>{this.main.editor.setFontSize(14)}},{identifier:"Zoom in (Strg + Mausrad)",action:()=>{this.main.editor.changeEditorFontSize(4)}}]}},{identifier:"Datenbank",subMenu:{items:[{identifier:"Neue Datenbank anlegen...",action:()=>{let o=t.main.user.id;t.main.workspacesOwnerId!=null&&(o=t.main.workspacesOwnerId),new Ji(t.main,o,[])}},{identifier:"Einstellungen...",action:()=>{new sr(this.main,this.main.currentWorkspace)}},{identifier:"Export als Binärdump (.sqLite-File)...",action:()=>{new ar().saveToFile(this.main.getDatabaseTool())}},{identifier:"Aktuellen Zustand als Vorlage hochladen...",action:()=>{let o=this.main.currentWorkspace;if(o==null){alert("Es ist kein Workspace ausgewählt.");return}if(o.database.owner_id!=this.main.user.id){alert("Die Datenbank gehört einer anderen Benutzerin/einem anderen Benutzer. Sie kann daher nicht als Vorlage hochgeladen werden.");return}if(o.database.published_to==0){alert(`Die Datenbank ist noch nicht für andere Benutzer/innen veröffentlicht, daher kann sie nicht als Vorlage hochgeladen werden. 
Die Möglichkeit zum Veröffentlichen finden Sie unter Datenbank->Einstellungen.`);return}new wi().uploadCurrentDatabase(o.id,this.main,null,"publishDatabaseAsTemplate",()=>{alert("Der aktuelle Zustand der Datebank wurde erfolgreich als Vorlage hochgeladen.")})}}]}},{identifier:"Hilfe",subMenu:{items:[{identifier:"Über die Online-IDE...",link:"https://www.learnj.de/doku.php?id=javaonline:ueber"},{identifier:"Impressum...",link:"https://www.learnj.de/doku.php?id=ide:impressum"},{identifier:"Datenschutzerklärung...",link:"https://www.learnj.de/doku.php?id=ide:datenschutzerklaerung"}]}}]};e!=null&&e.is_admin&&r.items[0].subMenu.items.push({identifier:"Shutdown server...",action:()=>{confirm("Server wirklich herunterfahren?")&&ae("shutdown",{},()=>{alert("Server erfolgreich heruntergefahren.")},o=>{alert(o)})}}),jQuery("#mainmenu").empty(),this.initMenu(r,0)}switchTheme(e){this.main.viewModeController.setTheme(e)}initMenu(e,t){e.level=t,t==0?e.$element=jQuery("#mainmenu"):(e.$element=jQuery('<div class="jo_submenu"></div>'),jQuery("body").append(e.$element)),e.$element.data("model",e);for(let r of e.items){if(r.identifier=="-")r.$element=jQuery('<div class="jo_menuitemdivider"></div>');else{let o=r.noHoverAnimation?' class="jo_menuitem_nohover"':"";if(r.$element=jQuery(`<div${o}>${r.identifier}</div>`),r.link!=null){let u=jQuery('<a href="'+r.link+'" target="_blank" class="jo_menulink"></a>');u.on("pointerdown",f=>{f.stopPropagation()}),u.on("pointerup",f=>{f.stopPropagation(),setTimeout(()=>{e.$element.hide()},500)}),u.append(r.$element),r.$element=u}r.subMenu!=null&&this.initMenu(r.subMenu,t+1),this.initMenuitemCallbacks(e,r),t==0&&r.$element.addClass("jo_mainmenuitem")}e.$element.append(r.$element),r.$element.data("model",r)}let i=this;jQuery(document).on("pointerdown",()=>{for(let r=0;r<5;r++)i.currentSubmenu[r]!=null&&(i.currentSubmenu[r].hide(),i.currentSubmenu[r]=null);i.openSubmenusOnMousemove=!1})}initMenuitemCallbacks(e,t){let i=this;t.action!=null&&(t.$element.on("pointerdown",r=>{r.stopPropagation()}),t.$element.on("pointerup",r=>{r.stopPropagation(),t.action(t.identifier);for(let o=0;o<5;o++)i.currentSubmenu[o]!=null&&(i.currentSubmenu[o].hide(),i.currentSubmenu[o]=null);i.openSubmenusOnMousemove=!1})),t.subMenu!=null?(t.$element.on("mousedown",r=>{i.opensubmenu(t),i.openSubmenusOnMousemove=!0,r.stopPropagation()}),t.$element.on("mousemove.mainmenu",()=>{i.openSubmenusOnMousemove?i.opensubmenu(t):i.currentSubmenu[e.level+1]!=null&&(i.currentSubmenu[e.level+1].hide(),i.currentSubmenu[e.level+1]=null)})):t.$element.on("mousemove.mainmenu",()=>{i.currentSubmenu[e.level+1]!=null&&(i.currentSubmenu[e.level+1].hide(),i.currentSubmenu[e.level+1]=null)})}opensubmenu(e){let t=e.subMenu,i,r;t.level==1?(i=e.$element.position().left,r=30):(i=e.$element.offset().left+e.$element.width(),r=e.$element.offset().top),t.$element.css({top:""+r+"px",left:""+i+"px"}),this.currentSubmenu[t.level]!=null&&this.currentSubmenu[t.level].hide(),t.$element.show(),this.currentSubmenu[t.level]=t.$element}}const me=class me{constructor(e,t,i,r,o,u,f,g,y,C,T){w(this,"elements",[]);w(this,"$captionElement");w(this,"$buttonNew");w(this,"$listElement");w(this,"fixed");w(this,"dontSortElements",!1);w(this,"newFilesElementCallback");w(this,"newDatabaseElementCallback");w(this,"newFolderCallback");w(this,"renameCallback");w(this,"deleteCallback");w(this,"selectCallback");w(this,"addElementActionCallback");w(this,"contextMenuProvider");w(this,"moveCallback");w(this,"dropElementCallback");w(this,"$newFolderAction");this.accordion=e,this.caption=t,this.flexWeight=i,this.newButtonClass=r,this.buttonNewTitle=o,this.defaultIconClass=u,this.withDeleteButton=f,this.withFolders=g,this.kind=y,this.enableDrag=C,this.acceptDropKinds=T,e.addPanel(this);let D=window.PointerEvent?"pointer":"mouse";if(g){let Q=this;this.$newFolderAction=jQuery('<div class="img_add-folder-dark jo_button jo_active" style="margin-right: 4px" title="Neuen Ordner auf oberster Ebene anlegen">'),this.$newFolderAction.on(D+"down",M=>{M.stopPropagation(),M.preventDefault();let H=[];this.addFolder("Neuer Ordner",H,F=>{this.newFolderCallback(F,()=>{this.sortElements(),F.$htmlFirstLine[0].scrollIntoView(),Kn(F.$htmlFirstLine.find(".jo_filename"),"background-color",[0,255,0],2e3)})})}),this.addAction(this.$newFolderAction);let N=jQuery('<div class="img_collapse-all-dark jo_button jo_active" style="margin-right: 4px" title="Alle Ordner zusammenfalten">');N.on(D+"down",M=>{M.stopPropagation(),M.preventDefault(),Q.collapseAll()}),this.addAction(N)}}collapseAll(){for(let e of this.elements)e.isFolder&&e.$htmlFirstLine.hasClass("jo_expanded")&&(e.$htmlFirstLine.removeClass("jo_expanded"),e.$htmlFirstLine.addClass("jo_collapsed")),e.path.length>0&&e.$htmlFirstLine.slideUp(200)}remove(){this.$captionElement.remove(),this.$listElement.remove()}setFixed(e){this.fixed=e,this.fixed?(this.grow(),this.$captionElement.addClass("jo_fixed")):this.$captionElement.removeClass("jo_fixed")}enableNewButton(e){this.$buttonNew!=null&&(e?this.$buttonNew.show():this.$buttonNew.hide())}getCurrentlySelectedPath(){let e=[],t=this.getSelectedElement();return t!=null&&(e=t.path.slice(0),t.isFolder&&e.push(t.name)),e}compareWithPath(e,t,i,r,o,u){t=t.slice(),t.push(e),e="",o=o.slice(),o.push(r),r="";let f=0;for(;f<t.length&&f<o.length;){let g=t[f].localeCompare(o[f]);if(g!=0)return g;f++}return t.length<o.length?-1:t.length>o.length?1:e.localeCompare(r)}getElementIndex(e,t,i){for(let r=0;r<this.elements.length;r++){let o=this.elements[r];if(this.compareWithPath(e,t,i,o.name,o.path,o.isFolder)<0)return r}return this.elements.length}insertElement(e){let t=this.getElementIndex(e.name,e.path,e.isFolder);this.elements.splice(t,0,e);let i=this.$listElement.find(".jo_file");if(t==0)this.$listElement.prepend(e.$htmlFirstLine);else if(t==i.length)this.$listElement.append(e.$htmlFirstLine);else{let r=i.get(t);jQuery(r).before(e.$htmlFirstLine)}}addFolder(e,t,i){let r={name:e,isFolder:!0,path:t},o=this.renderElement(r,!0);this.insertElement(r),o[0].scrollIntoView(),this.renameElement(r,()=>{i(r)})}renderOuterHtmlElements(e){let t=this;if(this.$captionElement=jQuery(`<div class="jo_leftpanelcaption jo_expanded">
        <div class="jo_captiontext">`+this.caption+'</div><div class="jo_actions"></div></div>'),this.newButtonClass!=null){this.$buttonNew=jQuery('<div class="jo_button jo_active '+this.newButtonClass+'" title="'+this.buttonNewTitle+'">'),this.$captionElement.find(".jo_actions").append(this.$buttonNew);let f=window.PointerEvent?"pointer":"mouse";this.$buttonNew.on(f+"down",g=>{nt.close(),g.stopPropagation();let y=t.getCurrentlySelectedPath(),C={name:"Neu",isFolder:!1,path:y},T=this.getElementIndex("",y,!1);this.elements.splice(T,0,C);let D=this.renderElement(C,!0);if(T==0)this.$listElement.prepend(D);else{let Q=this.$listElement.find(".jo_file").get(T-1);jQuery(Q).after(D)}D[0].scrollIntoView(),t.renameElement(C,()=>{t.newFilesElementCallback(C,Q=>{C.externalElement=Q,C.$htmlSecondLine!=null&&C.$htmlSecondLine.insertAfter(D),t.selectCallback!=null&&t.select(C.externalElement)})})})}let i=jQuery('<div id="filelistouter" class="jo_projectexplorerdiv jo_scrollable" data-grow="'+this.flexWeight+'" style="flex-grow: '+this.flexWeight+'"></div>');this.$listElement=jQuery('<div class="jo_filelist"></div>'),i.append(this.$listElement),e.append(this.$captionElement),e.append(i);let r=this.$captionElement,o=this.$listElement.parent(),u=window.PointerEvent?"pointer":"mouse";r.on(u+"down",f=>{if(f.button==0&&!this.fixed){let g=o.data("grow");r.hasClass("jo_expanded")?t.accordion.parts.length>1&&o.animate({"flex-grow":.001},1e3,()=>{r.toggleClass("jo_expanded")}):(r.toggleClass("jo_expanded"),o.animate({"flex-grow":g},1e3))}}),r.on("dragover",f=>{me.currentlyDraggedElementKind==t.kind&&(r.addClass("jo_file_dragover"),f.preventDefault())}),r.on("dragleave",f=>{r.removeClass("jo_file_dragover")}),r.on("drop",f=>{if(me.currentlyDraggedElementKind==t.kind){f.preventDefault(),r.removeClass("jo_file_dragover");let g=me.currentlyDraggedElement;g!=null&&t.moveElement(g,null)}})}grow(){let e=this.$listElement.parent(),t=e.data("grow");e.css("flex-grow",t),this.$captionElement.addClass("jo_expanded")}addElement(e,t){e.$htmlFirstLine=this.renderElement(e,t),this.insertElement(e)}sortElements(){this.dontSortElements||(this.elements.sort((e,t)=>{let i=e.sortName?e.sortName:e.name,r=t.sortName?t.sortName:t.name;return this.compareWithPath(i,e.path,e.isFolder,r,t.path,t.isFolder)}),this.elements.forEach(e=>{this.$listElement.append(e.$htmlFirstLine)}))}setTextAfterFilename(e,t,i){if(e==null)return;let r=e.$htmlFirstLine.find(".jo_textAfterName");r.addClass(i),r.html(t)}addAction(e){this.$captionElement.find(".jo_actions").prepend(e)}renderElement(e,t){let i=window.PointerEvent?"pointer":"mouse",r=this,o="";e.iconClass==null&&(e.iconClass=this.defaultIconClass),e.isFolder&&(e.iconClass="folder",o=t?" jo_expanded":" jo_collapsed");let u="";e.path==null&&(e.path=[]);for(let y=0;y<e.path.length;y++)u+='<div class="jo_folderline"></div>';if(e.$htmlFirstLine=jQuery(`<div class="jo_file jo_${e.iconClass} ${o}">
        <div class="jo_folderlines">${u}</div>
           <div class="jo_fileimage"></div>
           <div class="jo_filename">${Xi(e.name)}</div>
           <div class="jo_textAfterName"></div>
           <div class="jo_additionalButtonSettings"></div>
           ${this.withDeleteButton?'<div class="jo_delete img_delete jo_button jo_active"></div>':""}
           ${pi?"":'<div class="jo_settings_button img_ellipsis-dark jo_button jo_active"></div>'}
           </div>`),!t&&e.path.length>0&&e.$htmlFirstLine.hide(),this.addElementActionCallback!=null){let y=this.addElementActionCallback(e);e.$htmlFirstLine.append(y)}if(this.withFolders&&e.isFolder&&(e.$htmlFirstLine.on("dragover",y=>{me.currentlyDraggedElementKind==r.kind&&(e.$htmlFirstLine.addClass("jo_file_dragover"),y.preventDefault())}),e.$htmlFirstLine.on("dragleave",y=>{e.$htmlFirstLine.removeClass("jo_file_dragover")}),e.$htmlFirstLine.on("drop",y=>{if(me.currentlyDraggedElementKind==r.kind){y.preventDefault(),e.$htmlFirstLine.removeClass("jo_file_dragover");let C=me.currentlyDraggedElement;me.currentlyDraggedElement=null,C!=null&&r.moveElement(C,e)}})),this.withFolders||this.enableDrag){let y=e.$htmlFirstLine.find(".jo_filename");y.attr("draggable","true"),y.on("dragstart",C=>{me.currentlyDraggedElement=e,me.currentlyDraggedElementKind=r.kind,C.originalEvent.dataTransfer.effectAllowed=e.isFolder?"move":"copyMove"})}this.acceptDropKinds!=null&&this.acceptDropKinds.length>0&&(e.isFolder||(e.$htmlFirstLine.on("dragover",y=>{this.acceptDropKinds.indexOf(me.currentlyDraggedElementKind)>=0&&(e.$htmlFirstLine.addClass("jo_file_dragover"),y.ctrlKey?y.originalEvent.dataTransfer.dropEffect="copy":y.originalEvent.dataTransfer.dropEffect="move",y.preventDefault())}),e.$htmlFirstLine.on("dragleave",y=>{e.$htmlFirstLine.removeClass("jo_file_dragover")}),e.$htmlFirstLine.on("drop",y=>{if(this.acceptDropKinds.indexOf(me.currentlyDraggedElementKind)>=0){y.preventDefault(),e.$htmlFirstLine.removeClass("jo_file_dragover");let C=me.currentlyDraggedElement;me.currentlyDraggedElement=null,C!=null&&r.dropElementCallback!=null&&r.dropElementCallback(e,C,y.ctrlKey?"copy":"move")}}))),e.$htmlFirstLine.on(i+"up",y=>{if(y.button==0&&r.selectCallback!=null){r.selectCallback(e.externalElement);for(let C of r.elements)C!=e&&C.$htmlFirstLine.hasClass("jo_active")&&C.$htmlFirstLine.removeClass("jo_active");if(e.$htmlFirstLine.addClass("jo_active"),e.isFolder){e.$htmlFirstLine.hasClass("jo_expanded")?(e.$htmlFirstLine.removeClass("jo_expanded"),e.$htmlFirstLine.addClass("jo_collapsed")):(e.$htmlFirstLine.addClass("jo_expanded"),e.$htmlFirstLine.removeClass("jo_collapsed"));let C={};for(let T of this.elements)if(T.isFolder){let D=T.path.join("/");D!=""&&(D+="/"),D+=T.name,C[D]=T.$htmlFirstLine.hasClass("jo_collapsed"),C[T.path.join("/")]&&(C[D]=!0)}C[""]=!1;for(let T of this.elements)C[T.path.join("/")]?T.$htmlFirstLine.slideUp(200):T.$htmlFirstLine.slideDown(200)}}});let f=function(y){let C=[];if(r.renameCallback!=null&&C.push({caption:"Umbenennen",callback:()=>{r.renameElement(e)}}),e.isFolder&&(C=C.concat([{caption:"Neuen Unterordner anlegen (unterhalb '"+e.name+"')...",callback:()=>{r.select(e.externalElement);let T=r.getCurrentlySelectedPath();r.addFolder("Neuer Ordner",T,D=>{r.newFolderCallback(D,()=>{r.sortElements(),D.$htmlFirstLine[0].scrollIntoView(),Kn(D.$htmlFirstLine.find(".jo_filename"),"background-color",[0,255,0],2e3)})})}},{caption:"Neue Datenbank...",callback:()=>{r.select(e.externalElement),r.newDatabaseElementCallback(e.path.concat(e.name))}}])),r.contextMenuProvider!=null&&!e.isFolder)for(let T of r.contextMenuProvider(e))C.push({caption:T.caption,callback:()=>{T.callback(e)},color:T.color,subMenu:T.subMenu==null?null:T.subMenu.map(D=>({caption:D.caption,callback:()=>{D.callback(e)},color:D.color}))});C.length>0&&(y.preventDefault(),y.stopPropagation(),Tt(C,y.pageX,y.pageY))};e.$htmlFirstLine[0].addEventListener("contextmenu",f,!1);let g;return pi||e.$htmlFirstLine.on("pointerup",()=>(clearTimeout(g),!1)).on("pointerdown",y=>(g=window.setTimeout(()=>{f(y)},500),!1)),pi||(e.$htmlFirstLine.find(".jo_settings_button").on("pointerdown",y=>{f(y)}),e.$htmlFirstLine.find(".jo_settings_button").on("mousedown click",y=>{y.preventDefault(),y.stopPropagation()})),r.withDeleteButton&&(e.$htmlFirstLine.find(".jo_delete")[0].addEventListener("contextmenu",y=>{y.preventDefault(),y.stopPropagation()},!1),e.$htmlFirstLine.find(".jo_delete").on(i+"up",y=>{y.preventDefault(),Tt([{caption:"Abbrechen",callback:()=>{}},{caption:"Ich bin mir sicher: löschen!",color:"#ff6060",callback:()=>{if(e.isFolder&&r.getChildElements(e).length>0){alert("Dieser Ordner kann nicht gelöscht werden, da er nicht leer ist.");return}r.deleteCallback(e.externalElement,()=>{e.$htmlFirstLine.remove(),e.$htmlSecondLine!=null&&e.$htmlSecondLine.remove(),r.elements.splice(r.elements.indexOf(e),1),r.selectCallback!=null&&(r.elements.length>0?r.select(r.elements[0].externalElement):r.select(null))})}}],y.pageX+2,y.pageY+2),y.stopPropagation()})),e.$htmlFirstLine}moveElement(e,t){let i=t==null?[]:t.path.slice(0).concat([t.name]);if(e.isFolder){let r=[e],o=e.path.concat([e.name]).join("/");if(i.join("/").indexOf(o)==0)return;let u=e.path.length;e.path=i.slice(0);for(let f of this.elements)f.path.join("/").startsWith(o)&&(f.path.splice(0,u),f.path=i.concat(f.path),r.push(f));for(let f of r)f.$htmlFirstLine.remove(),this.elements.splice(this.elements.indexOf(f),1);for(let f of r)this.renderElement(f,!0),this.insertElement(f);this.moveCallback(r)}else e.path=i,e.$htmlFirstLine.remove(),this.elements.splice(this.elements.indexOf(e),1),this.renderElement(e,!0),this.insertElement(e),this.select(e.externalElement),e.$htmlFirstLine[0].scrollIntoView(),this.moveCallback(e)}getChildElements(e){let t=e.path.slice(0).concat(e.name).join("/");return this.elements.filter(i=>i.path.join("/").startsWith(t))}pathStartsWith(e,t){if(e.length<t.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!=t[i])return!1;return!0}renameElement(e,t){let i=this,r=e.$htmlFirstLine.find(".jo_filename"),o=e.name.indexOf("."),u=o==null?null:{start:0,end:o};this.dontSortElements=!0,Vs(r,r,f=>{e.externalElement!=null&&(f=i.renameCallback(e.externalElement,f));let g=e.name;if(e.name=f,r.html(e.name),e.isFolder){let y=e.path.slice().concat([g]),C=[];for(let T of this.elements)this.pathStartsWith(T.path,y)&&(T.path[y.length-1]=e.name,C.push(T));C.length>0&&this.moveCallback(C)}t!=null&&t(),i.sortElements(),r[0].scrollIntoView(),this.dontSortElements=!1},u)}select(e,t=!0,i=!1){if(e==null)for(let r of this.elements)r.$htmlFirstLine.hasClass("jo_active")&&r.$htmlFirstLine.removeClass("jo_active");else{let r=this.findElement(e);if(r!=null){for(let o of this.elements)o.$htmlFirstLine.hasClass("jo_active")&&o.$htmlFirstLine.removeClass("jo_active");if(r.$htmlFirstLine.addClass("jo_active"),i){let o=r.path.join("/");for(let u of this.elements){let f=u.path.slice(0);o.startsWith(f.join("/"))&&(u.isFolder&&(f.push(u.name),o.startsWith(f.join("/"))&&(u.$htmlFirstLine.removeClass("jo_collapsed"),u.$htmlFirstLine.addClass("jo_expanded"))),u.$htmlFirstLine.show())}r.$htmlFirstLine[0].scrollIntoView()}}}t&&this.selectCallback!=null&&this.selectCallback(e)}getPathString(e){let t=e.path.join("/");return e.isFolder&&(t!=""&&(t+="/"),t+=e.name),t}setElementClass(e,t){var i;e!=null&&((i=e.$htmlFirstLine)==null||i.removeClass("jo_"+e.iconClass).addClass("jo_"+t),e.iconClass=t)}findElement(e){for(let t of this.elements)if(t.externalElement==e)return t;return null}removeElement(e){for(let t of this.elements)if(t.externalElement==e){t.$htmlFirstLine.remove(),t.$htmlSecondLine!=null&&t.$htmlSecondLine.remove(),this.elements.splice(this.elements.indexOf(t),1),this.selectCallback!=null&&(this.elements.length>0?this.select(this.elements[0].externalElement):this.select(null));return}}clear(){this.$listElement.empty(),this.elements=[]}setCaption(e){this.$captionElement.find(".jo_captiontext").html(e)}getSelectedElement(){for(let e of this.elements)if(e.$htmlFirstLine.hasClass("jo_active"))return e;return null}};w(me,"currentlyDraggedElement"),w(me,"currentlyDraggedElementKind");let jt=me;class ho{constructor(e,t){w(this,"parts",[]);w(this,"$html");this.main=e,this.$html=t,t.addClass("jo_leftpanelinner")}addPanel(e){e.renderOuterHtmlElements(this.$html),this.parts.push(e)}}class fo{constructor(e,t,i){w(this,"$dialog");w(this,"$dialogMain");w(this,"studentCount",0);this.classes=e,this.workspace=t,this.main=i,this.init()}init(){this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery(`<div class="jo_ds_heading">Austeilen eines Workspace an einzelne Schüler/innen</div>
             <div class="jo_ds_settings">
                <div class="jo_ds_settings_caption">Workspace:</div><div class="jo_ds_workspacename">${this.workspace.name}</div>
                <div class="jo_ds_settings_caption">Liste filtern:</div><div class="jo_ds_filterdiv"><input class="dialog-input"></input></div>
             </div>
             <div class="jo_ds_student_list jo_scrollable">
             </div>
             <div class="jo_ds_selected_message"></div>
             <div class="dialog-buttonRow jo_ds_buttonRow">
                <button id="jo_ds_cancel_button">Abbrechen</button>
                <button id="jo_ds_distribute_button">Austeilen</button>
             </div>
            `));let e=jQuery(".jo_ds_student_list"),t=this;for(let i of this.classes)for(let r of i.students){let o=jQuery('<div class="jo_ds_student_line">'),u=jQuery(`<div class="jo_ds_student_class">${i.name}</div>`),f=jQuery(`<div class="jo_ds_student_name">${r.rufname} ${r.familienname}</div>`);o.append(u,f),e.append(o),o.on("mousedown",()=>{o.toggleClass("jo_active"),t.studentCount+=o.hasClass("jo_active")?1:-1,jQuery(".jo_ds_selected_message").text(`${t.studentCount} Schüler/inn/en selektiert`)}),o.data("student",r),o.data("klass",i)}jQuery(".jo_ds_filterdiv>input").on("input",()=>{let i=jQuery(".jo_ds_filterdiv>input").val();i==null||i==""?$(".jo_ds_student_line").show():$(".jo_ds_student_line").each((r,o)=>{let u=i.toLocaleLowerCase(),f=jQuery(o),g=f.data("klass"),y=f.data("student");(g.name+" "+y.rufname+" "+y.familienname).toLocaleLowerCase().indexOf(u)>=0?f.show():f.hide()})}),this.$dialogMain=this.$dialog.find(".dialog-main"),this.$dialog.css("visibility","visible"),jQuery("#jo_ds_cancel_button").on("click",()=>{t.close()}),jQuery("#jo_ds_distribute_button").on("click",()=>{t.distributeDatabase()}),jQuery(".jo_ds_filterdiv>input")[0].focus()}distributeDatabase(){let e=[];$(".jo_ds_student_line").each((t,i)=>{let r=jQuery(i);if(r.hasClass("jo_active")){let o=r.data("student");e.push(o.id)}}),this.close(),this.main.networkManager.sendDistributeWorkspace(this.workspace,null,e,t=>{if(t==null){let i=this.main.networkManager,r=i.updateFrequencyInSeconds*i.forcedUpdateEvery;alert(`Der Workspace ${this.workspace.name} wurde an ${e.length} Schüler/innen ausgeteilt. Er wird in maximal ${r} s bei jedem Schüler ankommen.`)}else alert(t)})}close(){this.$dialog.css("visibility","hidden"),this.$dialog.empty(),jQuery("#main").css("visibility","visible")}}class po{constructor(e,t){w(this,"programPointerModule",null);w(this,"programPointerPosition");w(this,"programPointerDecoration",[]);w(this,"accordion");w(this,"fileListPanel");w(this,"workspaceListPanel");w(this,"$homeAction");w(this,"lastOpenModule",null);this.main=e,this.$projectexplorerDiv=t}initGUI(){this.accordion=new ho(this.main,this.$projectexplorerDiv),this.initFilelistPanel(),this.initWorkspacelistPanel()}initFilelistPanel(){let e=this;this.fileListPanel=new jt(this.accordion,"Kein Workspace gewählt","1","img_add-file-dark","Neue Datei...","java",!0,!1,"file",!0,[]),this.fileListPanel.newFilesElementCallback=(t,i)=>{if(e.main.currentWorkspace==null)return alert("Bitte wählen Sie zuerst einen Workspace aus."),null;let r={name:t.name,dirty:!1,saved:!0,text:"",text_before_revision:null,submitted_date:null,student_edited_after_revision:!1,version:1,panelElement:t},o=new dt(r,e.main);e.main.currentWorkspace.moduleStore.putModule(o),e.setModuleActive(o),e.main.networkManager.sendCreateFile(o,e.main.currentWorkspace,e.main.workspacesOwnerId,f=>{f==null?i(o):alert("Der Server ist nicht erreichbar!")})},this.fileListPanel.renameCallback=(t,i)=>{i=i.substr(0,80);let r=t.file;return r.name=i,r.saved=!1,e.main.networkManager.sendUpdates(),i},this.fileListPanel.deleteCallback=(t,i)=>{var r;t&&t.file&&((r=e==null?void 0:e.main)!=null&&r.networkManager)&&e.main.networkManager.sendDeleteWorkspaceOrFile("file",t.file.id,o=>{o==null?(e.main.currentWorkspace.moduleStore.removeModule(t),i()):alert("Der Server ist nicht erreichbar!")})},this.fileListPanel.contextMenuProvider=t=>{let i=[];return e.main.user.is_teacher||e.main.user.is_admin||e.main.user.is_schooladmin||t.externalElement.file,i},this.fileListPanel.selectCallback=t=>{e.setModuleActive(t)}}renderHomeworkButton(e){var o,u;let t=(u=(o=e==null?void 0:e.panelElement)==null?void 0:o.$htmlFirstLine)==null?void 0:u.find(".jo_additionalButtonHomework");if(t==null)return;t.find(".jo_homeworkButton").remove();let i=null,r="";if(e.submitted_date!=null&&(i="img_homework",r="Wurde als Hausaufgabe abgegeben: "+e.submitted_date,e.text_before_revision&&(i="img_homework-corrected",r="Korrektur liegt vor.")),i!=null){let f=jQuery(`<div class="jo_homeworkButton ${i}" title="${r}"></div>`);t.prepend(f),i.indexOf("jo_active")>=0&&(f.on("mousedown",g=>g.stopPropagation()),f.on("click",g=>{g.stopPropagation()}))}}initWorkspacelistPanel(){let e=this;this.workspaceListPanel=new jt(this.accordion,"Datenbanken","3",null,"Neue Datenbank...","workspace",!0,!0,"workspace",!1,["file"]);let t=jQuery('<div class="img_add-database-dark jo_button jo_active" style="margin-right: 4px" title="Neue Datenbank auf oberster Ordnerebene anlegen">'),i=window.PointerEvent?"pointer":"mouse";t.on(i+"down",r=>{r.stopPropagation();let o=e.main.user.id;e.main.workspacesOwnerId!=null&&(o=e.main.workspacesOwnerId),new Ji(e.main,o,this.workspaceListPanel.getCurrentlySelectedPath())}),this.workspaceListPanel.addAction(t),this.workspaceListPanel.$buttonNew!=null&&this.workspaceListPanel.$buttonNew.hide(),this.workspaceListPanel.newDatabaseElementCallback=r=>{let o=e.main.user.id;e.main.workspacesOwnerId!=null&&(o=e.main.workspacesOwnerId),new Ji(e.main,o,r)},this.workspaceListPanel.renameCallback=(r,o)=>(o=o.substring(0,80),r.name=o,r.saved=!1,e.main.networkManager.sendUpdates(),r.database.owner_id==r.owner_id&&(r.database.name=o,e.main.networkManager.setNameAndPublishedTo(r.id,o,r.database.published_to,r.database.description,()=>{})),o),this.workspaceListPanel.deleteCallback=(r,o)=>{e.main.networkManager.sendDeleteWorkspaceOrFile("workspace",r.id,u=>{u==null?(e.main.removeWorkspace(r),r.isFolder||(e.fileListPanel.clear(),e.main.databaseExplorer.clear(),e.main.getResultsetPresenter().clear(),e.fileListPanel.enableNewButton(!1),e.main.getMonacoEditor().setModel(null)),o()):alert("Fehler: "+u)})},this.workspaceListPanel.selectCallback=r=>{r!=null&&r.isFolder||r!=this.main.currentWorkspace&&e.main.networkManager.sendUpdates(()=>{e.setWorkspaceActive(r)})},this.workspaceListPanel.newFolderCallback=(r,o)=>{let u=e.main.user.id;e.main.workspacesOwnerId!=null&&(u=e.main.workspacesOwnerId);let f=new Xt(r.name,e.main,u);f.isFolder=!0,f.path=r.path.join("/"),f.panelElement=r,r.externalElement=f,e.main.workspaceList.push(f);let g={id:-1,isFolder:!0,name:f.name,path:f.path};e.main.networkManager.sendCreateWorkspace(g,e.main.workspacesOwnerId,y=>{y==null?(f.id=g.id,o(f)):(alert("Fehler: "+y),e.workspaceListPanel.removeElement(r))})},this.workspaceListPanel.moveCallback=r=>{Array.isArray(r)||(r=[r]);for(let o of r){let u=o.externalElement;u.path=o.path.join("/"),u.saved=!1}this.main.networkManager.sendUpdates()},this.workspaceListPanel.dropElementCallback=(r,o,u)=>{let f=r.externalElement,g=o.externalElement;if(f.moduleStore.getModules(!1).indexOf(g)>=0)return;let y={name:g.file.name,dirty:!0,saved:!1,text:g.file.text,text_before_revision:null,submitted_date:null,student_edited_after_revision:!1,version:g.file.version,panelElement:null};u=="move"&&(e.main.currentWorkspace.moduleStore.removeModule(g),e.fileListPanel.removeElement(g),e.main.networkManager.sendDeleteWorkspaceOrFile("file",g.file.id,()=>{}));let C=new dt(y,e.main);f.moduleStore.putModule(C),e.main.networkManager.sendCreateFile(C,f,e.main.workspacesOwnerId,D=>{D==null||alert("Der Server ist nicht erreichbar!")})},this.$homeAction=jQuery('<div class="img_home-dark jo_button jo_active" style="margin-right: 4px" title="Meine eigenen Workspaces anzeigen">'),this.$homeAction.on(i+"down",r=>{r.stopPropagation(),e.main.networkManager.sendUpdates(()=>{e.onHomeButtonClicked()}),e.main.bottomDiv.hideHomeworkTab()}),this.workspaceListPanel.addAction(this.$homeAction),this.$homeAction.hide(),this.workspaceListPanel.contextMenuProvider=r=>{let o=[];return this.main.user.is_teacher&&this.main.teacherExplorer.classPanel.elements.length>0&&o.push({caption:"An Klasse austeilen...",callback:u=>{},subMenu:this.main.teacherExplorer.classPanel.elements.map(u=>({caption:u.name,callback:f=>{let g=u.externalElement,y=f.externalElement;this.main.networkManager.sendDistributeWorkspace(y,g,null,C=>{if(C==null){let T=this.main.networkManager,D=T.updateFrequencyInSeconds*T.forcedUpdateEvery;alert("Der Workspace "+y.name+" wurde an die Klasse "+g.name+" ausgeteilt. Er wird in maximal "+D+" s bei jedem Schüler ankommen.")}else alert(C)})}}))},{caption:"An einzelne Schüler/innen austeilen...",callback:u=>{let f=this.main.teacherExplorer.classPanel.elements.map(y=>y.externalElement),g=u.externalElement;new fo(f,g,this.main)}}),o}}onHomeButtonClicked(){this.main.teacherExplorer.restoreOwnWorkspaces(),this.main.networkManager.updateFrequencyInSeconds=this.main.networkManager.ownUpdateFrequencyInSeconds,this.$homeAction.hide(),this.fileListPanel.enableNewButton(this.main.workspaceList.length>0)}renderFiles(e){let t=e==null?"Kein Workspace vorhanden":e.name;if(this.fileListPanel.setCaption(t),this.fileListPanel.clear(),this.main.getCurrentWorkspace()!=null)for(let i of this.main.getCurrentWorkspace().moduleStore.getModules(!1))i.file.panelElement=null;if(e!=null){let i=[];for(let r of e.moduleStore.getModules(!1))i.push(r);i.sort((r,o)=>r.file.name>o.file.name?1:r.file.name<o.file.name?-1:0);for(let r of i)r.file.panelElement={name:r.file.name,externalElement:r,isFolder:!1,path:[]},this.fileListPanel.addElement(r.file.panelElement,!0),this.renderHomeworkButton(r.file);this.fileListPanel.sortElements()}}renderWorkspaces(e){this.fileListPanel.clear(),this.workspaceListPanel.clear();for(let t of e){let i=t.path.split("/");i.length==1&&i[0]==""&&(i=[]),t.panelElement={name:t.name,externalElement:t,iconClass:"workspace",isFolder:t.isFolder,path:i},this.workspaceListPanel.addElement(t.panelElement,!1),t.renderSettingsButton(t.panelElement)}this.workspaceListPanel.sortElements(),this.fileListPanel.enableNewButton(e.length>0)}renderErrorCount(e,t){if(t!=null)for(let i of e.moduleStore.getModules(!1)){let r=t.get(i),o=r==null||r==0?"":"("+r+")";this.fileListPanel.setTextAfterFilename(i.file.panelElement,o,"jo_errorcount")}}setWorkspaceActive(e,t,i=!1){if(t==null&&(t=()=>{}),e==this.main.getCurrentWorkspace()){t!=null&&t();return}if(e!=null)if(e.isFolder){this.main.currentWorkspace=null,this.main.databaseTool.initializeWorker(null,[],null,()=>{this.main.databaseExplorer.refreshAfterRetrievingDBStructure()}),this.setModuleActive(null);return}else this.fileListPanel.$buttonNew.show();this.workspaceListPanel.select(e,!1,i);let r=o=>{o!=null?(alert(o),this.main.waitOverlay.hide(),t!=null&&t()):(this.main.waitOverlay.show("Bitte warten, initialisiere Datenbank ..."),this.initializeDatabaseTool(e,t))};e!=null&&(e.database==null?(this.main.waitOverlay.show("Bitte warten, hole Datenbank vom Server ..."),this.main.networkManager.fetchDatabase(e,r)):r(null))}initializeDatabaseTool(e,t){if(!e.database){t&&t();return}let i=this.main.getDatabaseTool(),r=e.database.statements;r==null&&(r=[]),i.initializeWorker(e.database.templateDump,r,()=>{var o;if(this.main.currentWorkspace=e,((o=this.main.user)==null?void 0:o.id)==e.owner_id&&(this.main.user.currentWorkspace_id=e.id),this.renderFiles(e),e!=null){let u=e.moduleStore.getModules(!1);e.currentlyOpenModule!=null?this.setModuleActive(e.currentlyOpenModule):u.length>0?this.setModuleActive(u[0]):this.setModuleActive(null);for(let f of u)f.file.dirty=!0;u.length==0&&nt.showHelper("newSQLFileHelper",this.main,this.fileListPanel.$captionElement)}else this.setModuleActive(null);this.main.notifier.connect(e)},()=>{this.main.databaseExplorer.refreshAfterRetrievingDBStructure(),this.main.getHistoryViewer().clearAndShowStatements(e.database.statements),t!=null&&t()})}writeEditorTextToFile(){let e=this.getCurrentlyEditedModule();e!=null&&(e.file.text=e.getProgramTextFromMonacoModel())}setModuleActive(e){this.main.bottomDiv.homeworkManager.hideRevision(),this.lastOpenModule!=null&&(this.lastOpenModule.file.text=this.lastOpenModule.getProgramTextFromMonacoModel(),this.lastOpenModule.editorState=this.main.getMonacoEditor().saveViewState()),e==null?(this.main.getMonacoEditor().setModel(monaco.editor.createModel("Keine Datei vorhanden.","text")),this.main.getMonacoEditor().updateOptions({readOnly:!0})):(this.main.getMonacoEditor().updateOptions({readOnly:!1}),this.main.getMonacoEditor().setModel(e.model),e.file.text_before_revision!=null?this.main.bottomDiv.homeworkManager.showHomeWorkRevisionButton():this.main.bottomDiv.homeworkManager.hideHomeworkRevisionButton())}setActiveAfterExternalModelSet(e){this.fileListPanel.select(e,!1),this.lastOpenModule=e,e.editorState!=null&&(this.main.editor.dontPushNextCursorMove++,this.main.getMonacoEditor().restoreViewState(e.editorState),this.main.editor.dontPushNextCursorMove--),this.setCurrentlyEditedModule(e),this.showProgramPointer(),setTimeout(()=>{this.main.getMonacoEditor().getOptions().get(monaco.editor.EditorOption.readOnly)||this.main.getMonacoEditor().focus()},300)}showProgramPointer(){if(this.programPointerModule==this.getCurrentlyEditedModule()&&this.getCurrentlyEditedModule()!=null){let e=this.programPointerPosition,t={startColumn:e.column,startLineNumber:e.line,endColumn:e.column+e.length,endLineNumber:e.line};this.main.getMonacoEditor().revealRangeInCenterIfOutsideViewport(t),this.programPointerDecoration=this.main.getMonacoEditor().deltaDecorations(this.programPointerDecoration,[{range:t,options:{className:"jo_revealProgramPointer",isWholeLine:!0,overviewRuler:{color:"#6fd61b",position:monaco.editor.OverviewRulerLane.Center},minimap:{color:"#6fd61b",position:monaco.editor.MinimapPosition.Inline}}},{range:t,options:{beforeContentClassName:"jo_revealProgramPointerBefore"}}])}}showProgramPointerPosition(e,t){if(e==null)return;let i=this.main.currentWorkspace.moduleStore.findModuleByFile(e);i!=null&&(this.programPointerModule=i,this.programPointerPosition=t,i!=this.getCurrentlyEditedModule()?this.setModuleActive(i):this.showProgramPointer())}hideProgramPointerPosition(){this.getCurrentlyEditedModule()==this.programPointerModule&&this.main.getMonacoEditor().deltaDecorations(this.programPointerDecoration,[]),this.programPointerModule=null,this.programPointerDecoration=[]}getCurrentlyEditedModule(){let e=this.main.currentWorkspace;return e==null?null:e.currentlyOpenModule}setCurrentlyEditedModule(e){if(e==null)return;let t=this.main.currentWorkspace;t.currentlyOpenModule!=e&&(t.currentlyOpenModule=e,t.saved=!1,e.file.dirty=!0)}setExplorerColor(e){let t;e==null?(e="transparent",t="Meine Datenbanken"):t="Schüler-DB",this.fileListPanel.$listElement.parent().css("background-color",e),this.workspaceListPanel.$listElement.parent().css("background-color",e),this.workspaceListPanel.setCaption(t)}getNewModule(e){return new dt(e,this.main)}}class mo{constructor(e,t){w(this,"isWholePage",!1);w(this,"$tabs");w(this,"$headings");this.main=e,this.$rightDiv=t,this.$tabs=t.find(".jo_tabs"),this.$headings=t.find(".jo_tabheadings"),this.$headings.find(".jo_classDiagramTabHeading").length>0,this.$headings.find(".jo_objectDiagramTabHeading").length>0;let i=this,r="100%";t.find(".jo_whole-window").on("click",()=>{i.isWholePage=!i.isWholePage;let o=jQuery(".jo_whole-window");i.isWholePage?(jQuery("#code").css("display","none"),r=jQuery("#rightdiv").css("width"),jQuery("#rightdiv").css("width","100%"),o.removeClass("img_whole-window"),o.addClass("img_whole-window-back"),jQuery(".jo_control-container").append(jQuery("#controls")),o.attr("title","Auf normale Größe zurückführen"),jQuery(".jo_graphics").trigger("sizeChanged")):(jQuery("#code").css("display","flex"),jQuery("#rightdiv").css("width",r),o.removeClass("img_whole-window-back"),o.addClass("img_whole-window"),jQuery("#controls").insertAfter(jQuery("#view-mode")),o.attr("title","Auf Fenstergröße vergrößern"),jQuery(".jo_graphics").trigger("sizeChanged"))})}initGUI(){rn(this.$rightDiv)}}class go{constructor(e){w(this,"main");this.main=e}initSliders(){let e=this,t=window.PointerEvent?"pointer":"mouse";jQuery("#slider1").on(t+"down",o=>{let u=o.clientX;jQuery(document).on(t+"move.slider1",f=>{let g=f.clientX-u;e.moveLeftPanel(g),u=f.clientX}),jQuery(document).on(t+"up.slider1",()=>{jQuery(document).off(t+"move.slider1"),jQuery(document).off(t+"up.slider1")})}),jQuery("#slider2").on(t+"down",o=>{let u=o.clientY;jQuery(document).on(t+"move.slider2",f=>{let g=f.clientY-u;e.moveBottomDiv(g),u=f.clientY}),jQuery(document).on(t+"up.slider2",()=>{jQuery(document).off(t+"move.slider2"),jQuery(document).off(t+"up.slider2")})}),jQuery("#slider3").on(t+"down",o=>{let u=o.clientX;jQuery(document).on(t+"move.slider3",f=>{let g=f.clientX-u;e.moveRightDiv(g),u=f.clientX,f.stopPropagation()}),jQuery(document).on(t+"up.slider3",()=>{jQuery(document).off(t+"move.slider3"),jQuery(document).off(t+"up.slider3")})});let i=jQuery('<div class="jo_sliderknob img_knob jo_button jo_active" style="left: -8px" draggable="false"></div>');jQuery("#slider2").append(i),i.on(t+"down",o=>{let u=o.clientY,f=o.clientX;o.stopImmediatePropagation(),jQuery(document).on(t+"move.knobleft",g=>{let y=g.clientY-u,C=g.clientX-f;g.stopImmediatePropagation(),e.moveLeftPanel(C),e.moveBottomDiv(y),f+=C,u+=y}),jQuery(document).on(t+"up.knobleft",()=>{jQuery(document).off(t+"move.knobleft"),jQuery(document).off(t+"up.knobleft")})});let r=jQuery('<div class="jo_sliderknob img_knob jo_button jo_active" style="right: -8px" draggable="false"></div>');jQuery("#slider2").append(r),r.on(t+"down",o=>{let u=o.clientY,f=o.clientX;o.stopImmediatePropagation(),jQuery(document).on(t+"move.knobright",g=>{let y=g.clientY-u,C=g.clientX-f;g.stopImmediatePropagation(),e.moveRightDiv(C),e.moveBottomDiv(y),f+=C,u+=y}),jQuery(document).on(t+"up.knobright",()=>{jQuery(document).off(t+"move.knobright"),jQuery(document).off(t+"up.knobright")})})}moveRightDiv(e){let t=jQuery("#editor>.monaco-editor"),i=jQuery("#rightdiv"),r=Number.parseInt(i.css("width").replace("px",""));i.css("width",r-e+"px");let o=Number.parseInt(t.css("width").replace("px",""));t.css("width",o+e+"px"),this.main.getMonacoEditor().layout(),this.main.bottomDiv.homeworkManager.diffEditor!=null&&this.main.bottomDiv.homeworkManager.diffEditor.layout(),jQuery(".jo_graphics").trigger("sizeChanged"),r+=e}moveBottomDiv(e){let t=jQuery("#editor>.monaco-editor"),i=jQuery("#bottomdiv-outer"),r=Number.parseInt(i.css("height").replace("px",""));i.css("height",r-e+"px");let o=Number.parseInt(t.css("height").replace("px",""));t.css("height",o+e+"px"),this.main.getMonacoEditor().layout(),this.main.bottomDiv.homeworkManager.diffEditor!=null&&this.main.bottomDiv.homeworkManager.diffEditor.layout()}moveLeftPanel(e){let t=jQuery("#leftpanel"),i=jQuery("#editor>.monaco-editor"),r=Number.parseInt(t.css("width").replace("px",""));t.css("width",r+e+"px");let o=Number.parseInt(i.css("width").replace("px",""));i.css("width",o-e+"px"),this.main.getMonacoEditor().layout(),this.main.bottomDiv.homeworkManager.diffEditor!=null&&this.main.bottomDiv.homeworkManager.diffEditor.layout()}}function Ht(c,e=!1){var t,i;return c.vidis_akronym?c.username&&c.username.length>0?c.username:c.vidis_akronym:((t=c.familienname)==null?void 0:t.length)>0&&((i=c.rufname)==null?void 0:i.length)>0?e?c.familienname+", "+c.rufname:c.rufname+" "+c.familienname:c.username}class bo{constructor(e,t){w(this,"studentPanel");w(this,"classPanel");w(this,"ownWorkspaces");w(this,"currentOwnWorkspace");this.main=e,this.classData=t}removePanels(){this.classPanel.remove(),this.studentPanel.remove()}initGUI(){this.initStudentPanel(),this.initClassPanel(),this.renderClasses(this.classData)}initStudentPanel(){let e=this;this.studentPanel=new jt(this.main.projectExplorer.accordion,"Schüler/innen","2",null,"","student",!1,!1,"student",!1,[]),this.studentPanel.selectCallback=t=>{e.main.networkManager.sendUpdates(()=>{let i={ws_userId:t.id,userId:this.main.user.id,language:1};ae("getWorkspaces",i,r=>{r.success==!0&&(e.main.workspacesOwnerId==e.main.user.id&&(e.ownWorkspaces=e.main.workspaceList.slice(),e.currentOwnWorkspace=e.main.currentWorkspace),e.main.restoreWorkspaces(r.workspaces),e.main.workspacesOwnerId=t.id,e.main.projectExplorer.setExplorerColor("rgba(255, 0, 0, 0.2"),e.main.projectExplorer.$homeAction.show(),nt.showHelper("homeButtonHelper",this.main),e.main.bottomDiv.showHomeworkTab(),e.main.bottomDiv.homeworkManager.attachToWorkspaces(e.main.workspaceList)),this.main.networkManager.updateFrequencyInSeconds=this.main.networkManager.teacherUpdateFrequencyInSeconds,this.main.networkManager.secondsTillNextUpdate=this.main.networkManager.teacherUpdateFrequencyInSeconds})})}}restoreOwnWorkspaces(){let e=this.main;e.getMonacoEditor().updateOptions({readOnly:!0}),e.workspaceList=this.ownWorkspaces,e.workspacesOwnerId=e.user.id,e.projectExplorer.setExplorerColor(null),e.projectExplorer.renderWorkspaces(e.workspaceList),e.currentWorkspace==null&&e.workspaceList.length>0&&(e.currentWorkspace=e.workspaceList[0]),this.currentOwnWorkspace!=null&&e.projectExplorer.setWorkspaceActive(this.currentOwnWorkspace),e.currentWorkspace=this.currentOwnWorkspace,this.studentPanel.select(null,!1)}initClassPanel(){let e=this;this.classPanel=new jt(this.main.projectExplorer.accordion,"Klassen","1",null,"","class",!1,!1,"class",!1,[]),this.classPanel.selectCallback=t=>{e.main.networkManager.sendUpdates(()=>{let i=t;i!=null&&this.renderStudents(i.students)})}}renderStudents(e){this.studentPanel.clear(),e.sort((t,i)=>t.vidis_akronym&&i.vidis_akronym?Ht(t)>Ht(i)?1:-1:t.familienname>i.familienname?1:i.familienname>t.familienname?-1:t.rufname>i.rufname?1:i.rufname>t.rufname?-1:0);for(let t of e){let i={name:Ht(t,!0),sortName:t.vidis_akronym?Ht(t):t.familienname+" "+t.rufname,externalElement:t,isFolder:!1,path:[]};this.studentPanel.addElement(i,!0)}}renderClasses(e){this.studentPanel.clear(),e.sort((t,i)=>t.name>i.name?1:i.name>t.name?-1:0);for(let t of e){let i={name:t.name,externalElement:t,isFolder:!1,path:[]};this.classPanel.addElement(i,!0)}}}class yo{constructor(){w(this,"themes",[]);this.initThemes()}switchTheme(e){for(let t of this.themes)if(t.name==e){this.internalSwitchTheme(t);break}}internalSwitchTheme(e){monaco.editor.setTheme(e.monacoTheme);let t=document.documentElement;for(const i of Object.keys(e.cssColors)){const r=e.cssColors[i];t.style.setProperty(i,r)}}initThemes(){this.themes.push({name:"dark",monacoTheme:"myCustomThemeDark",cssColors:{"--backgroundDark":"#1e1e1e","--backgroundLight":"#252526","--backgroundHeading":"#37373d","--backgroundSelected":"#2a2d2e","--fontColorNormal":"#c2cccc","--fontColorLight":"#e7e7e7","--slider":"#414141","--loginButtonBackgrond":"#59a15d","--loginButtonFontColor":"#000000","--loginMessageColor":"rgb(122, 48, 48)","--loginButtonHover":"#63a867","--loginButtonActive":"#94ffd1","--scrollbar":"#1e1e1e","--scrollbar-thumb":"#3e3e3e","--scrollbar-thumb-hover":"#5e5e5e","--scrollbar-thumb-active":"#7e7e7e","--submenu-hover":"#094771","--submenu-color":"#ffffff","--menuitemsdivider":"#616162","--file-hover":"hsla(0, 0%, 38%, 0.125)","--file-active":"#094771","--file-active-hover":"rgba(9, 71, 113, 0.827)","--file-errorcount":"red","--inplace-editor":"blue","--contextmenu-background":"#3c3c3c","--contextmenu-color":"rgb(212,212,212)","--contextmenu-hover-background":"#094771","--contextmenu-hover-color":"#ffffff","--error-filename":"#2a709e","--error-line-ative":"#094771","--error-line-hover":"rgba(96, 96, 96, 0.125)","--error-position":"#c0802d","--linecolumn":"#14c714","--reveal-error":"rgba(253, 101, 101, 0.745)","--reveal-method":"#2b2b7d2f","--reveal-errorline-background":"red","--reveal-error-whole-line":"rgba(255, 0, 0, 0.555)","--reveal-programpointer":"rgba(111, 214, 27, 0.337)","--reveal-syntaxelement":"rgb(85,85,85)","--margin-breakpoint":"rgba(255, 0, 0, 0.623)","--speedcontrol-bar":"#9d9d9d","--speedcontrol-grip":"#588555","--speedcontrol-grip-hover":"#89d185","--speedcontrol-display-background":"#383838","--speedcontrol-display-border":"#9d9d9d","--editorTooltip-background":"#252526","--editorTooltip-border":"#454545","--renameInput-color":"#ffffff","--bottomdiv-tabheading-hover":"white","--bottomdiv-tabheading-active":"rgb(97,97,255)","--noErrorMessage":"rgb(37, 211, 37)","--console-top-borderbottom":"#c4c4c4","--console-top-background":"#1e1e1e","--consoleEntry-withBorder":"#303030","--consoleEntryValue":"white","--consoleEntryIdentifier":"rgb(156, 156, 235)","--consoleEntryNoValue":"gray","--consoleEntryCaption":"white","--error-Caption":"rgb(166, 165, 176)","--console-error":"rgb(155, 51, 51)","--deIdentifier":"rgb(156, 156, 235)","--deValue":"white","--helper-background-color":"#383838","--helper-border-color":"#d4d4d4","--arrowBoxButtonOuter-background":"#59a15d","--arrowBoxButtonOuter-border":"#3d3d3d","--arrowBoxButtonOuter-color":"black","--arrowBoxButtonOuter-button-hover":"#63a867","--arrowBox-after":"rgba(136, 183, 213, 0)","--arrowBox-before":"rgba(194, 225, 245, 0)","--defaultOutputColor":"#ffffff","--runInputColor":"#ffffff","--runBackgroundColor":"rgba(255, 255, 255, 0.2)","--table-even":"#222","--table-heading":"#202060","--highlightStatementGreen-color":"#015a0165"}});let e="#8080ff";this.themes.push({name:"light",monacoTheme:"myCustomThemeLight",cssColors:{"--backgroundDark":"white","--backgroundLight":"#f3f3f3","--backgroundHeading":"#dcdcdc","--backgroundSelected":"#e8e8e8","--fontColorNormal":"#000","--fontColorLight":"#303030","--slider":"#b0b0b0","--loginButtonBackgrond":"#59a15d","--loginButtonFontColor":"#000000","--loginMessageColor":"rgb(122, 48, 48)","--loginButtonHover":"#63a867","--loginButtonActive":"#94ffd1","--scrollbar":"#e3e3e3","--scrollbar-thumb":"#bababa","--scrollbar-thumb-hover":"#8e8e8e","--scrollbar-thumb-active":"#616161","--submenu-hover":e,"--submenu-color":"#ffffff","--menuitemsdivider":"#cfcfcf","--file-hover":"#e8e8e8","--file-active":e,"--file-active-hover":"#a0a0ff","--file-errorcount":"red","--inplace-editor":"white","--contextmenu-background":"white","--contextmenu-color":"#756161","--contextmenu-hover-background":e,"--contextmenu-hover-color":"#a0a0ff","--error-filename":"#ff0000","--error-line-ative":"#ffa0a0","--error-line-hover":"#ffc0c0","--error-position":"#804040","--linecolumn":"#14c714","--reveal-error":"rgba(253, 101, 101, 0.745)","--reveal-method":"#babaec80","--reveal-errorline-background":"red","--reveal-error-whole-line":"rgba(255, 0, 0, 0.555)","--reveal-programpointer":"rgba(111, 214, 27, 0.337)","--reveal-syntaxelement":"#c0c0c0","--margin-breakpoint":"rgba(255, 0, 0, 0.623)","--speedcontrol-bar":"#9d9d9d","--speedcontrol-grip":"#588555","--speedcontrol-grip-hover":"#89d185","--speedcontrol-display-background":"#e0e0e0","--speedcontrol-display-border":"#9d9d9d","--editorTooltip-background":"#e0e0e0","--editorTooltip-border":"#9d9d9d","--renameInput-color":"#000000","--bottomdiv-tabheading-hover":"#424242","--bottomdiv-tabheading-active":"#424242","--noErrorMessage":"rgb(17, 180, 17)","--console-top-borderbottom":"#c4c4c4","--console-top-background":"white","--consoleEntry-withBorder":"#303030","--consoleEntryValue":"#0000a0","--consoleEntryIdentifier":"black","--consoleEntryNoValue":"gray","--consoleEntryCaption":"#756161","--error-Caption":"rgb(166, 165, 176)","--console-error":"rgb(155, 21, 21)","--deIdentifier":"black","--deValue":"#0000a0","--helper-background-color":"#f3f3f3","--helper-border-color":"#606060","--arrowBoxButtonOuter-background":"#59a15d","--arrowBoxButtonOuter-border":"#3d3d3d","--arrowBoxButtonOuter-color":"black","--arrowBoxButtonOuter-button-hover":"#63a867","--arrowBox-after":"rgba(136, 183, 213, 0)","--arrowBox-before":"rgba(194, 225, 245, 0)","--defaultOutputColor":"#303030","--runInputColor":"#000000","--runBackgroundColor":"rgba(0, 0, 0, 0.2)","--table-even":"#d1d2e4","--table-heading":"#c3f2b9","--highlightStatementGreen-color":"#015a0120"}})}}class wo{constructor(){w(this,"$dialog");w(this,"$dialogMain")}init(){this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery('<div style="flex: 1"></div><div class="dialog-main"></div><div style="flex: 4"></div>')),this.$dialogMain=this.$dialog.find(".dialog-main"),this.$dialog.css("visibility","visible")}heading(e){let t=jQuery('<div class="dialog-heading">'+e+"</div>");return this.$dialogMain.append(t),t}description(e,t){let i=t==null?"":`style="color: ${t}"`,r=jQuery(`<div class="dialog-description" ${i}>${e}</div>`);return this.$dialogMain.append(r),r}input(e,t){let i=jQuery(`<input class="dialog-input" type="${e}" placeholder="${t}"></input>`);return this.$dialogMain.append(i),i}buttons(e){let t=jQuery('<div class="dialog-buttonRow"></div>');this.$dialogMain.append(t);for(let i of e){let r=jQuery(`<button style="background-color: ${i.color};margin-left: 20px">${i.caption}</button>`);r.on("click",()=>{i.callback()}),t.append(r)}}waitMessage(e){let t=jQuery(`<div class="dialog-wait">${e}<img src="assets/graphics/ball-triangle.svg"></div>`);return this.$dialogMain.append(t),i=>{let r=i?"visible":"hidden";t.css("visibility",r)}}close(){this.$dialog.css("visibility","hidden"),this.$dialog.empty(),jQuery("#main").css("visibility","visible")}}class vo{constructor(e){this.main=e}init(){let e=jQuery("#buttonUserSettings"),t=this;e.on("click",i=>{Tt([{caption:"Passwort ändern...",callback:()=>{new ko(t.main).show()}}],e.offset().left,e.offset().top+e.height())})}}class ko{constructor(e){w(this,"dialog");this.main=e,this.dialog=new wo}show(){this.dialog.init(),this.dialog.heading("Passwort ändern"),this.dialog.description("Bitte geben Sie Ihr bisheriges Passwort und darunter zweimal Ihr neues Passwort ein. <br>Das Passwort muss mindestens 8 Zeichen lang sein und sowohl Buchstaben als auch Zahlen oder Sonderzeichen enthalten.");let e=this.dialog.input("password","Altes Passwort"),t=this.dialog.input("password","Neues Passwort"),i=this.dialog.input("password","Neues Passwort wiederholen"),r=this.dialog.description("","red"),o=this.dialog.waitMessage("Bitte warten...");this.dialog.buttons([{caption:"Abbrechen",color:"#a00000",callback:()=>{this.dialog.close()}},{caption:"OK",color:"green",callback:()=>{t.val()!=i.val()?r.text("Die zwei eingegebenen neuen Passwörter stimmen nicht überein."):(o(!0),ae("changePassword",{oldPassword:e.val(),newPassword:t.val()},()=>{o(!1),alert("Das Passwort wurde erfolgreich geändert."),this.dialog.close()},u=>{o(!1),r.text(u)}))}}])}}class xo{constructor(e){w(this,"logoutAfterMinutes",20);w(this,"counterInMinutes",this.logoutAfterMinutes);let t=this;setInterval(()=>{t.counterInMinutes--,t.counterInMinutes==0&&(e?e.logout():t.logout())},60*1e3),document.body.addEventListener("keydown",()=>{t.reset()}),document.body.addEventListener("mousedown",()=>{t.reset()})}reset(){this.counterInMinutes=this.logoutAfterMinutes}logout(){ae("logout",{currentWorkspaceId:null},()=>{window.location.href="index.html"})}}class Co{constructor(e){w(this,"loggedInWithVidis",!1);this.main=e,new xo(this)}loginWithVidis(e){this.loggedInWithVidis=!0,jQuery("#login").hide(),jQuery("#main").css("visibility","visible"),jQuery("#bitteWartenText").html("Bitte warten ..."),jQuery("#bitteWarten").css("display","flex"),this.sendLoginRequest(e)}initGUI(){let e=jQuery("#login-spinner>img");jQuery("#login-username").focus(),jQuery("#login-username").on("keydown",i=>{i.key=="Enter"&&jQuery("#login-password").focus()}),jQuery("#login-password").on("keydown",i=>{i.key=="Enter"&&jQuery("#login-button").trigger("click")}),jQuery("#login-password").on("keydown",i=>{i.key=="Tab"&&(i.preventDefault(),jQuery("#login-button").focus(),jQuery("#login-button").addClass("jo_active")),i.key=="Enter"&&jQuery("#login-button").trigger("click")}),jQuery("#login-button").on("keydown",i=>{i.key=="Tab"?(i.preventDefault(),jQuery("#login-username").focus(),jQuery("#login-button").removeClass("jo_active")):jQuery("#login-button").trigger("click")});let t=!1;jQuery("#login-button").on("click",()=>{e.show(),!t&&(t=!0,setTimeout(()=>{t=!1},1e3),this.sendLoginRequest())}),jQuery("#buttonLogout").on("click",()=>{this.logout()})}logout(){this.main.waitOverlay.show("Bitte warten, der letzte Bearbeitungsstand wird noch gespeichert ..."),this.main.workspacesOwnerId!=this.main.user.id&&this.main.projectExplorer.onHomeButtonClicked(),Ze.getInstance().close(),this.main.networkManager.sendUpdates(()=>{var t;this.main.notifier.connect(null);let e={currentWorkspaceId:(t=this.main.currentWorkspace)==null?void 0:t.id};this.main.networkManager.sendUpdateUserSettings(()=>{ae("logout",e,()=>{this.loggedInWithVidis?window.location.assign("https://aai-test.vidis.schule/auth/realms/vidis/protocol/openid-connect/logout?ID_TOKEN_HINT="+this.main.user.vidis_sub+"&post_logout_redirect_uri=https%3A%2F%2Fwww.sql-ide.de"):(jQuery("#login").show(),this.main.waitOverlay.hide(),jQuery("#login-message").empty(),this.main.getMonacoEditor().setModel(monaco.editor.createModel("","myJava")),this.main.projectExplorer.fileListPanel.clear(),this.main.projectExplorer.workspaceListPanel.clear(),this.main.databaseExplorer.clear(),this.main.resultsetPresenter.clear(),this.main.user.is_teacher&&(this.main.teacherExplorer.removePanels(),this.main.teacherExplorer=null),this.main.currentWorkspace=null,this.main.user=null)})})},!0)}sendLoginRequest(e){let t=this,i=jQuery("#login-spinner>img");i.show();let r={username:jQuery("#login-username").val(),password:jQuery("#login-password").val(),language:1};ae("login"+(e?"?singleUseToken="+e:""),r,o=>{if(!o.success)jQuery("#login-message").html("Fehler: Benutzername und/oder Passwort ist falsch.");else{Ze.getInstance().open(),jQuery("#login").hide(),this.main.waitOverlay.show("Bitte warten...");let u=o.user;(u.settings==null||u.settings.helperHistory==null)&&(u.settings={helperHistory:{},viewModes:null,classDiagram:null}),this.main.waitForGUICallback=()=>{let f=o.user;t.main.mainMenu.initGUI(f),t.main.waitOverlay.hide(),i.hide(),jQuery("#menupanel-username").html(Ht(f)),new vo(t.main).init(),f.is_teacher&&t.main.initTeacherExplorer(o.classdata),t.main.user=f,t.main.restoreWorkspaces(o.workspaces),t.main.workspacesOwnerId=f.id,t.main.networkManager.initializeTimer(),t.main.projectExplorer.fileListPanel.setFixed(!f.is_teacher),t.main.projectExplorer.workspaceListPanel.setFixed(!f.is_teacher),t.main.viewModeController.initViewMode(),t.main.bottomDiv.hideHomeworkTab(),t.main.networkManager.initializeSSE()},this.main.startupComplete==0&&(this.main.waitForGUICallback(),this.main.waitForGUICallback=null)}},o=>{jQuery("#login-message").html("Login gescheitert: "+o),jQuery("#login-spinner>img").hide()})}}class So{constructor(e,t){w(this,"$buttonEditorFullscreen");w(this,"$buttonPresentationMode");w(this,"$buttonMonitorMode");w(this,"$buttonMap",{});w(this,"highContrast",!1);w(this,"editorHasFullWidth",!1);this.$buttonsContainer=e,this.main=t,this.$buttonEditorFullscreen=jQuery('<div title="Editor in voller Breite" class="img_whole-window jo_button jo_active" style="padding: 1px; margin-right: 20px"></div>'),this.$buttonPresentationMode=jQuery('<div title="Präsentation (Beamer)" class="img_presentation-mode jo_button jo_active" syle="padding: 1px"></div>'),this.$buttonMonitorMode=jQuery('<div title="Monitor" class="img_monitor-mode jo_button jo_active" style="margin-left: 5px; padding: 1px"></div>'),e.append(this.$buttonEditorFullscreen,this.$buttonPresentationMode,this.$buttonMonitorMode),this.$buttonMap={presentation:this.$buttonPresentationMode,monitor:this.$buttonMonitorMode};let i=this.main.actionManager;i.registerAction("editor.fullwidth",[],()=>{this.toggleEditorFullwidth()},"Editor auf die volle Breite erweitern",this.$buttonEditorFullscreen),i.registerAction("viewmode.presentation",[],()=>{this.setMode("presentation")},"Präsentationsansicht",this.$buttonPresentationMode),i.registerAction("viewmode.monitor",[],()=>{this.setMode("monitor")},"Monitoransicht",this.$buttonMonitorMode)}toggleEditorFullwidth(){this.editorHasFullWidth?(this.$buttonEditorFullscreen.removeClass("img_whole-window-back"),this.$buttonEditorFullscreen.addClass("img_whole-window"),this.$buttonEditorFullscreen.attr("title","Editor in voller Breite"),jQuery("#rightdiv").show(600),jQuery("#leftpanel").show(600),jQuery("#controls").show()):(this.$buttonEditorFullscreen.removeClass("img_whole-window"),this.$buttonEditorFullscreen.addClass("img_whole-window-back"),this.$buttonEditorFullscreen.attr("title","Editor in normaler Breite"),jQuery("#rightdiv").hide(600),jQuery("#leftpanel").hide(600),jQuery("#controls").hide()),setTimeout(()=>{this.main.getMonacoEditor().layout()},800),this.editorHasFullWidth=!this.editorHasFullWidth}setMode(e,t=!0){let i=e=="presentation"?"monitor":"presentation";this.$buttonMap[e].addClass("jo_pressed"),this.$buttonMap[i].removeClass("jo_pressed");let o=this.main.user.settings.viewModes,u=o[e];o.viewModeChosen=e,this.main.themeManager.switchTheme(u.theme),this.main.editor.setFontSize(u.fontSize),this.highContrast!=u.highContrast&&(this.main.getMonacoEditor().getAction("editor.action.toggleHighContrast").run(),this.highContrast=!this.highContrast),t&&this.saveSettings()}saveFontSize(e){let t=this.getChosenViewMode();t.fontSize=e,this.saveSettings()}setTheme(e){let t=this.getChosenViewMode();t.theme=e,this.main.themeManager.switchTheme(t.theme),this.saveSettings()}toggleHighContrast(){let e=this.getChosenViewMode();e.highContrast=!e.highContrast,this.main.getMonacoEditor().getAction("editor.action.toggleHighContrast").run(),this.saveSettings()}getChosenViewMode(){let e=this.main.user.settings.viewModes;return e[e.viewModeChosen]}saveSettings(){this.main.userDataDirty=!0}initViewMode(){let e=this.main.user.settings;e.viewModes==null&&(e.viewModes={monitor:null,presentation:null,viewModeChosen:"monitor"}),e.viewModes.monitor==null&&(e.viewModes.monitor={fontSize:14,highContrast:!1,theme:"dark"},e.viewModes.presentation={fontSize:18,highContrast:!1,theme:"light"},this.saveSettings()),this.setMode(e.viewModes.viewModeChosen,!1)}}class Eo{constructor(e){w(this,"semicolonPositions",[]);w(this,"time");this.main=e}startRegistering(){this.semicolonPositions.forEach(e=>e.isThereAgain=!1),this.time=new Date().getTime()}register(e,t){let i=this.semicolonPositions.find(r=>r.position.line==e.line&&r.position.column==e.column);i?i.isThereAgain=!0:this.semicolonPositions.push({position:e,firstSeenMs:this.time,isThereAgain:!0,module:t})}healSemicolons(){let e=new Date().getTime();this.semicolonPositions=this.semicolonPositions.filter(r=>r.isThereAgain);let t=this.main.getCurrentlyEditedModule(),i=this.main.getMonacoEditor().getPosition().lineNumber;this.semicolonPositions.filter(r=>e-r.firstSeenMs>2e3).forEach(r=>{let o=r.module.file.id!=null&&r.module.file.id==t.file.id,u=[{range:new monaco.Range(r.position.line,r.position.column,r.position.line,r.position.column),text:";",forceMoveMarkers:!0}];if(o&&Math.abs(i-r.position.line)>1){let f=this.main.getMonacoEditor();const g=f.getSelection();f.executeEdits("Semicolon-Angel",u),f.setSelection(g),this.semicolonPositions.splice(this.semicolonPositions.indexOf(r),1)}})}}class To{constructor(e,t){w(this,"collapsedTables",new Map);this.main=e,this.$mainDiv=t}refresh(){this.main.getDatabaseTool().retrieveDatabaseStructure(t=>{this.refreshAfterRetrievingDBStructure()})}clear(){this.$mainDiv.empty()}refreshAfterRetrievingDBStructure(){let e=this.main.getDatabaseTool(),t=this.main.getCurrentWorkspace();if(t!=null)for(let r of t.moduleStore.getModules(!1))r.file.dirty=!0;let i=ct.fromTableStructureList(e.databaseStructure.tables);this.$mainDiv.empty();for(let r of i)if(r.identifier!="sqlite_sequence"){let o=this.renderTable(r);this.$mainDiv.append(o)}}renderTable(e){let t=this.collapsedTables.get(e.identifier)!=null,i=jQuery(`<div class="jo_table">
           <div class="jo_tableheader">
              <div class="${t?"img_tree-collapsed-dark":"img_tree-expanded-dark"} jo_treeswitch jo_button jo_active"></div>
              <div class="jo_tableheaderlink">
                <div class="${e.type=="table"?"img_table":"img_view"}"></div>
                <div>${e.identifier}</div></div><div class="jo_tablesize">(${e.type=="view"?"View, ":""}${e.size}&nbsp;Datensätze)</div>
              </div>
            </div>
        </div>`);const r=i.find(".jo_tableheader");r[0].addEventListener("contextmenu",g=>{g.preventDefault()}),r.on("pointerup",g=>{g.button==0&&this.main.getResultsetPresenter().showTable(e),g.button==2&&(Tt([{caption:"CSV-Export",callback:()=>{this.csvExport(e)}},{caption:"Abbrechen",callback:()=>{}}],g.pageX+2,g.pageY+2),g.stopPropagation())});let o=jQuery('<div class="jo_columnlist"></div>');for(let g of e.columns){let y=g.isPrimaryKey?"img_key":"img_column",C="";g.references!=null&&(C=`<div class="img_foreign_key" style="margin-left: 5px"></div><div class="jo_references">${g.references.table.identifier}.${g.references.identifier}</div>`);let T=g.type==null?"":g.type.toString(),D=g.notNull?'<div class="jo_dbnotnull">not null</div>':"",Q=g.defaultValue?`<div class="jo_dbdefault">default ${g.defaultValue}</div>`:"",N=g.isAutoIncrement?'<div class="jo_dbautoincrement">autoincrement</div>':"",M=jQuery(`
            <div class="jo_column">
                <div class="${y}"></div>
                <div>${g.identifier}</div>
                <div class="jo_dbtype">${T}</div>
                ${N}
                ${C}
                ${D}
                ${Q}
            </div>
            `);o.append(M)}i.append(o);let u=i.find(".jo_treeswitch"),f=this;return u.on("pointerup",g=>{g.stopPropagation();let y=u.parents(".jo_table").find(".jo_columnlist");u.hasClass("img_tree-collapsed-dark")?(u.removeClass("img_tree-collapsed-dark"),u.addClass("img_tree-expanded-dark"),y.slideDown(300),f.collapsedTables.delete(e.identifier)):(u.removeClass("img_tree-expanded-dark"),u.addClass("img_tree-collapsed-dark"),y.slideUp(300),f.collapsedTables.set(e.identifier,!0))}),i}csvExport(e){let t="select * from "+e.identifier+";";this.main.getDatabaseTool().executeQuery(t,i=>{let r="";const o=i.pop();o&&(r+=o.columns.map(u=>`"${u}"`).join(",")+`
`,r+=o.values.map(u=>u.map(f=>`"${f}"`).join(",")).join(`
`)),sn("\uFEFF"+r,e.identifier+".csv",!1)},i=>{})}}class jo{constructor(e,t){w(this,"$buttonStart");w(this,"$buttonRollback");this.main=e,this.$buttonsContainer=t,this.$buttonStart=jQuery('<div title="Start" class="img_start-dark jo_button"></div>'),this.$buttonRollback=jQuery('<div title="Rollback" class="img_undo jo_button"></div>');let i=this.main.getActionManager();i.registerAction("execute",["Strg + Enter"],()=>{i.isActive("execute")&&this.main.getResultsetPresenter().executeSelectedStatements()},"SQL-Statement ausführen",this.$buttonStart),i.setActive("execute",!1),i.registerAction("rollback",["Strg + LeftArrow"],()=>{i.isActive("rollback")&&this.main.getHistoryViewer().rollback()},"Letztes schreibendes SQL-Statement rückgängig machen",this.$buttonRollback),i.setActive("rollback",!1),t.append(this.$buttonStart,this.$buttonRollback)}}class lr{constructor(e,t){w(this,"$paginationDiv");w(this,"$infoDiv");w(this,"$arrowLeft");w(this,"$arrowRight");w(this,"paginationFrom");w(this,"paginationAll");w(this,"paginationSize",1e3);w(this,"result");w(this,"resultColumnTypes");w(this,"writeQueryListeners",[]);w(this,"oldErrorDecorations",[]);w(this,"showResultsBusy",!1);w(this,"showResultPending",!1);this.main=e,this.$bottomDiv=t,this.$paginationDiv=t.find(".jo_pagination");const i=jQuery('<div class="jo_button jo_active img_export-csv-dark"></div>');this.$arrowLeft=jQuery('<div class="jo_button img_arrow-left-dark jo_active"></div>'),this.$infoDiv=jQuery('<div class="jo_pagination_info"><span class="jo_pagination_fromto"></span>/<span class="jo_pagination_all"></span></div>'),this.$arrowRight=jQuery('<div class="jo_button img_arrow-right-dark jo_active"></div>'),this.$paginationDiv.empty(),this.$paginationDiv.append(i,this.$arrowLeft,this.$infoDiv,this.$arrowRight),this.$paginationDiv.hide();const r=t.find(".jo_resultTab");r.on("myshow",f=>{this.$paginationDiv.show()}),r.on("myhide",f=>{this.$paginationDiv.hide()});let o=(window.PointerEvent?"pointer":"mouse")+"up",u=this;this.$arrowLeft.on(o,f=>{u.paginationFrom>1&&(u.paginationFrom=Math.max(u.paginationFrom-u.paginationSize,1),u.paginationFrom%1e3!=1&&(u.paginationFrom=(Math.floor(u.paginationFrom/u.paginationSize)+1)*u.paginationSize+1),u.showResults(),u.activateButtons())}),this.$arrowRight.on(o,f=>{u.paginationFrom<this.paginationAll-u.paginationSize+1&&(u.paginationFrom=Math.min(u.paginationFrom+u.paginationSize,u.paginationAll-u.paginationSize+1),u.showResults(),u.activateButtons())}),i.on("click",()=>{this.exportCSV()})}addWriteQueryListener(e){this.writeQueryListeners.push(e)}activateButtons(){this.$arrowLeft.toggleClass("jo_active",this.paginationFrom>1),this.$arrowRight.toggleClass("jo_active",this.paginationFrom<this.paginationAll-this.paginationSize+1)}exportCSV(){let e="";this.result&&(e+=this.result.columns.map(t=>`"${t}"`).join(",")+`
`,e+=this.result.values.map(t=>t.map(i=>`"${i}"`).join(",")).join(`
`)),sn("\uFEFF"+e,"results.csv",!1)}executeSelectedStatements(){console.debug("Executing selected statements...");let e=this.fetchSelectedStatements().filter(u=>u.ast.type!=a.omittedeStatement);if(e.length==0)return;for(let u of e){let f=u.sql,g=[],y=/(\{[^}]+\})[^\[]/g,C;for(;(C=y.exec(f))!==null;)g.includes(C[1])||g.push(C[1]);for(y=/(\{[^}]+\}\[[^\]]+\])/g;(C=y.exec(f))!==null;)g.includes(C[1])||g.push(C[1]);for(let T of g){let D=null,Q=0;for(;D==null&&Q<2;)D=prompt("Gib einen Wert für '"+T+"' ein:"),Q++;if(D==null)return;f=f.replace(T,D)}u.sql=f}let t=e.some(u=>this.isDDLStatement(u)),i=e.some(u=>this.isWriteStatement(u)),r=this.main.getCurrentWorkspace(),o=r.database;if(t&&r.permissions<=1){alert("Der Benutzer hat keine Berechtigung zum Ändern der Tabellenstruktur.");return}if(i&&r.permissions==0){alert("Der Benutzer hat keine Berechtigung zum Einfügen/Löschen/Ändern von Datensätzen.");return}t||i?this.main.isEmbedded()?this.executeDDLWriteStatementsEmbedded(r,e,o):this.executeDDLWriteStatementsInOnlineIDE(r,e,o):this.executeStatements(e,0,[],()=>{})}executeDDLWriteStatementsEmbedded(e,t,i){let r=[];this.executeStatements(t,0,r,()=>{r.length!=0&&(this.main.getDatabaseExplorer().refresh(),this.writeQueryListeners.forEach(o=>o.notify(r)))})}executeDDLWriteStatementsInOnlineIDE(e,t,i){let r=this.main;r.networkManager.getNewStatements(e,(o,u)=>{r.notifier.executeNewStatements(o,u,()=>{},()=>{let f=[];this.executeStatements(t,0,f,()=>{if(f.length==0)return;let g=f.map(y=>y.sqlCleaned==null?y.sql:y.sqlCleaned);i.statements=i.statements.concat(g),this.main.getHistoryViewer().appendStatements(g),i.version+=g.length,r.networkManager.AddDatabaseStatements(e,f.map(y=>y.sqlCleaned==null?y.sql:y.sqlCleaned),(y,C)=>{y.length>0?(e.database.version=0,e.database.statements=[],r.networkManager.getNewStatements(e,()=>{this.resetDatabase(i)})):r.getDatabaseExplorer().refresh()})})},!1)})}resetDatabase(e){this.main.getDatabaseTool().initializeWorker(e.templateDump,e.statements,()=>{this.main.getDatabaseExplorer().refresh()})}executeStatementsString(e,t,i){if(e.length==0){i();return}t<e.length?this.main.getDatabaseTool().executeQuery(e[t],r=>{this.executeStatementsString(e,t+1,i)},r=>{console.log("Error when executing statement "+e[t]+`
Error : `+r),this.executeStatementsString(e,t+1,i)}):i()}executeStatements(e,t,i,r,o=[]){if(console.debug("Executing statement "+(t+1)+" of "+e.length),t>=e.length){this.showErrors(o),r();return}let u=e[t],f=()=>{this.executeStatements(e,t+1,i,r,o)};if(u.ast==null){f();return}if(u.ast.type==a.keywordSelect){let g=!1;for(let y=t+1;y<e.length;y++)g=g||this.isSelectStatement(e[y]);if(g)f();else{if(u.ast.limitNode==null){for(u.sql.trimRight();u.sql.endsWith(";")||u.sql.endsWith(`
`)||u.sql.endsWith("\r");)u.sql=u.sql.substring(0,u.sql.length-1),u.sql.trimRight();u.sql+=" limit 100000"}this.main.getDatabaseTool().executeQuery(u.sql,y=>{this.presentResultsIntern(u.sql,y,u.resultTypes),f()},y=>{o.push({statement:u,message:y}),f()})}}else{let g=new or().clean(u);this.main.getDatabaseTool().executeQuery(g,y=>{i.push(u),f()},y=>{o.push({statement:u,message:y}),f()})}}showErrorDecorations(e){let t={error:"#bc1616",warning:"#cca700",info:"#75beff"};this.main.getMonacoEditor();let i=[],r=[];for(let u of e){let f="error",g,y=t[f];switch(f){case"error":g="jo_revealErrorLine";break;case"warning":g="jo_revealWarningLine";break;case"info":g="jo_revealInfoLine";break}let C;switch(f){case"error":C=monaco.MarkerSeverity.Error;break;case"warning":C=monaco.MarkerSeverity.Warning;break;case"info":C=monaco.MarkerSeverity.Info;break}i.push({startLineNumber:u.statement.from.line,startColumn:u.statement.from.column,endLineNumber:u.statement.to.line,endColumn:u.statement.to.column,message:u.message,severity:C}),r.push({range:{startLineNumber:u.statement.from.line,startColumn:u.statement.from.column,endLineNumber:u.statement.to.line,endColumn:u.statement.to.column},options:{linesDecorationsClassName:g,minimap:{position:monaco.editor.MinimapPosition.Inline,color:y}}})}let o=this.main.getCurrentlyEditedModule().model;monaco.editor.setModelMarkers(o,"test",i),this.oldErrorDecorations=o.deltaDecorations(this.oldErrorDecorations,r)}showTable(e){let t="select * from "+e.identifier+";";this.main.getDatabaseTool().executeQuery(t,i=>{this.presentResultsIntern(t,i,e.columns.map(r=>r.type))},i=>{})}showErrors(e){let t=this.$bottomDiv.find(".jo_errorsTab"),i=this.$bottomDiv.find(".jo_errorsTabheading");if(t.empty(),this.showErrorDecorations(e),e.length==0)return;let r=window.PointerEvent?"pointer":"mouse";i.trigger(r+"down");let o=jQuery('<div class="jo_errorlist"></div>');t.append(o);for(let u of e){let f=u.statement.sql;f=f.replace(/\n/g," "),f=f.replace(/\s\s+/g," ");let g=jQuery('<div class="jo_error-line" style="flex-direction:column; width: fit-content"></div>');o.append(g),g.on(r+"down",()=>{let T={startColumn:u.statement.from.column,startLineNumber:u.statement.from.line,endColumn:u.statement.to.column,endLineNumber:u.statement.to.line};this.main.getMonacoEditor().revealRangeInCenter(T),o.find(".jo_error-line").removeClass("jo_active"),g.addClass("jo_active")});let y=jQuery('<div class="jo_sqlErrorStatement"></div>');g.append(y),monaco.editor.colorize(f,"vscSQL",{}).then(T=>{y.html(T)});let C=jQuery('<div class="jo_sqlErrorMessage">'+u.message+"</div>");g.append(C)}this.$bottomDiv.find(".jo_tabheading").removeClass("jo_active"),i.addClass("jo_active"),t.addClass("jo_active")}isSelectStatement(e){return e.ast!=null&&e.ast.type==a.keywordSelect}isDDLStatement(e){return e.ast!=null&&[a.keywordCreate,a.keywordDrop,a.keywordAlter,a.keywordView].indexOf(e.ast.type)>=0}isWriteStatement(e){return e.ast!=null&&[a.keywordInsert,a.keywordDelete,a.keywordUpdate].indexOf(e.ast.type)>=0}presentResultsIntern(e,t,i){let r=this.$bottomDiv.find(".jo_resultTabheading"),o=this.$bottomDiv.find(".jo_result-header"),u=window.PointerEvent?"pointer":"mouse";r.trigger(u+"down"),this.result=t.pop(),this.resultColumnTypes=i;let f=o;e=e.replace(/\n/g," "),e=e.replace(/\s\s+/g," "),e=e.replace(/limit 100000/g,""),monaco.editor.colorize(e,"vscSQL",{}).then(g=>{f.html(g)}),this.paginationAll=this.result?this.result.values.length:0,this.$infoDiv.find(".jo_pagination_all").html(`${this.paginationAll}`),this.paginationFrom=1,this.$paginationDiv.show(),this.activateButtons(),this.showResults()}clear(){this.$bottomDiv.find(".jo_result-body").empty(),this.$paginationDiv.hide()}showResults(){let e=this.$bottomDiv.find(".jo_result-body");if(this.result==null){this.$infoDiv.find(".jo_pagination_fromto").html("---"),e.html("Die Datenbank lieferte eine leere Ergebnistabelle.");return}let t=this,i=this.paginationAll==0?0:this.paginationFrom,r=this.paginationAll==0?0:Math.min(this.paginationFrom+this.paginationSize-1,this.paginationAll);if(this.$infoDiv.find(".jo_pagination_fromto").html(`${i}-${r}`),this.showResultsBusy){if(this.showResultPending)return;this.showResultPending=!0;let T=()=>{t.showResultsBusy?setTimeout(()=>{T()},200):(t.showResultPending=!1,t.showResults())};setTimeout(T,200);return}this.showResultsBusy=!0;let o=jQuery("<table></table>"),u=jQuery("<tr></tr>");o.append(u),this.result.columns.forEach(T=>{u.append(jQuery(`<th><div>${T}</div></th>`))});let f=this.result.values.slice(this.paginationFrom-1,this.paginationFrom+this.paginationSize-1),g=0,y=this.resultColumnTypes.map(T=>["boolean","tinyint(1)"].indexOf(T.toString())>=0),C=()=>{if(g<f.length){for(let T=g;T<Math.min(g+200,f.length);T++){let D=f[T],Q=jQuery("<tr></tr>");o.append(Q),D.forEach((N,M)=>{let H=N;y[M]&&(H=N==1?"true":"false"),Q.append(jQuery(`<td>${H}</td>`))})}g=Math.min(g+200,f.length),g<f.length?setTimeout(C,30):(e.empty().append(o),this.showResultsBusy=!1)}};C()}fetchSelectedStatements(){let e=this.main.getCurrentlyEditedModule();if(e==null)return null;let t=this.main.getMonacoEditor(),i=e.getSQLSTatementsAtSelection(t.getSelection());for(let r of i){if(t.getModel().getValueInRange({startColumn:r.from.column,startLineNumber:r.from.line,endColumn:r.to.column,endLineNumber:r.to.line}).includes("{")){const u=t.getModel(),f=u.getOffsetAt({lineNumber:r.from.line,column:r.from.column}),g=u.getValue(),y=f;let C=g.indexOf(";",y);if(C==-1&&(console.log("no semicolon found"),C=g.length),C!==-1){const T=u.getPositionAt(C+1);r.to.line=T.lineNumber,r.to.column=T.column}}r.sql=t.getModel().getValueInRange({startColumn:r.from.column,startLineNumber:r.from.line,endColumn:r.to.column,endLineNumber:r.to.line})}return i}}w(lr,"StatementDelimiter",`;

`);class Do{constructor(e){w(this,"visible",!1);w(this,"fadeOutPending",!1);w(this,"$bitteWartenText");w(this,"$bitteWartenProgress");this.$waitDiv=e,e.css("display","none"),this.$bitteWartenText=e.find(".bitteWartenText"),this.$bitteWartenProgress=e.find(".bitteWartenProgress")}show(e){this.fadeOutPending=!1,this.$bitteWartenText.html(e),this.$bitteWartenProgress.html(""),this.visible||(this.visible=!0,this.$waitDiv.css("display","flex"),this.$waitDiv.hide(),this.$waitDiv.fadeIn(400))}setProgress(e){this.$bitteWartenProgress.html(e)}hide(){this.visible&&(this.fadeOutPending=!0,setTimeout(()=>{this.fadeOutPending&&(this.fadeOutPending=!1,this.$waitDiv.fadeOut(200,()=>{this.$waitDiv.css("display","none")}),this.visible=!1)},50))}}class Lo{constructor(e,t){w(this,"panelEntries",[]);this.main=e,this.$historyPanel=t}clear(){this.$historyPanel.empty(),this.main.getActionManager().setActive("rollback",!1),this.panelEntries=[]}clearAndShowStatements(e){this.clear(),this.appendStatements(e),this.main.getActionManager().setActive("rollback",e.length>0)}appendStatements(e){e.forEach(t=>{let i=this.makePanelEntry(t,this.panelEntries.length+1);this.$historyPanel.prepend(i.$div),this.panelEntries.unshift(i)}),e.length>0&&this.main.getActionManager().setActive("rollback",!0),this.makeLastButtonActive()}makeLastButtonActive(){this.panelEntries.forEach(e=>e.$rollbackButton.removeClass("jo_active")),this.panelEntries.length>0&&this.panelEntries[0].$rollbackButton.addClass("jo_active")}makePanelEntry(e,t){let i=jQuery('<div class="jo_panelEntry"></div>'),r=jQuery(`<div class="jo_panelEntryIndex">${t}.</div>`),o=jQuery('<div class="jo_panelEntryText"></div>'),u=e.substring(0,Math.min(400,e.length));e.length>400&&(u+="..."),o.text(u);let f=jQuery('<div class="img_copy jo_panelEntryCopyButton jo_active jo_button" title="In die Zwischenablage kopieren"></div>'),g=jQuery('<div class="img_undo jo_panelEntryRollbackButton jo_button" title="Rollback"></div>');f.on("click",()=>{rr(e)});let y=window.PointerEvent?"pointer":"mouse";return g.on(y+"up",C=>{C.preventDefault(),Tt([{caption:"Abbrechen",callback:()=>{}},{caption:"Ich bin mir sicher: rollback!",color:"#ff6060",callback:()=>{this.rollback()}}],C.pageX+2,C.pageY+2),C.stopPropagation()}),i.append(r,o,f,g),{$div:i,statement:e,$rollbackButton:g}}rollback(){this.panelEntries.length!=0&&(this.main.isEmbedded()?(this.rollbackEmbedded(),this.main.getActionManager().setActive("rollback",this.panelEntries.length>0)):this.main.networkManager.rollback((t,i)=>{t==null&&i&&this.rollbackLocal()}))}rollbackLocal(e){let t=this.main.getCurrentWorkspace().database;for(e==null&&(e=t.version-1);t.version>e;)t.statements.pop(),t.version--;this.main.getDatabaseTool().initializeWorker(t.templateDump,t.statements,()=>{},()=>{this.main.getDatabaseExplorer().refreshAfterRetrievingDBStructure(),this.panelEntries.shift().$div.remove(),this.makeLastButtonActive(),this.main.getActionManager().setActive("rollback",this.panelEntries.length>0)})}rollbackEmbedded(){let e=this.main;e.writeQueryManager.rollback(),this.main.getDatabaseTool().initializeWorker(e.initialTemplateDump,e.initialStatements.concat(e.writeQueryManager.writtenStatements),()=>{},()=>{this.main.getDatabaseExplorer().refreshAfterRetrievingDBStructure(),this.panelEntries.shift().$div.remove(),this.makeLastButtonActive()})}}class _o{constructor(e){w(this,"workspace");w(this,"database");this.main=e}async connect(e){if(this.workspace!=null){let i={workspaceId:this.workspace.id,registerOrUnregister:"unregister"};await ui("servlet/registerPushClientForDatabase",i)}if(this.workspace=e,e==null){Ze.unsubscribe("onOpen");return}this.database=e.database;let t={workspaceId:e.id,registerOrUnregister:"register"};ui("servlet/registerPushClientForDatabase",t),Ze.subscribe("broadcastDatabaseChange",i=>{i.databaseId==this.workspace.databaseId?i.rollbackToVersion!=null?this.main.getHistoryViewer().rollbackLocal(i.rollbackToVersion):this.executeNewStatements(i.newStatements,i.firstNewStatementIndex,()=>{this.getNewStatementsHttp()}):(t.registerOrUnregister="unregister",ui("servlet/registerPushClientForDatabase",t),Ze.unsubscribe("onOpen"))}),Ze.subscribe("onOpen",()=>{t.registerOrUnregister="register",ui("servlet/registerPushClientForDatabase",t)})}executeNewStatements(e,t,i,r=()=>{},o=!0){if(this.database==null)return;let u=this,f=t-(this.database.version+1);if(f>0){i(),r();return}else{f<0&&(e.splice(0,-f),t-=f);let g=e;g.length>0?this.main.resultsetPresenter.executeStatementsString(g,0,()=>{u.main.getHistoryViewer().appendStatements(g),u.database.statements=u.database.statements.concat(g),u.database.version=t+e.length-1,o&&u.main.databaseExplorer.refresh(),r()}):r()}}getNewStatementsHttp(){let e=this;if(this.workspace==null||this.database==null)return;let t={workspaceId:this.workspace.id,version_before:this.workspace.database.version};ae("getNewStatements",t,i=>{i.rollbackToVersion!=null?e.main.getHistoryViewer().rollbackLocal(i.rollbackToVersion):e.executeNewStatements(i.newStatements,i.firstNewStatementIndex,()=>{e.getNewStatementsHttp()})})}}function Gn(c,e,t){var i="";if(t){var r=new Date;r.setTime(r.getTime()+t*1e3),i="; expires="+r.toUTCString()}document.cookie=c+"="+(e||"")+i+"; path=/"}class Zt{constructor(){w(this,"workspaceList",[]);w(this,"workspacesOwnerId");w(this,"editor");w(this,"currentWorkspace");w(this,"projectExplorer");w(this,"teacherExplorer");w(this,"networkManager");w(this,"actionManager");w(this,"mainMenu");w(this,"login");w(this,"compiler");w(this,"semicolonAngel");w(this,"bottomDiv");w(this,"startupComplete",2);w(this,"waitForGUICallback");w(this,"version",0);w(this,"timerHandle");w(this,"user");w(this,"userDataDirty",!1);w(this,"themeManager");w(this,"rightDiv");w(this,"viewModeController");w(this,"databaseTool");w(this,"databaseExplorer");w(this,"resultsetPresenter");w(this,"notifier");w(this,"waitOverlay",new Do(jQuery(".bitteWarten")));w(this,"historyViewer",new Lo(this,jQuery(".jo_historyTab")))}isEmbedded(){return!1}getCurrentWorkspace(){return this.currentWorkspace}getMonacoEditor(){return this.editor.editor}getRightDiv(){return this.rightDiv}getBottomDiv(){return this.bottomDiv}getCurrentlyEditedModule(){return this.projectExplorer.getCurrentlyEditedModule()}getActionManager(){return this.actionManager}getCompiler(){return this.compiler}setModuleActive(e){this.projectExplorer.setModuleActive(e)}getSemicolonAngel(){return this.semicolonAngel}getDatabaseTool(){return this.databaseTool}getDatabaseExplorer(){return this.databaseExplorer}getResultsetPresenter(){return this.resultsetPresenter}getWaitOverlay(){return this.waitOverlay}getHistoryViewer(){return this.historyViewer}initGUI(){Ks(),this.login=new Co(this);let e=location.search.split("singleUseToken=")[1];e&&Gn("singleUseToken",e,3);let t=Xs("singleUseToken");t?(Gn("singleUseToken","",0),this.login.initGUI(),this.login.loginWithVidis(t)):this.login.initGUI(),this.databaseTool=new Et(this),this.databaseExplorer=new To(this,jQuery(".jo_db_tree")),this.actionManager=new Zs(null,this),this.actionManager.init(),this.networkManager=new xs(this,jQuery("#bottomdiv-outer .jo_updateTimerDiv")),new go(this).initSliders(),this.mainMenu=new co(this),this.projectExplorer=new po(this,jQuery("#leftpanel>.jo_projectexplorer")),this.projectExplorer.initGUI(),this.bottomDiv=new eo(this,jQuery("#bottomdiv-outer>.jo_bottomdiv-inner"),jQuery("body")),this.rightDiv=new mo(this,jQuery("#rightdiv-inner")),this.rightDiv.initGUI(),this.checkStartupComplete(),this.themeManager=new yo,this.viewModeController=new So(jQuery("#view-mode"),this),this.semicolonAngel=new Eo(this),new jo(this,jQuery("#controls")),this.resultsetPresenter=new lr(this,jQuery(".jo_bottomdiv-inner")),this.notifier=new _o(this)}initEditor(){this.editor=new oo(this,!0,!1),new ao().init(),this.editor.initGUI(jQuery("#editor"));let e=this;jQuery(window).on("resize",t=>{jQuery("#bottomdiv-outer").css("height","450px"),jQuery("#editor").css("height",window.innerHeight-450-30-2+"px"),e.editor.editor.layout(),jQuery("#editor").css("height","")}),jQuery(window).trigger("resize"),this.checkStartupComplete()}initTeacherExplorer(e){this.teacherExplorer=new bo(this,e),this.teacherExplorer.initGUI()}checkStartupComplete(){this.startupComplete--,this.startupComplete==0&&this.start()}start(){this.waitForGUICallback!=null&&this.waitForGUICallback();let e=this;setTimeout(()=>{e.getMonacoEditor().layout()},200),this.compiler=new Us(this),this.startTimer(),$(window).on("unload",function(){navigator.sendBeacon&&e.user!=null&&(e.networkManager.sendUpdates(null,!1),e.networkManager.sendUpdateUserSettings(()=>{}))})}startTimer(){this.timerHandle!=null&&clearInterval(this.timerHandle);let e=this;this.timerHandle=setInterval(()=>{e.compileIfDirty()},500)}compileIfDirty(){var e,t;if(this.currentWorkspace!=null&&this.currentWorkspace.moduleStore.isDirty()&&this.compiler.compilerStatus!=Zi.compiling)try{this.compiler.compile(this.currentWorkspace.moduleStore);let i=(t=(e=this.bottomDiv)==null?void 0:e.errorManager)==null?void 0:t.showErrors(this.currentWorkspace);this.projectExplorer.renderErrorCount(this.currentWorkspace,i),this.editor.onDidChangeCursorPosition(null),this.projectExplorer&&this.version++}catch(i){console.error(i),this.compiler.compilerStatus=Zi.error}}removeWorkspace(e){this.workspaceList.splice(this.workspaceList.indexOf(e),1)}restoreWorkspaces(e){this.workspaceList=[],this.currentWorkspace=null,this.getMonacoEditor().updateOptions({readOnly:!0});let t=null;for(let i of e.workspaces){let r=Xt.restoreFromData(i,this);this.workspaceList.push(r),i.id==this.user.currentWorkspace_id&&!i.isFolder&&(t=r)}if(this.projectExplorer.renderWorkspaces(this.workspaceList),t==null&&this.workspaceList.length>0){for(let i of this.workspaceList)if(!i.isFolder){t=this.workspaceList[0];break}}t!=null&&this.projectExplorer.setWorkspaceActive(t,null,!0),this.workspaceList.length==0&&nt.showHelper("newDatabaseHelper",this,this.projectExplorer.workspaceListPanel.$captionElement)}createNewWorkspace(e,t){return new Xt(e,this,t)}}var Po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mo(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var ur={exports:{}};/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */(function(c){(function(e,t){c.exports=e.document?t(e,!0):function(i){if(!i.document)throw new Error("jQuery requires a window with a document");return t(i)}})(typeof window<"u"?window:Po,function(e,t){var i=[],r=Object.getPrototypeOf,o=i.slice,u=i.flat?function(n){return i.flat.call(n)}:function(n){return i.concat.apply([],n)},f=i.push,g=i.indexOf,y={},C=y.toString,T=y.hasOwnProperty,D=T.toString,Q=D.call(Object),N={},M=function(s){return typeof s=="function"&&typeof s.nodeType!="number"&&typeof s.item!="function"},H=function(s){return s!=null&&s===s.window},F=e.document,Ye={type:!0,src:!0,nonce:!0,noModule:!0};function ye(n,s,l){l=l||F;var d,p,m=l.createElement("script");if(m.text=n,s)for(d in Ye)p=s[d]||s.getAttribute&&s.getAttribute(d),p&&m.setAttribute(d,p);l.head.appendChild(m).parentNode.removeChild(m)}function de(n){return n==null?n+"":typeof n=="object"||typeof n=="function"?y[C.call(n)]||"object":typeof n}var Ae="3.7.1",_e=/HTML$/i,h=function(n,s){return new h.fn.init(n,s)};h.fn=h.prototype={jquery:Ae,constructor:h,length:0,toArray:function(){return o.call(this)},get:function(n){return n==null?o.call(this):n<0?this[n+this.length]:this[n]},pushStack:function(n){var s=h.merge(this.constructor(),n);return s.prevObject=this,s},each:function(n){return h.each(this,n)},map:function(n){return this.pushStack(h.map(this,function(s,l){return n.call(s,l,s)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(h.grep(this,function(n,s){return(s+1)%2}))},odd:function(){return this.pushStack(h.grep(this,function(n,s){return s%2}))},eq:function(n){var s=this.length,l=+n+(n<0?s:0);return this.pushStack(l>=0&&l<s?[this[l]]:[])},end:function(){return this.prevObject||this.constructor()},push:f,sort:i.sort,splice:i.splice},h.extend=h.fn.extend=function(){var n,s,l,d,p,m,b=arguments[0]||{},x=1,k=arguments.length,E=!1;for(typeof b=="boolean"&&(E=b,b=arguments[x]||{},x++),typeof b!="object"&&!M(b)&&(b={}),x===k&&(b=this,x--);x<k;x++)if((n=arguments[x])!=null)for(s in n)d=n[s],!(s==="__proto__"||b===d)&&(E&&d&&(h.isPlainObject(d)||(p=Array.isArray(d)))?(l=b[s],p&&!Array.isArray(l)?m=[]:!p&&!h.isPlainObject(l)?m={}:m=l,p=!1,b[s]=h.extend(E,m,d)):d!==void 0&&(b[s]=d));return b},h.extend({expando:"jQuery"+(Ae+Math.random()).replace(/\D/g,""),isReady:!0,error:function(n){throw new Error(n)},noop:function(){},isPlainObject:function(n){var s,l;return!n||C.call(n)!=="[object Object]"?!1:(s=r(n),s?(l=T.call(s,"constructor")&&s.constructor,typeof l=="function"&&D.call(l)===Q):!0)},isEmptyObject:function(n){var s;for(s in n)return!1;return!0},globalEval:function(n,s,l){ye(n,{nonce:s&&s.nonce},l)},each:function(n,s){var l,d=0;if(ht(n))for(l=n.length;d<l&&s.call(n[d],d,n[d])!==!1;d++);else for(d in n)if(s.call(n[d],d,n[d])===!1)break;return n},text:function(n){var s,l="",d=0,p=n.nodeType;if(!p)for(;s=n[d++];)l+=h.text(s);return p===1||p===11?n.textContent:p===9?n.documentElement.textContent:p===3||p===4?n.nodeValue:l},makeArray:function(n,s){var l=s||[];return n!=null&&(ht(Object(n))?h.merge(l,typeof n=="string"?[n]:n):f.call(l,n)),l},inArray:function(n,s,l){return s==null?-1:g.call(s,n,l)},isXMLDoc:function(n){var s=n&&n.namespaceURI,l=n&&(n.ownerDocument||n).documentElement;return!_e.test(s||l&&l.nodeName||"HTML")},merge:function(n,s){for(var l=+s.length,d=0,p=n.length;d<l;d++)n[p++]=s[d];return n.length=p,n},grep:function(n,s,l){for(var d,p=[],m=0,b=n.length,x=!l;m<b;m++)d=!s(n[m],m),d!==x&&p.push(n[m]);return p},map:function(n,s,l){var d,p,m=0,b=[];if(ht(n))for(d=n.length;m<d;m++)p=s(n[m],m,l),p!=null&&b.push(p);else for(m in n)p=s(n[m],m,l),p!=null&&b.push(p);return u(b)},guid:1,support:N}),typeof Symbol=="function"&&(h.fn[Symbol.iterator]=i[Symbol.iterator]),h.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(n,s){y["[object "+s+"]"]=s.toLowerCase()});function ht(n){var s=!!n&&"length"in n&&n.length,l=de(n);return M(n)||H(n)?!1:l==="array"||s===0||typeof s=="number"&&s>0&&s-1 in n}function oe(n,s){return n.nodeName&&n.nodeName.toLowerCase()===s.toLowerCase()}var dr=i.pop,cr=i.sort,hr=i.splice,re="[\\x20\\t\\r\\n\\f]",Pt=new RegExp("^"+re+"+|((?:^|[^\\\\])(?:\\\\.)*)"+re+"+$","g");h.contains=function(n,s){var l=s&&s.parentNode;return n===l||!!(l&&l.nodeType===1&&(n.contains?n.contains(l):n.compareDocumentPosition&&n.compareDocumentPosition(l)&16))};var fr=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function pr(n,s){return s?n==="\0"?"�":n.slice(0,-1)+"\\"+n.charCodeAt(n.length-1).toString(16)+" ":"\\"+n}h.escapeSelector=function(n){return(n+"").replace(fr,pr)};var He=F,vi=f;(function(){var n,s,l,d,p,m=vi,b,x,k,E,P,A=h.expando,L=0,O=0,G=si(),te=si(),Z=si(),pe=si(),ce=function(v,S){return v===S&&(p=!0),0},Ne="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Be="(?:\\\\[\\da-fA-F]{1,6}"+re+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",ee="\\["+re+"*("+Be+")(?:"+re+"*([*^$|!~]?=)"+re+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Be+"))|)"+re+"*\\]",at=":("+Be+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+ee+")*)|.*)\\)|)",ie=new RegExp(re+"+","g"),le=new RegExp("^"+re+"*,"+re+"*"),Rt=new RegExp("^"+re+"*([>+~]|"+re+")"+re+"*"),Ni=new RegExp(re+"|>"),Fe=new RegExp(at),qt=new RegExp("^"+Be+"$"),Re={ID:new RegExp("^#("+Be+")"),CLASS:new RegExp("^\\.("+Be+")"),TAG:new RegExp("^("+Be+"|[*])"),ATTR:new RegExp("^"+ee),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+re+"*(even|odd|(([+-]|)(\\d*)n|)"+re+"*(?:([+-]|)"+re+"*(\\d+)|))"+re+"*\\)|)","i"),bool:new RegExp("^(?:"+Ne+")$","i"),needsContext:new RegExp("^"+re+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+re+"*((?:-\\d)?\\d*)"+re+"*\\)|)(?=[^-]|$)","i")},Je=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,je=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Bi=/[+~]/,Ve=new RegExp("\\\\[\\da-fA-F]{1,6}"+re+"?|\\\\([^\\r\\n\\f])","g"),Ke=function(v,S){var j="0x"+v.slice(1)-65536;return S||(j<0?String.fromCharCode(j+65536):String.fromCharCode(j>>10|55296,j&1023|56320))},us=function(){tt()},ds=ai(function(v){return v.disabled===!0&&oe(v,"fieldset")},{dir:"parentNode",next:"legend"});function cs(){try{return b.activeElement}catch{}}try{m.apply(i=o.call(He.childNodes),He.childNodes),i[He.childNodes.length].nodeType}catch{m={apply:function(S,j){vi.apply(S,o.call(j))},call:function(S){vi.apply(S,o.call(arguments,1))}}}function ne(v,S,j,_){var I,B,R,W,q,Y,V,X=S&&S.ownerDocument,J=S?S.nodeType:9;if(j=j||[],typeof v!="string"||!v||J!==1&&J!==9&&J!==11)return j;if(!_&&(tt(S),S=S||b,k)){if(J!==11&&(q=je.exec(v)))if(I=q[1]){if(J===9)if(R=S.getElementById(I)){if(R.id===I)return m.call(j,R),j}else return j;else if(X&&(R=X.getElementById(I))&&ne.contains(S,R)&&R.id===I)return m.call(j,R),j}else{if(q[2])return m.apply(j,S.getElementsByTagName(v)),j;if((I=q[3])&&S.getElementsByClassName)return m.apply(j,S.getElementsByClassName(I)),j}if(!pe[v+" "]&&(!E||!E.test(v))){if(V=v,X=S,J===1&&(Ni.test(v)||Rt.test(v))){for(X=Bi.test(v)&&Fi(S.parentNode)||S,(X!=S||!N.scope)&&((W=S.getAttribute("id"))?W=h.escapeSelector(W):S.setAttribute("id",W=A)),Y=Qt(v),B=Y.length;B--;)Y[B]=(W?"#"+W:":scope")+" "+oi(Y[B]);V=Y.join(",")}try{return m.apply(j,X.querySelectorAll(V)),j}catch{pe(v,!0)}finally{W===A&&S.removeAttribute("id")}}}return zn(v.replace(Pt,"$1"),S,j,_)}function si(){var v=[];function S(j,_){return v.push(j+" ")>s.cacheLength&&delete S[v.shift()],S[j+" "]=_}return S}function Me(v){return v[A]=!0,v}function kt(v){var S=b.createElement("fieldset");try{return!!v(S)}catch{return!1}finally{S.parentNode&&S.parentNode.removeChild(S),S=null}}function hs(v){return function(S){return oe(S,"input")&&S.type===v}}function fs(v){return function(S){return(oe(S,"input")||oe(S,"button"))&&S.type===v}}function Wn(v){return function(S){return"form"in S?S.parentNode&&S.disabled===!1?"label"in S?"label"in S.parentNode?S.parentNode.disabled===v:S.disabled===v:S.isDisabled===v||S.isDisabled!==!v&&ds(S)===v:S.disabled===v:"label"in S?S.disabled===v:!1}}function lt(v){return Me(function(S){return S=+S,Me(function(j,_){for(var I,B=v([],j.length,S),R=B.length;R--;)j[I=B[R]]&&(j[I]=!(_[I]=j[I]))})})}function Fi(v){return v&&typeof v.getElementsByTagName<"u"&&v}function tt(v){var S,j=v?v.ownerDocument||v:He;return j==b||j.nodeType!==9||!j.documentElement||(b=j,x=b.documentElement,k=!h.isXMLDoc(b),P=x.matches||x.webkitMatchesSelector||x.msMatchesSelector,x.msMatchesSelector&&He!=b&&(S=b.defaultView)&&S.top!==S&&S.addEventListener("unload",us),N.getById=kt(function(_){return x.appendChild(_).id=h.expando,!b.getElementsByName||!b.getElementsByName(h.expando).length}),N.disconnectedMatch=kt(function(_){return P.call(_,"*")}),N.scope=kt(function(){return b.querySelectorAll(":scope")}),N.cssHas=kt(function(){try{return b.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),N.getById?(s.filter.ID=function(_){var I=_.replace(Ve,Ke);return function(B){return B.getAttribute("id")===I}},s.find.ID=function(_,I){if(typeof I.getElementById<"u"&&k){var B=I.getElementById(_);return B?[B]:[]}}):(s.filter.ID=function(_){var I=_.replace(Ve,Ke);return function(B){var R=typeof B.getAttributeNode<"u"&&B.getAttributeNode("id");return R&&R.value===I}},s.find.ID=function(_,I){if(typeof I.getElementById<"u"&&k){var B,R,W,q=I.getElementById(_);if(q){if(B=q.getAttributeNode("id"),B&&B.value===_)return[q];for(W=I.getElementsByName(_),R=0;q=W[R++];)if(B=q.getAttributeNode("id"),B&&B.value===_)return[q]}return[]}}),s.find.TAG=function(_,I){return typeof I.getElementsByTagName<"u"?I.getElementsByTagName(_):I.querySelectorAll(_)},s.find.CLASS=function(_,I){if(typeof I.getElementsByClassName<"u"&&k)return I.getElementsByClassName(_)},E=[],kt(function(_){var I;x.appendChild(_).innerHTML="<a id='"+A+"' href='' disabled='disabled'></a><select id='"+A+"-\r\\' disabled='disabled'><option selected=''></option></select>",_.querySelectorAll("[selected]").length||E.push("\\["+re+"*(?:value|"+Ne+")"),_.querySelectorAll("[id~="+A+"-]").length||E.push("~="),_.querySelectorAll("a#"+A+"+*").length||E.push(".#.+[+~]"),_.querySelectorAll(":checked").length||E.push(":checked"),I=b.createElement("input"),I.setAttribute("type","hidden"),_.appendChild(I).setAttribute("name","D"),x.appendChild(_).disabled=!0,_.querySelectorAll(":disabled").length!==2&&E.push(":enabled",":disabled"),I=b.createElement("input"),I.setAttribute("name",""),_.appendChild(I),_.querySelectorAll("[name='']").length||E.push("\\["+re+"*name"+re+"*="+re+`*(?:''|"")`)}),N.cssHas||E.push(":has"),E=E.length&&new RegExp(E.join("|")),ce=function(_,I){if(_===I)return p=!0,0;var B=!_.compareDocumentPosition-!I.compareDocumentPosition;return B||(B=(_.ownerDocument||_)==(I.ownerDocument||I)?_.compareDocumentPosition(I):1,B&1||!N.sortDetached&&I.compareDocumentPosition(_)===B?_===b||_.ownerDocument==He&&ne.contains(He,_)?-1:I===b||I.ownerDocument==He&&ne.contains(He,I)?1:d?g.call(d,_)-g.call(d,I):0:B&4?-1:1)}),b}ne.matches=function(v,S){return ne(v,null,null,S)},ne.matchesSelector=function(v,S){if(tt(v),k&&!pe[S+" "]&&(!E||!E.test(S)))try{var j=P.call(v,S);if(j||N.disconnectedMatch||v.document&&v.document.nodeType!==11)return j}catch{pe(S,!0)}return ne(S,b,null,[v]).length>0},ne.contains=function(v,S){return(v.ownerDocument||v)!=b&&tt(v),h.contains(v,S)},ne.attr=function(v,S){(v.ownerDocument||v)!=b&&tt(v);var j=s.attrHandle[S.toLowerCase()],_=j&&T.call(s.attrHandle,S.toLowerCase())?j(v,S,!k):void 0;return _!==void 0?_:v.getAttribute(S)},ne.error=function(v){throw new Error("Syntax error, unrecognized expression: "+v)},h.uniqueSort=function(v){var S,j=[],_=0,I=0;if(p=!N.sortStable,d=!N.sortStable&&o.call(v,0),cr.call(v,ce),p){for(;S=v[I++];)S===v[I]&&(_=j.push(I));for(;_--;)hr.call(v,j[_],1)}return d=null,v},h.fn.uniqueSort=function(){return this.pushStack(h.uniqueSort(o.apply(this)))},s=h.expr={cacheLength:50,createPseudo:Me,match:Re,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(v){return v[1]=v[1].replace(Ve,Ke),v[3]=(v[3]||v[4]||v[5]||"").replace(Ve,Ke),v[2]==="~="&&(v[3]=" "+v[3]+" "),v.slice(0,4)},CHILD:function(v){return v[1]=v[1].toLowerCase(),v[1].slice(0,3)==="nth"?(v[3]||ne.error(v[0]),v[4]=+(v[4]?v[5]+(v[6]||1):2*(v[3]==="even"||v[3]==="odd")),v[5]=+(v[7]+v[8]||v[3]==="odd")):v[3]&&ne.error(v[0]),v},PSEUDO:function(v){var S,j=!v[6]&&v[2];return Re.CHILD.test(v[0])?null:(v[3]?v[2]=v[4]||v[5]||"":j&&Fe.test(j)&&(S=Qt(j,!0))&&(S=j.indexOf(")",j.length-S)-j.length)&&(v[0]=v[0].slice(0,S),v[2]=j.slice(0,S)),v.slice(0,3))}},filter:{TAG:function(v){var S=v.replace(Ve,Ke).toLowerCase();return v==="*"?function(){return!0}:function(j){return oe(j,S)}},CLASS:function(v){var S=G[v+" "];return S||(S=new RegExp("(^|"+re+")"+v+"("+re+"|$)"))&&G(v,function(j){return S.test(typeof j.className=="string"&&j.className||typeof j.getAttribute<"u"&&j.getAttribute("class")||"")})},ATTR:function(v,S,j){return function(_){var I=ne.attr(_,v);return I==null?S==="!=":S?(I+="",S==="="?I===j:S==="!="?I!==j:S==="^="?j&&I.indexOf(j)===0:S==="*="?j&&I.indexOf(j)>-1:S==="$="?j&&I.slice(-j.length)===j:S==="~="?(" "+I.replace(ie," ")+" ").indexOf(j)>-1:S==="|="?I===j||I.slice(0,j.length+1)===j+"-":!1):!0}},CHILD:function(v,S,j,_,I){var B=v.slice(0,3)!=="nth",R=v.slice(-4)!=="last",W=S==="of-type";return _===1&&I===0?function(q){return!!q.parentNode}:function(q,Y,V){var X,J,U,se,xe,ge=B!==R?"nextSibling":"previousSibling",De=q.parentNode,qe=W&&q.nodeName.toLowerCase(),xt=!V&&!W,be=!1;if(De){if(B){for(;ge;){for(U=q;U=U[ge];)if(W?oe(U,qe):U.nodeType===1)return!1;xe=ge=v==="only"&&!xe&&"nextSibling"}return!0}if(xe=[R?De.firstChild:De.lastChild],R&&xt){for(J=De[A]||(De[A]={}),X=J[v]||[],se=X[0]===L&&X[1],be=se&&X[2],U=se&&De.childNodes[se];U=++se&&U&&U[ge]||(be=se=0)||xe.pop();)if(U.nodeType===1&&++be&&U===q){J[v]=[L,se,be];break}}else if(xt&&(J=q[A]||(q[A]={}),X=J[v]||[],se=X[0]===L&&X[1],be=se),be===!1)for(;(U=++se&&U&&U[ge]||(be=se=0)||xe.pop())&&!((W?oe(U,qe):U.nodeType===1)&&++be&&(xt&&(J=U[A]||(U[A]={}),J[v]=[L,be]),U===q)););return be-=I,be===_||be%_===0&&be/_>=0}}},PSEUDO:function(v,S){var j,_=s.pseudos[v]||s.setFilters[v.toLowerCase()]||ne.error("unsupported pseudo: "+v);return _[A]?_(S):_.length>1?(j=[v,v,"",S],s.setFilters.hasOwnProperty(v.toLowerCase())?Me(function(I,B){for(var R,W=_(I,S),q=W.length;q--;)R=g.call(I,W[q]),I[R]=!(B[R]=W[q])}):function(I){return _(I,0,j)}):_}},pseudos:{not:Me(function(v){var S=[],j=[],_=Wi(v.replace(Pt,"$1"));return _[A]?Me(function(I,B,R,W){for(var q,Y=_(I,null,W,[]),V=I.length;V--;)(q=Y[V])&&(I[V]=!(B[V]=q))}):function(I,B,R){return S[0]=I,_(S,null,R,j),S[0]=null,!j.pop()}}),has:Me(function(v){return function(S){return ne(v,S).length>0}}),contains:Me(function(v){return v=v.replace(Ve,Ke),function(S){return(S.textContent||h.text(S)).indexOf(v)>-1}}),lang:Me(function(v){return qt.test(v||"")||ne.error("unsupported lang: "+v),v=v.replace(Ve,Ke).toLowerCase(),function(S){var j;do if(j=k?S.lang:S.getAttribute("xml:lang")||S.getAttribute("lang"))return j=j.toLowerCase(),j===v||j.indexOf(v+"-")===0;while((S=S.parentNode)&&S.nodeType===1);return!1}}),target:function(v){var S=e.location&&e.location.hash;return S&&S.slice(1)===v.id},root:function(v){return v===x},focus:function(v){return v===cs()&&b.hasFocus()&&!!(v.type||v.href||~v.tabIndex)},enabled:Wn(!1),disabled:Wn(!0),checked:function(v){return oe(v,"input")&&!!v.checked||oe(v,"option")&&!!v.selected},selected:function(v){return v.parentNode&&v.parentNode.selectedIndex,v.selected===!0},empty:function(v){for(v=v.firstChild;v;v=v.nextSibling)if(v.nodeType<6)return!1;return!0},parent:function(v){return!s.pseudos.empty(v)},header:function(v){return et.test(v.nodeName)},input:function(v){return Je.test(v.nodeName)},button:function(v){return oe(v,"input")&&v.type==="button"||oe(v,"button")},text:function(v){var S;return oe(v,"input")&&v.type==="text"&&((S=v.getAttribute("type"))==null||S.toLowerCase()==="text")},first:lt(function(){return[0]}),last:lt(function(v,S){return[S-1]}),eq:lt(function(v,S,j){return[j<0?j+S:j]}),even:lt(function(v,S){for(var j=0;j<S;j+=2)v.push(j);return v}),odd:lt(function(v,S){for(var j=1;j<S;j+=2)v.push(j);return v}),lt:lt(function(v,S,j){var _;for(j<0?_=j+S:j>S?_=S:_=j;--_>=0;)v.push(_);return v}),gt:lt(function(v,S,j){for(var _=j<0?j+S:j;++_<S;)v.push(_);return v})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=hs(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=fs(n);function Hn(){}Hn.prototype=s.filters=s.pseudos,s.setFilters=new Hn;function Qt(v,S){var j,_,I,B,R,W,q,Y=te[v+" "];if(Y)return S?0:Y.slice(0);for(R=v,W=[],q=s.preFilter;R;){(!j||(_=le.exec(R)))&&(_&&(R=R.slice(_[0].length)||R),W.push(I=[])),j=!1,(_=Rt.exec(R))&&(j=_.shift(),I.push({value:j,type:_[0].replace(Pt," ")}),R=R.slice(j.length));for(B in s.filter)(_=Re[B].exec(R))&&(!q[B]||(_=q[B](_)))&&(j=_.shift(),I.push({value:j,type:B,matches:_}),R=R.slice(j.length));if(!j)break}return S?R.length:R?ne.error(v):te(v,W).slice(0)}function oi(v){for(var S=0,j=v.length,_="";S<j;S++)_+=v[S].value;return _}function ai(v,S,j){var _=S.dir,I=S.next,B=I||_,R=j&&B==="parentNode",W=O++;return S.first?function(q,Y,V){for(;q=q[_];)if(q.nodeType===1||R)return v(q,Y,V);return!1}:function(q,Y,V){var X,J,U=[L,W];if(V){for(;q=q[_];)if((q.nodeType===1||R)&&v(q,Y,V))return!0}else for(;q=q[_];)if(q.nodeType===1||R)if(J=q[A]||(q[A]={}),I&&oe(q,I))q=q[_]||q;else{if((X=J[B])&&X[0]===L&&X[1]===W)return U[2]=X[2];if(J[B]=U,U[2]=v(q,Y,V))return!0}return!1}}function Ri(v){return v.length>1?function(S,j,_){for(var I=v.length;I--;)if(!v[I](S,j,_))return!1;return!0}:v[0]}function ps(v,S,j){for(var _=0,I=S.length;_<I;_++)ne(v,S[_],j);return j}function li(v,S,j,_,I){for(var B,R=[],W=0,q=v.length,Y=S!=null;W<q;W++)(B=v[W])&&(!j||j(B,_,I))&&(R.push(B),Y&&S.push(W));return R}function qi(v,S,j,_,I,B){return _&&!_[A]&&(_=qi(_)),I&&!I[A]&&(I=qi(I,B)),Me(function(R,W,q,Y){var V,X,J,U,se=[],xe=[],ge=W.length,De=R||ps(S||"*",q.nodeType?[q]:q,[]),qe=v&&(R||!S)?li(De,se,v,q,Y):De;if(j?(U=I||(R?v:ge||_)?[]:W,j(qe,U,q,Y)):U=qe,_)for(V=li(U,xe),_(V,[],q,Y),X=V.length;X--;)(J=V[X])&&(U[xe[X]]=!(qe[xe[X]]=J));if(R){if(I||v){if(I){for(V=[],X=U.length;X--;)(J=U[X])&&V.push(qe[X]=J);I(null,U=[],V,Y)}for(X=U.length;X--;)(J=U[X])&&(V=I?g.call(R,J):se[X])>-1&&(R[V]=!(W[V]=J))}}else U=li(U===W?U.splice(ge,U.length):U),I?I(null,W,U,Y):m.apply(W,U)})}function Qi(v){for(var S,j,_,I=v.length,B=s.relative[v[0].type],R=B||s.relative[" "],W=B?1:0,q=ai(function(X){return X===S},R,!0),Y=ai(function(X){return g.call(S,X)>-1},R,!0),V=[function(X,J,U){var se=!B&&(U||J!=l)||((S=J).nodeType?q(X,J,U):Y(X,J,U));return S=null,se}];W<I;W++)if(j=s.relative[v[W].type])V=[ai(Ri(V),j)];else{if(j=s.filter[v[W].type].apply(null,v[W].matches),j[A]){for(_=++W;_<I&&!s.relative[v[_].type];_++);return qi(W>1&&Ri(V),W>1&&oi(v.slice(0,W-1).concat({value:v[W-2].type===" "?"*":""})).replace(Pt,"$1"),j,W<_&&Qi(v.slice(W,_)),_<I&&Qi(v=v.slice(_)),_<I&&oi(v))}V.push(j)}return Ri(V)}function ms(v,S){var j=S.length>0,_=v.length>0,I=function(B,R,W,q,Y){var V,X,J,U=0,se="0",xe=B&&[],ge=[],De=l,qe=B||_&&s.find.TAG("*",Y),xt=L+=De==null?1:Math.random()||.1,be=qe.length;for(Y&&(l=R==b||R||Y);se!==be&&(V=qe[se])!=null;se++){if(_&&V){for(X=0,!R&&V.ownerDocument!=b&&(tt(V),W=!k);J=v[X++];)if(J(V,R||b,W)){m.call(q,V);break}Y&&(L=xt)}j&&((V=!J&&V)&&U--,B&&xe.push(V))}if(U+=se,j&&se!==U){for(X=0;J=S[X++];)J(xe,ge,R,W);if(B){if(U>0)for(;se--;)xe[se]||ge[se]||(ge[se]=dr.call(q));ge=li(ge)}m.apply(q,ge),Y&&!B&&ge.length>0&&U+S.length>1&&h.uniqueSort(q)}return Y&&(L=xt,l=De),xe};return j?Me(I):I}function Wi(v,S){var j,_=[],I=[],B=Z[v+" "];if(!B){for(S||(S=Qt(v)),j=S.length;j--;)B=Qi(S[j]),B[A]?_.push(B):I.push(B);B=Z(v,ms(I,_)),B.selector=v}return B}function zn(v,S,j,_){var I,B,R,W,q,Y=typeof v=="function"&&v,V=!_&&Qt(v=Y.selector||v);if(j=j||[],V.length===1){if(B=V[0]=V[0].slice(0),B.length>2&&(R=B[0]).type==="ID"&&S.nodeType===9&&k&&s.relative[B[1].type]){if(S=(s.find.ID(R.matches[0].replace(Ve,Ke),S)||[])[0],S)Y&&(S=S.parentNode);else return j;v=v.slice(B.shift().value.length)}for(I=Re.needsContext.test(v)?0:B.length;I--&&(R=B[I],!s.relative[W=R.type]);)if((q=s.find[W])&&(_=q(R.matches[0].replace(Ve,Ke),Bi.test(B[0].type)&&Fi(S.parentNode)||S))){if(B.splice(I,1),v=_.length&&oi(B),!v)return m.apply(j,_),j;break}}return(Y||Wi(v,V))(_,S,!k,j,!S||Bi.test(v)&&Fi(S.parentNode)||S),j}N.sortStable=A.split("").sort(ce).join("")===A,tt(),N.sortDetached=kt(function(v){return v.compareDocumentPosition(b.createElement("fieldset"))&1}),h.find=ne,h.expr[":"]=h.expr.pseudos,h.unique=h.uniqueSort,ne.compile=Wi,ne.select=zn,ne.setDocument=tt,ne.tokenize=Qt,ne.escape=h.escapeSelector,ne.getText=h.text,ne.isXML=h.isXMLDoc,ne.selectors=h.expr,ne.support=h.support,ne.uniqueSort=h.uniqueSort})();var ft=function(n,s,l){for(var d=[],p=l!==void 0;(n=n[s])&&n.nodeType!==9;)if(n.nodeType===1){if(p&&h(n).is(l))break;d.push(n)}return d},on=function(n,s){for(var l=[];n;n=n.nextSibling)n.nodeType===1&&n!==s&&l.push(n);return l},an=h.expr.match.needsContext,ln=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function ki(n,s,l){return M(s)?h.grep(n,function(d,p){return!!s.call(d,p,d)!==l}):s.nodeType?h.grep(n,function(d){return d===s!==l}):typeof s!="string"?h.grep(n,function(d){return g.call(s,d)>-1!==l}):h.filter(s,n,l)}h.filter=function(n,s,l){var d=s[0];return l&&(n=":not("+n+")"),s.length===1&&d.nodeType===1?h.find.matchesSelector(d,n)?[d]:[]:h.find.matches(n,h.grep(s,function(p){return p.nodeType===1}))},h.fn.extend({find:function(n){var s,l,d=this.length,p=this;if(typeof n!="string")return this.pushStack(h(n).filter(function(){for(s=0;s<d;s++)if(h.contains(p[s],this))return!0}));for(l=this.pushStack([]),s=0;s<d;s++)h.find(n,p[s],l);return d>1?h.uniqueSort(l):l},filter:function(n){return this.pushStack(ki(this,n||[],!1))},not:function(n){return this.pushStack(ki(this,n||[],!0))},is:function(n){return!!ki(this,typeof n=="string"&&an.test(n)?h(n):n||[],!1).length}});var un,mr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,gr=h.fn.init=function(n,s,l){var d,p;if(!n)return this;if(l=l||un,typeof n=="string")if(n[0]==="<"&&n[n.length-1]===">"&&n.length>=3?d=[null,n,null]:d=mr.exec(n),d&&(d[1]||!s))if(d[1]){if(s=s instanceof h?s[0]:s,h.merge(this,h.parseHTML(d[1],s&&s.nodeType?s.ownerDocument||s:F,!0)),ln.test(d[1])&&h.isPlainObject(s))for(d in s)M(this[d])?this[d](s[d]):this.attr(d,s[d]);return this}else return p=F.getElementById(d[2]),p&&(this[0]=p,this.length=1),this;else return!s||s.jquery?(s||l).find(n):this.constructor(s).find(n);else{if(n.nodeType)return this[0]=n,this.length=1,this;if(M(n))return l.ready!==void 0?l.ready(n):n(h)}return h.makeArray(n,this)};gr.prototype=h.fn,un=h(F);var br=/^(?:parents|prev(?:Until|All))/,yr={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({has:function(n){var s=h(n,this),l=s.length;return this.filter(function(){for(var d=0;d<l;d++)if(h.contains(this,s[d]))return!0})},closest:function(n,s){var l,d=0,p=this.length,m=[],b=typeof n!="string"&&h(n);if(!an.test(n)){for(;d<p;d++)for(l=this[d];l&&l!==s;l=l.parentNode)if(l.nodeType<11&&(b?b.index(l)>-1:l.nodeType===1&&h.find.matchesSelector(l,n))){m.push(l);break}}return this.pushStack(m.length>1?h.uniqueSort(m):m)},index:function(n){return n?typeof n=="string"?g.call(h(n),this[0]):g.call(this,n.jquery?n[0]:n):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(n,s){return this.pushStack(h.uniqueSort(h.merge(this.get(),h(n,s))))},addBack:function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))}});function dn(n,s){for(;(n=n[s])&&n.nodeType!==1;);return n}h.each({parent:function(n){var s=n.parentNode;return s&&s.nodeType!==11?s:null},parents:function(n){return ft(n,"parentNode")},parentsUntil:function(n,s,l){return ft(n,"parentNode",l)},next:function(n){return dn(n,"nextSibling")},prev:function(n){return dn(n,"previousSibling")},nextAll:function(n){return ft(n,"nextSibling")},prevAll:function(n){return ft(n,"previousSibling")},nextUntil:function(n,s,l){return ft(n,"nextSibling",l)},prevUntil:function(n,s,l){return ft(n,"previousSibling",l)},siblings:function(n){return on((n.parentNode||{}).firstChild,n)},children:function(n){return on(n.firstChild)},contents:function(n){return n.contentDocument!=null&&r(n.contentDocument)?n.contentDocument:(oe(n,"template")&&(n=n.content||n),h.merge([],n.childNodes))}},function(n,s){h.fn[n]=function(l,d){var p=h.map(this,s,l);return n.slice(-5)!=="Until"&&(d=l),d&&typeof d=="string"&&(p=h.filter(d,p)),this.length>1&&(yr[n]||h.uniqueSort(p),br.test(n)&&p.reverse()),this.pushStack(p)}});var Oe=/[^\x20\t\r\n\f]+/g;function wr(n){var s={};return h.each(n.match(Oe)||[],function(l,d){s[d]=!0}),s}h.Callbacks=function(n){n=typeof n=="string"?wr(n):h.extend({},n);var s,l,d,p,m=[],b=[],x=-1,k=function(){for(p=p||n.once,d=s=!0;b.length;x=-1)for(l=b.shift();++x<m.length;)m[x].apply(l[0],l[1])===!1&&n.stopOnFalse&&(x=m.length,l=!1);n.memory||(l=!1),s=!1,p&&(l?m=[]:m="")},E={add:function(){return m&&(l&&!s&&(x=m.length-1,b.push(l)),function P(A){h.each(A,function(L,O){M(O)?(!n.unique||!E.has(O))&&m.push(O):O&&O.length&&de(O)!=="string"&&P(O)})}(arguments),l&&!s&&k()),this},remove:function(){return h.each(arguments,function(P,A){for(var L;(L=h.inArray(A,m,L))>-1;)m.splice(L,1),L<=x&&x--}),this},has:function(P){return P?h.inArray(P,m)>-1:m.length>0},empty:function(){return m&&(m=[]),this},disable:function(){return p=b=[],m=l="",this},disabled:function(){return!m},lock:function(){return p=b=[],!l&&!s&&(m=l=""),this},locked:function(){return!!p},fireWith:function(P,A){return p||(A=A||[],A=[P,A.slice?A.slice():A],b.push(A),s||k()),this},fire:function(){return E.fireWith(this,arguments),this},fired:function(){return!!d}};return E};function pt(n){return n}function Yt(n){throw n}function cn(n,s,l,d){var p;try{n&&M(p=n.promise)?p.call(n).done(s).fail(l):n&&M(p=n.then)?p.call(n,s,l):s.apply(void 0,[n].slice(d))}catch(m){l.apply(void 0,[m])}}h.extend({Deferred:function(n){var s=[["notify","progress",h.Callbacks("memory"),h.Callbacks("memory"),2],["resolve","done",h.Callbacks("once memory"),h.Callbacks("once memory"),0,"resolved"],["reject","fail",h.Callbacks("once memory"),h.Callbacks("once memory"),1,"rejected"]],l="pending",d={state:function(){return l},always:function(){return p.done(arguments).fail(arguments),this},catch:function(m){return d.then(null,m)},pipe:function(){var m=arguments;return h.Deferred(function(b){h.each(s,function(x,k){var E=M(m[k[4]])&&m[k[4]];p[k[1]](function(){var P=E&&E.apply(this,arguments);P&&M(P.promise)?P.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[k[0]+"With"](this,E?[P]:arguments)})}),m=null}).promise()},then:function(m,b,x){var k=0;function E(P,A,L,O){return function(){var G=this,te=arguments,Z=function(){var ce,Ne;if(!(P<k)){if(ce=L.apply(G,te),ce===A.promise())throw new TypeError("Thenable self-resolution");Ne=ce&&(typeof ce=="object"||typeof ce=="function")&&ce.then,M(Ne)?O?Ne.call(ce,E(k,A,pt,O),E(k,A,Yt,O)):(k++,Ne.call(ce,E(k,A,pt,O),E(k,A,Yt,O),E(k,A,pt,A.notifyWith))):(L!==pt&&(G=void 0,te=[ce]),(O||A.resolveWith)(G,te))}},pe=O?Z:function(){try{Z()}catch(ce){h.Deferred.exceptionHook&&h.Deferred.exceptionHook(ce,pe.error),P+1>=k&&(L!==Yt&&(G=void 0,te=[ce]),A.rejectWith(G,te))}};P?pe():(h.Deferred.getErrorHook?pe.error=h.Deferred.getErrorHook():h.Deferred.getStackHook&&(pe.error=h.Deferred.getStackHook()),e.setTimeout(pe))}}return h.Deferred(function(P){s[0][3].add(E(0,P,M(x)?x:pt,P.notifyWith)),s[1][3].add(E(0,P,M(m)?m:pt)),s[2][3].add(E(0,P,M(b)?b:Yt))}).promise()},promise:function(m){return m!=null?h.extend(m,d):d}},p={};return h.each(s,function(m,b){var x=b[2],k=b[5];d[b[1]]=x.add,k&&x.add(function(){l=k},s[3-m][2].disable,s[3-m][3].disable,s[0][2].lock,s[0][3].lock),x.add(b[3].fire),p[b[0]]=function(){return p[b[0]+"With"](this===p?void 0:this,arguments),this},p[b[0]+"With"]=x.fireWith}),d.promise(p),n&&n.call(p,p),p},when:function(n){var s=arguments.length,l=s,d=Array(l),p=o.call(arguments),m=h.Deferred(),b=function(x){return function(k){d[x]=this,p[x]=arguments.length>1?o.call(arguments):k,--s||m.resolveWith(d,p)}};if(s<=1&&(cn(n,m.done(b(l)).resolve,m.reject,!s),m.state()==="pending"||M(p[l]&&p[l].then)))return m.then();for(;l--;)cn(p[l],b(l),m.reject);return m.promise()}});var vr=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;h.Deferred.exceptionHook=function(n,s){e.console&&e.console.warn&&n&&vr.test(n.name)&&e.console.warn("jQuery.Deferred exception: "+n.message,n.stack,s)},h.readyException=function(n){e.setTimeout(function(){throw n})};var xi=h.Deferred();h.fn.ready=function(n){return xi.then(n).catch(function(s){h.readyException(s)}),this},h.extend({isReady:!1,readyWait:1,ready:function(n){(n===!0?--h.readyWait:h.isReady)||(h.isReady=!0,!(n!==!0&&--h.readyWait>0)&&xi.resolveWith(F,[h]))}}),h.ready.then=xi.then;function Jt(){F.removeEventListener("DOMContentLoaded",Jt),e.removeEventListener("load",Jt),h.ready()}F.readyState==="complete"||F.readyState!=="loading"&&!F.documentElement.doScroll?e.setTimeout(h.ready):(F.addEventListener("DOMContentLoaded",Jt),e.addEventListener("load",Jt));var ze=function(n,s,l,d,p,m,b){var x=0,k=n.length,E=l==null;if(de(l)==="object"){p=!0;for(x in l)ze(n,s,x,l[x],!0,m,b)}else if(d!==void 0&&(p=!0,M(d)||(b=!0),E&&(b?(s.call(n,d),s=null):(E=s,s=function(P,A,L){return E.call(h(P),L)})),s))for(;x<k;x++)s(n[x],l,b?d:d.call(n[x],x,s(n[x],l)));return p?n:E?s.call(n):k?s(n[0],l):m},kr=/^-ms-/,xr=/-([a-z])/g;function Cr(n,s){return s.toUpperCase()}function $e(n){return n.replace(kr,"ms-").replace(xr,Cr)}var Mt=function(n){return n.nodeType===1||n.nodeType===9||!+n.nodeType};function It(){this.expando=h.expando+It.uid++}It.uid=1,It.prototype={cache:function(n){var s=n[this.expando];return s||(s={},Mt(n)&&(n.nodeType?n[this.expando]=s:Object.defineProperty(n,this.expando,{value:s,configurable:!0}))),s},set:function(n,s,l){var d,p=this.cache(n);if(typeof s=="string")p[$e(s)]=l;else for(d in s)p[$e(d)]=s[d];return p},get:function(n,s){return s===void 0?this.cache(n):n[this.expando]&&n[this.expando][$e(s)]},access:function(n,s,l){return s===void 0||s&&typeof s=="string"&&l===void 0?this.get(n,s):(this.set(n,s,l),l!==void 0?l:s)},remove:function(n,s){var l,d=n[this.expando];if(d!==void 0){if(s!==void 0)for(Array.isArray(s)?s=s.map($e):(s=$e(s),s=s in d?[s]:s.match(Oe)||[]),l=s.length;l--;)delete d[s[l]];(s===void 0||h.isEmptyObject(d))&&(n.nodeType?n[this.expando]=void 0:delete n[this.expando])}},hasData:function(n){var s=n[this.expando];return s!==void 0&&!h.isEmptyObject(s)}};var z=new It,we=new It,Sr=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Er=/[A-Z]/g;function Tr(n){return n==="true"?!0:n==="false"?!1:n==="null"?null:n===+n+""?+n:Sr.test(n)?JSON.parse(n):n}function hn(n,s,l){var d;if(l===void 0&&n.nodeType===1)if(d="data-"+s.replace(Er,"-$&").toLowerCase(),l=n.getAttribute(d),typeof l=="string"){try{l=Tr(l)}catch{}we.set(n,s,l)}else l=void 0;return l}h.extend({hasData:function(n){return we.hasData(n)||z.hasData(n)},data:function(n,s,l){return we.access(n,s,l)},removeData:function(n,s){we.remove(n,s)},_data:function(n,s,l){return z.access(n,s,l)},_removeData:function(n,s){z.remove(n,s)}}),h.fn.extend({data:function(n,s){var l,d,p,m=this[0],b=m&&m.attributes;if(n===void 0){if(this.length&&(p=we.get(m),m.nodeType===1&&!z.get(m,"hasDataAttrs"))){for(l=b.length;l--;)b[l]&&(d=b[l].name,d.indexOf("data-")===0&&(d=$e(d.slice(5)),hn(m,d,p[d])));z.set(m,"hasDataAttrs",!0)}return p}return typeof n=="object"?this.each(function(){we.set(this,n)}):ze(this,function(x){var k;if(m&&x===void 0)return k=we.get(m,n),k!==void 0||(k=hn(m,n),k!==void 0)?k:void 0;this.each(function(){we.set(this,n,x)})},null,s,arguments.length>1,null,!0)},removeData:function(n){return this.each(function(){we.remove(this,n)})}}),h.extend({queue:function(n,s,l){var d;if(n)return s=(s||"fx")+"queue",d=z.get(n,s),l&&(!d||Array.isArray(l)?d=z.access(n,s,h.makeArray(l)):d.push(l)),d||[]},dequeue:function(n,s){s=s||"fx";var l=h.queue(n,s),d=l.length,p=l.shift(),m=h._queueHooks(n,s),b=function(){h.dequeue(n,s)};p==="inprogress"&&(p=l.shift(),d--),p&&(s==="fx"&&l.unshift("inprogress"),delete m.stop,p.call(n,b,m)),!d&&m&&m.empty.fire()},_queueHooks:function(n,s){var l=s+"queueHooks";return z.get(n,l)||z.access(n,l,{empty:h.Callbacks("once memory").add(function(){z.remove(n,[s+"queue",l])})})}}),h.fn.extend({queue:function(n,s){var l=2;return typeof n!="string"&&(s=n,n="fx",l--),arguments.length<l?h.queue(this[0],n):s===void 0?this:this.each(function(){var d=h.queue(this,n,s);h._queueHooks(this,n),n==="fx"&&d[0]!=="inprogress"&&h.dequeue(this,n)})},dequeue:function(n){return this.each(function(){h.dequeue(this,n)})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,s){var l,d=1,p=h.Deferred(),m=this,b=this.length,x=function(){--d||p.resolveWith(m,[m])};for(typeof n!="string"&&(s=n,n=void 0),n=n||"fx";b--;)l=z.get(m[b],n+"queueHooks"),l&&l.empty&&(d++,l.empty.add(x));return x(),p.promise(s)}});var fn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=new RegExp("^(?:([+-])=|)("+fn+")([a-z%]*)$","i"),Ue=["Top","Right","Bottom","Left"],rt=F.documentElement,mt=function(n){return h.contains(n.ownerDocument,n)},jr={composed:!0};rt.getRootNode&&(mt=function(n){return h.contains(n.ownerDocument,n)||n.getRootNode(jr)===n.ownerDocument});var ei=function(n,s){return n=s||n,n.style.display==="none"||n.style.display===""&&mt(n)&&h.css(n,"display")==="none"};function pn(n,s,l,d){var p,m,b=20,x=d?function(){return d.cur()}:function(){return h.css(n,s,"")},k=x(),E=l&&l[3]||(h.cssNumber[s]?"":"px"),P=n.nodeType&&(h.cssNumber[s]||E!=="px"&&+k)&&At.exec(h.css(n,s));if(P&&P[3]!==E){for(k=k/2,E=E||P[3],P=+k||1;b--;)h.style(n,s,P+E),(1-m)*(1-(m=x()/k||.5))<=0&&(b=0),P=P/m;P=P*2,h.style(n,s,P+E),l=l||[]}return l&&(P=+P||+k||0,p=l[1]?P+(l[1]+1)*l[2]:+l[2],d&&(d.unit=E,d.start=P,d.end=p)),p}var mn={};function Dr(n){var s,l=n.ownerDocument,d=n.nodeName,p=mn[d];return p||(s=l.body.appendChild(l.createElement(d)),p=h.css(s,"display"),s.parentNode.removeChild(s),p==="none"&&(p="block"),mn[d]=p,p)}function gt(n,s){for(var l,d,p=[],m=0,b=n.length;m<b;m++)d=n[m],d.style&&(l=d.style.display,s?(l==="none"&&(p[m]=z.get(d,"display")||null,p[m]||(d.style.display="")),d.style.display===""&&ei(d)&&(p[m]=Dr(d))):l!=="none"&&(p[m]="none",z.set(d,"display",l)));for(m=0;m<b;m++)p[m]!=null&&(n[m].style.display=p[m]);return n}h.fn.extend({show:function(){return gt(this,!0)},hide:function(){return gt(this)},toggle:function(n){return typeof n=="boolean"?n?this.show():this.hide():this.each(function(){ei(this)?h(this).show():h(this).hide()})}});var Ot=/^(?:checkbox|radio)$/i,gn=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,bn=/^$|^module$|\/(?:java|ecma)script/i;(function(){var n=F.createDocumentFragment(),s=n.appendChild(F.createElement("div")),l=F.createElement("input");l.setAttribute("type","radio"),l.setAttribute("checked","checked"),l.setAttribute("name","t"),s.appendChild(l),N.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,s.innerHTML="<textarea>x</textarea>",N.noCloneChecked=!!s.cloneNode(!0).lastChild.defaultValue,s.innerHTML="<option></option>",N.option=!!s.lastChild})();var Te={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Te.tbody=Te.tfoot=Te.colgroup=Te.caption=Te.thead,Te.th=Te.td,N.option||(Te.optgroup=Te.option=[1,"<select multiple='multiple'>","</select>"]);function ve(n,s){var l;return typeof n.getElementsByTagName<"u"?l=n.getElementsByTagName(s||"*"):typeof n.querySelectorAll<"u"?l=n.querySelectorAll(s||"*"):l=[],s===void 0||s&&oe(n,s)?h.merge([n],l):l}function Ci(n,s){for(var l=0,d=n.length;l<d;l++)z.set(n[l],"globalEval",!s||z.get(s[l],"globalEval"))}var Lr=/<|&#?\w+;/;function yn(n,s,l,d,p){for(var m,b,x,k,E,P,A=s.createDocumentFragment(),L=[],O=0,G=n.length;O<G;O++)if(m=n[O],m||m===0)if(de(m)==="object")h.merge(L,m.nodeType?[m]:m);else if(!Lr.test(m))L.push(s.createTextNode(m));else{for(b=b||A.appendChild(s.createElement("div")),x=(gn.exec(m)||["",""])[1].toLowerCase(),k=Te[x]||Te._default,b.innerHTML=k[1]+h.htmlPrefilter(m)+k[2],P=k[0];P--;)b=b.lastChild;h.merge(L,b.childNodes),b=A.firstChild,b.textContent=""}for(A.textContent="",O=0;m=L[O++];){if(d&&h.inArray(m,d)>-1){p&&p.push(m);continue}if(E=mt(m),b=ve(A.appendChild(m),"script"),E&&Ci(b),l)for(P=0;m=b[P++];)bn.test(m.type||"")&&l.push(m)}return A}var wn=/^([^.]*)(?:\.(.+)|)/;function bt(){return!0}function yt(){return!1}function Si(n,s,l,d,p,m){var b,x;if(typeof s=="object"){typeof l!="string"&&(d=d||l,l=void 0);for(x in s)Si(n,x,l,d,s[x],m);return n}if(d==null&&p==null?(p=l,d=l=void 0):p==null&&(typeof l=="string"?(p=d,d=void 0):(p=d,d=l,l=void 0)),p===!1)p=yt;else if(!p)return n;return m===1&&(b=p,p=function(k){return h().off(k),b.apply(this,arguments)},p.guid=b.guid||(b.guid=h.guid++)),n.each(function(){h.event.add(this,s,p,d,l)})}h.event={global:{},add:function(n,s,l,d,p){var m,b,x,k,E,P,A,L,O,G,te,Z=z.get(n);if(Mt(n))for(l.handler&&(m=l,l=m.handler,p=m.selector),p&&h.find.matchesSelector(rt,p),l.guid||(l.guid=h.guid++),(k=Z.events)||(k=Z.events=Object.create(null)),(b=Z.handle)||(b=Z.handle=function(pe){return typeof h<"u"&&h.event.triggered!==pe.type?h.event.dispatch.apply(n,arguments):void 0}),s=(s||"").match(Oe)||[""],E=s.length;E--;)x=wn.exec(s[E])||[],O=te=x[1],G=(x[2]||"").split(".").sort(),O&&(A=h.event.special[O]||{},O=(p?A.delegateType:A.bindType)||O,A=h.event.special[O]||{},P=h.extend({type:O,origType:te,data:d,handler:l,guid:l.guid,selector:p,needsContext:p&&h.expr.match.needsContext.test(p),namespace:G.join(".")},m),(L=k[O])||(L=k[O]=[],L.delegateCount=0,(!A.setup||A.setup.call(n,d,G,b)===!1)&&n.addEventListener&&n.addEventListener(O,b)),A.add&&(A.add.call(n,P),P.handler.guid||(P.handler.guid=l.guid)),p?L.splice(L.delegateCount++,0,P):L.push(P),h.event.global[O]=!0)},remove:function(n,s,l,d,p){var m,b,x,k,E,P,A,L,O,G,te,Z=z.hasData(n)&&z.get(n);if(!(!Z||!(k=Z.events))){for(s=(s||"").match(Oe)||[""],E=s.length;E--;){if(x=wn.exec(s[E])||[],O=te=x[1],G=(x[2]||"").split(".").sort(),!O){for(O in k)h.event.remove(n,O+s[E],l,d,!0);continue}for(A=h.event.special[O]||{},O=(d?A.delegateType:A.bindType)||O,L=k[O]||[],x=x[2]&&new RegExp("(^|\\.)"+G.join("\\.(?:.*\\.|)")+"(\\.|$)"),b=m=L.length;m--;)P=L[m],(p||te===P.origType)&&(!l||l.guid===P.guid)&&(!x||x.test(P.namespace))&&(!d||d===P.selector||d==="**"&&P.selector)&&(L.splice(m,1),P.selector&&L.delegateCount--,A.remove&&A.remove.call(n,P));b&&!L.length&&((!A.teardown||A.teardown.call(n,G,Z.handle)===!1)&&h.removeEvent(n,O,Z.handle),delete k[O])}h.isEmptyObject(k)&&z.remove(n,"handle events")}},dispatch:function(n){var s,l,d,p,m,b,x=new Array(arguments.length),k=h.event.fix(n),E=(z.get(this,"events")||Object.create(null))[k.type]||[],P=h.event.special[k.type]||{};for(x[0]=k,s=1;s<arguments.length;s++)x[s]=arguments[s];if(k.delegateTarget=this,!(P.preDispatch&&P.preDispatch.call(this,k)===!1)){for(b=h.event.handlers.call(this,k,E),s=0;(p=b[s++])&&!k.isPropagationStopped();)for(k.currentTarget=p.elem,l=0;(m=p.handlers[l++])&&!k.isImmediatePropagationStopped();)(!k.rnamespace||m.namespace===!1||k.rnamespace.test(m.namespace))&&(k.handleObj=m,k.data=m.data,d=((h.event.special[m.origType]||{}).handle||m.handler).apply(p.elem,x),d!==void 0&&(k.result=d)===!1&&(k.preventDefault(),k.stopPropagation()));return P.postDispatch&&P.postDispatch.call(this,k),k.result}},handlers:function(n,s){var l,d,p,m,b,x=[],k=s.delegateCount,E=n.target;if(k&&E.nodeType&&!(n.type==="click"&&n.button>=1)){for(;E!==this;E=E.parentNode||this)if(E.nodeType===1&&!(n.type==="click"&&E.disabled===!0)){for(m=[],b={},l=0;l<k;l++)d=s[l],p=d.selector+" ",b[p]===void 0&&(b[p]=d.needsContext?h(p,this).index(E)>-1:h.find(p,this,null,[E]).length),b[p]&&m.push(d);m.length&&x.push({elem:E,handlers:m})}}return E=this,k<s.length&&x.push({elem:E,handlers:s.slice(k)}),x},addProp:function(n,s){Object.defineProperty(h.Event.prototype,n,{enumerable:!0,configurable:!0,get:M(s)?function(){if(this.originalEvent)return s(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[n]},set:function(l){Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:l})}})},fix:function(n){return n[h.expando]?n:new h.Event(n)},special:{load:{noBubble:!0},click:{setup:function(n){var s=this||n;return Ot.test(s.type)&&s.click&&oe(s,"input")&&ti(s,"click",!0),!1},trigger:function(n){var s=this||n;return Ot.test(s.type)&&s.click&&oe(s,"input")&&ti(s,"click"),!0},_default:function(n){var s=n.target;return Ot.test(s.type)&&s.click&&oe(s,"input")&&z.get(s,"click")||oe(s,"a")}},beforeunload:{postDispatch:function(n){n.result!==void 0&&n.originalEvent&&(n.originalEvent.returnValue=n.result)}}}};function ti(n,s,l){if(!l){z.get(n,s)===void 0&&h.event.add(n,s,bt);return}z.set(n,s,!1),h.event.add(n,s,{namespace:!1,handler:function(d){var p,m=z.get(this,s);if(d.isTrigger&1&&this[s]){if(m)(h.event.special[s]||{}).delegateType&&d.stopPropagation();else if(m=o.call(arguments),z.set(this,s,m),this[s](),p=z.get(this,s),z.set(this,s,!1),m!==p)return d.stopImmediatePropagation(),d.preventDefault(),p}else m&&(z.set(this,s,h.event.trigger(m[0],m.slice(1),this)),d.stopPropagation(),d.isImmediatePropagationStopped=bt)}})}h.removeEvent=function(n,s,l){n.removeEventListener&&n.removeEventListener(s,l)},h.Event=function(n,s){if(!(this instanceof h.Event))return new h.Event(n,s);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.defaultPrevented===void 0&&n.returnValue===!1?bt:yt,this.target=n.target&&n.target.nodeType===3?n.target.parentNode:n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget):this.type=n,s&&h.extend(this,s),this.timeStamp=n&&n.timeStamp||Date.now(),this[h.expando]=!0},h.Event.prototype={constructor:h.Event,isDefaultPrevented:yt,isPropagationStopped:yt,isImmediatePropagationStopped:yt,isSimulated:!1,preventDefault:function(){var n=this.originalEvent;this.isDefaultPrevented=bt,n&&!this.isSimulated&&n.preventDefault()},stopPropagation:function(){var n=this.originalEvent;this.isPropagationStopped=bt,n&&!this.isSimulated&&n.stopPropagation()},stopImmediatePropagation:function(){var n=this.originalEvent;this.isImmediatePropagationStopped=bt,n&&!this.isSimulated&&n.stopImmediatePropagation(),this.stopPropagation()}},h.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},h.event.addProp),h.each({focus:"focusin",blur:"focusout"},function(n,s){function l(d){if(F.documentMode){var p=z.get(this,"handle"),m=h.event.fix(d);m.type=d.type==="focusin"?"focus":"blur",m.isSimulated=!0,p(d),m.target===m.currentTarget&&p(m)}else h.event.simulate(s,d.target,h.event.fix(d))}h.event.special[n]={setup:function(){var d;if(ti(this,n,!0),F.documentMode)d=z.get(this,s),d||this.addEventListener(s,l),z.set(this,s,(d||0)+1);else return!1},trigger:function(){return ti(this,n),!0},teardown:function(){var d;if(F.documentMode)d=z.get(this,s)-1,d?z.set(this,s,d):(this.removeEventListener(s,l),z.remove(this,s));else return!1},_default:function(d){return z.get(d.target,n)},delegateType:s},h.event.special[s]={setup:function(){var d=this.ownerDocument||this.document||this,p=F.documentMode?this:d,m=z.get(p,s);m||(F.documentMode?this.addEventListener(s,l):d.addEventListener(n,l,!0)),z.set(p,s,(m||0)+1)},teardown:function(){var d=this.ownerDocument||this.document||this,p=F.documentMode?this:d,m=z.get(p,s)-1;m?z.set(p,s,m):(F.documentMode?this.removeEventListener(s,l):d.removeEventListener(n,l,!0),z.remove(p,s))}}}),h.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(n,s){h.event.special[n]={delegateType:s,bindType:s,handle:function(l){var d,p=this,m=l.relatedTarget,b=l.handleObj;return(!m||m!==p&&!h.contains(p,m))&&(l.type=b.origType,d=b.handler.apply(this,arguments),l.type=s),d}}}),h.fn.extend({on:function(n,s,l,d){return Si(this,n,s,l,d)},one:function(n,s,l,d){return Si(this,n,s,l,d,1)},off:function(n,s,l){var d,p;if(n&&n.preventDefault&&n.handleObj)return d=n.handleObj,h(n.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if(typeof n=="object"){for(p in n)this.off(p,s,n[p]);return this}return(s===!1||typeof s=="function")&&(l=s,s=void 0),l===!1&&(l=yt),this.each(function(){h.event.remove(this,n,l,s)})}});var _r=/<script|<style|<link/i,Pr=/checked\s*(?:[^=]|=\s*.checked.)/i,Mr=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function vn(n,s){return oe(n,"table")&&oe(s.nodeType!==11?s:s.firstChild,"tr")&&h(n).children("tbody")[0]||n}function Ir(n){return n.type=(n.getAttribute("type")!==null)+"/"+n.type,n}function Ar(n){return(n.type||"").slice(0,5)==="true/"?n.type=n.type.slice(5):n.removeAttribute("type"),n}function kn(n,s){var l,d,p,m,b,x,k;if(s.nodeType===1){if(z.hasData(n)&&(m=z.get(n),k=m.events,k)){z.remove(s,"handle events");for(p in k)for(l=0,d=k[p].length;l<d;l++)h.event.add(s,p,k[p][l])}we.hasData(n)&&(b=we.access(n),x=h.extend({},b),we.set(s,x))}}function Or(n,s){var l=s.nodeName.toLowerCase();l==="input"&&Ot.test(n.type)?s.checked=n.checked:(l==="input"||l==="textarea")&&(s.defaultValue=n.defaultValue)}function wt(n,s,l,d){s=u(s);var p,m,b,x,k,E,P=0,A=n.length,L=A-1,O=s[0],G=M(O);if(G||A>1&&typeof O=="string"&&!N.checkClone&&Pr.test(O))return n.each(function(te){var Z=n.eq(te);G&&(s[0]=O.call(this,te,Z.html())),wt(Z,s,l,d)});if(A&&(p=yn(s,n[0].ownerDocument,!1,n,d),m=p.firstChild,p.childNodes.length===1&&(p=m),m||d)){for(b=h.map(ve(p,"script"),Ir),x=b.length;P<A;P++)k=p,P!==L&&(k=h.clone(k,!0,!0),x&&h.merge(b,ve(k,"script"))),l.call(n[P],k,P);if(x)for(E=b[b.length-1].ownerDocument,h.map(b,Ar),P=0;P<x;P++)k=b[P],bn.test(k.type||"")&&!z.access(k,"globalEval")&&h.contains(E,k)&&(k.src&&(k.type||"").toLowerCase()!=="module"?h._evalUrl&&!k.noModule&&h._evalUrl(k.src,{nonce:k.nonce||k.getAttribute("nonce")},E):ye(k.textContent.replace(Mr,""),k,E))}return n}function xn(n,s,l){for(var d,p=s?h.filter(s,n):n,m=0;(d=p[m])!=null;m++)!l&&d.nodeType===1&&h.cleanData(ve(d)),d.parentNode&&(l&&mt(d)&&Ci(ve(d,"script")),d.parentNode.removeChild(d));return n}h.extend({htmlPrefilter:function(n){return n},clone:function(n,s,l){var d,p,m,b,x=n.cloneNode(!0),k=mt(n);if(!N.noCloneChecked&&(n.nodeType===1||n.nodeType===11)&&!h.isXMLDoc(n))for(b=ve(x),m=ve(n),d=0,p=m.length;d<p;d++)Or(m[d],b[d]);if(s)if(l)for(m=m||ve(n),b=b||ve(x),d=0,p=m.length;d<p;d++)kn(m[d],b[d]);else kn(n,x);return b=ve(x,"script"),b.length>0&&Ci(b,!k&&ve(n,"script")),x},cleanData:function(n){for(var s,l,d,p=h.event.special,m=0;(l=n[m])!==void 0;m++)if(Mt(l)){if(s=l[z.expando]){if(s.events)for(d in s.events)p[d]?h.event.remove(l,d):h.removeEvent(l,d,s.handle);l[z.expando]=void 0}l[we.expando]&&(l[we.expando]=void 0)}}}),h.fn.extend({detach:function(n){return xn(this,n,!0)},remove:function(n){return xn(this,n)},text:function(n){return ze(this,function(s){return s===void 0?h.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=s)})},null,n,arguments.length)},append:function(){return wt(this,arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var s=vn(this,n);s.appendChild(n)}})},prepend:function(){return wt(this,arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var s=vn(this,n);s.insertBefore(n,s.firstChild)}})},before:function(){return wt(this,arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this)})},after:function(){return wt(this,arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling)})},empty:function(){for(var n,s=0;(n=this[s])!=null;s++)n.nodeType===1&&(h.cleanData(ve(n,!1)),n.textContent="");return this},clone:function(n,s){return n=n??!1,s=s??n,this.map(function(){return h.clone(this,n,s)})},html:function(n){return ze(this,function(s){var l=this[0]||{},d=0,p=this.length;if(s===void 0&&l.nodeType===1)return l.innerHTML;if(typeof s=="string"&&!_r.test(s)&&!Te[(gn.exec(s)||["",""])[1].toLowerCase()]){s=h.htmlPrefilter(s);try{for(;d<p;d++)l=this[d]||{},l.nodeType===1&&(h.cleanData(ve(l,!1)),l.innerHTML=s);l=0}catch{}}l&&this.empty().append(s)},null,n,arguments.length)},replaceWith:function(){var n=[];return wt(this,arguments,function(s){var l=this.parentNode;h.inArray(this,n)<0&&(h.cleanData(ve(this)),l&&l.replaceChild(s,this))},n)}}),h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,s){h.fn[n]=function(l){for(var d,p=[],m=h(l),b=m.length-1,x=0;x<=b;x++)d=x===b?this:this.clone(!0),h(m[x])[s](d),f.apply(p,d.get());return this.pushStack(p)}});var Ei=new RegExp("^("+fn+")(?!px)[a-z%]+$","i"),Ti=/^--/,ii=function(n){var s=n.ownerDocument.defaultView;return(!s||!s.opener)&&(s=e),s.getComputedStyle(n)},Cn=function(n,s,l){var d,p,m={};for(p in s)m[p]=n.style[p],n.style[p]=s[p];d=l.call(n);for(p in s)n.style[p]=m[p];return d},$r=new RegExp(Ue.join("|"),"i");(function(){function n(){if(E){k.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",E.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",rt.appendChild(k).appendChild(E);var P=e.getComputedStyle(E);l=P.top!=="1%",x=s(P.marginLeft)===12,E.style.right="60%",m=s(P.right)===36,d=s(P.width)===36,E.style.position="absolute",p=s(E.offsetWidth/3)===12,rt.removeChild(k),E=null}}function s(P){return Math.round(parseFloat(P))}var l,d,p,m,b,x,k=F.createElement("div"),E=F.createElement("div");E.style&&(E.style.backgroundClip="content-box",E.cloneNode(!0).style.backgroundClip="",N.clearCloneStyle=E.style.backgroundClip==="content-box",h.extend(N,{boxSizingReliable:function(){return n(),d},pixelBoxStyles:function(){return n(),m},pixelPosition:function(){return n(),l},reliableMarginLeft:function(){return n(),x},scrollboxSize:function(){return n(),p},reliableTrDimensions:function(){var P,A,L,O;return b==null&&(P=F.createElement("table"),A=F.createElement("tr"),L=F.createElement("div"),P.style.cssText="position:absolute;left:-11111px;border-collapse:separate",A.style.cssText="box-sizing:content-box;border:1px solid",A.style.height="1px",L.style.height="9px",L.style.display="block",rt.appendChild(P).appendChild(A).appendChild(L),O=e.getComputedStyle(A),b=parseInt(O.height,10)+parseInt(O.borderTopWidth,10)+parseInt(O.borderBottomWidth,10)===A.offsetHeight,rt.removeChild(P)),b}}))})();function $t(n,s,l){var d,p,m,b,x=Ti.test(s),k=n.style;return l=l||ii(n),l&&(b=l.getPropertyValue(s)||l[s],x&&b&&(b=b.replace(Pt,"$1")||void 0),b===""&&!mt(n)&&(b=h.style(n,s)),!N.pixelBoxStyles()&&Ei.test(b)&&$r.test(s)&&(d=k.width,p=k.minWidth,m=k.maxWidth,k.minWidth=k.maxWidth=k.width=b,b=l.width,k.width=d,k.minWidth=p,k.maxWidth=m)),b!==void 0?b+"":b}function Sn(n,s){return{get:function(){if(n()){delete this.get;return}return(this.get=s).apply(this,arguments)}}}var En=["Webkit","Moz","ms"],Tn=F.createElement("div").style,jn={};function Nr(n){for(var s=n[0].toUpperCase()+n.slice(1),l=En.length;l--;)if(n=En[l]+s,n in Tn)return n}function ji(n){var s=h.cssProps[n]||jn[n];return s||(n in Tn?n:jn[n]=Nr(n)||n)}var Br=/^(none|table(?!-c[ea]).+)/,Fr={position:"absolute",visibility:"hidden",display:"block"},Dn={letterSpacing:"0",fontWeight:"400"};function Ln(n,s,l){var d=At.exec(s);return d?Math.max(0,d[2]-(l||0))+(d[3]||"px"):s}function Di(n,s,l,d,p,m){var b=s==="width"?1:0,x=0,k=0,E=0;if(l===(d?"border":"content"))return 0;for(;b<4;b+=2)l==="margin"&&(E+=h.css(n,l+Ue[b],!0,p)),d?(l==="content"&&(k-=h.css(n,"padding"+Ue[b],!0,p)),l!=="margin"&&(k-=h.css(n,"border"+Ue[b]+"Width",!0,p))):(k+=h.css(n,"padding"+Ue[b],!0,p),l!=="padding"?k+=h.css(n,"border"+Ue[b]+"Width",!0,p):x+=h.css(n,"border"+Ue[b]+"Width",!0,p));return!d&&m>=0&&(k+=Math.max(0,Math.ceil(n["offset"+s[0].toUpperCase()+s.slice(1)]-m-k-x-.5))||0),k+E}function _n(n,s,l){var d=ii(n),p=!N.boxSizingReliable()||l,m=p&&h.css(n,"boxSizing",!1,d)==="border-box",b=m,x=$t(n,s,d),k="offset"+s[0].toUpperCase()+s.slice(1);if(Ei.test(x)){if(!l)return x;x="auto"}return(!N.boxSizingReliable()&&m||!N.reliableTrDimensions()&&oe(n,"tr")||x==="auto"||!parseFloat(x)&&h.css(n,"display",!1,d)==="inline")&&n.getClientRects().length&&(m=h.css(n,"boxSizing",!1,d)==="border-box",b=k in n,b&&(x=n[k])),x=parseFloat(x)||0,x+Di(n,s,l||(m?"border":"content"),b,d,x)+"px"}h.extend({cssHooks:{opacity:{get:function(n,s){if(s){var l=$t(n,"opacity");return l===""?"1":l}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(n,s,l,d){if(!(!n||n.nodeType===3||n.nodeType===8||!n.style)){var p,m,b,x=$e(s),k=Ti.test(s),E=n.style;if(k||(s=ji(x)),b=h.cssHooks[s]||h.cssHooks[x],l!==void 0){if(m=typeof l,m==="string"&&(p=At.exec(l))&&p[1]&&(l=pn(n,s,p),m="number"),l==null||l!==l)return;m==="number"&&!k&&(l+=p&&p[3]||(h.cssNumber[x]?"":"px")),!N.clearCloneStyle&&l===""&&s.indexOf("background")===0&&(E[s]="inherit"),(!b||!("set"in b)||(l=b.set(n,l,d))!==void 0)&&(k?E.setProperty(s,l):E[s]=l)}else return b&&"get"in b&&(p=b.get(n,!1,d))!==void 0?p:E[s]}},css:function(n,s,l,d){var p,m,b,x=$e(s),k=Ti.test(s);return k||(s=ji(x)),b=h.cssHooks[s]||h.cssHooks[x],b&&"get"in b&&(p=b.get(n,!0,l)),p===void 0&&(p=$t(n,s,d)),p==="normal"&&s in Dn&&(p=Dn[s]),l===""||l?(m=parseFloat(p),l===!0||isFinite(m)?m||0:p):p}}),h.each(["height","width"],function(n,s){h.cssHooks[s]={get:function(l,d,p){if(d)return Br.test(h.css(l,"display"))&&(!l.getClientRects().length||!l.getBoundingClientRect().width)?Cn(l,Fr,function(){return _n(l,s,p)}):_n(l,s,p)},set:function(l,d,p){var m,b=ii(l),x=!N.scrollboxSize()&&b.position==="absolute",k=x||p,E=k&&h.css(l,"boxSizing",!1,b)==="border-box",P=p?Di(l,s,p,E,b):0;return E&&x&&(P-=Math.ceil(l["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(b[s])-Di(l,s,"border",!1,b)-.5)),P&&(m=At.exec(d))&&(m[3]||"px")!=="px"&&(l.style[s]=d,d=h.css(l,s)),Ln(l,d,P)}}}),h.cssHooks.marginLeft=Sn(N.reliableMarginLeft,function(n,s){if(s)return(parseFloat($t(n,"marginLeft"))||n.getBoundingClientRect().left-Cn(n,{marginLeft:0},function(){return n.getBoundingClientRect().left}))+"px"}),h.each({margin:"",padding:"",border:"Width"},function(n,s){h.cssHooks[n+s]={expand:function(l){for(var d=0,p={},m=typeof l=="string"?l.split(" "):[l];d<4;d++)p[n+Ue[d]+s]=m[d]||m[d-2]||m[0];return p}},n!=="margin"&&(h.cssHooks[n+s].set=Ln)}),h.fn.extend({css:function(n,s){return ze(this,function(l,d,p){var m,b,x={},k=0;if(Array.isArray(d)){for(m=ii(l),b=d.length;k<b;k++)x[d[k]]=h.css(l,d[k],!1,m);return x}return p!==void 0?h.style(l,d,p):h.css(l,d)},n,s,arguments.length>1)}});function ke(n,s,l,d,p){return new ke.prototype.init(n,s,l,d,p)}h.Tween=ke,ke.prototype={constructor:ke,init:function(n,s,l,d,p,m){this.elem=n,this.prop=l,this.easing=p||h.easing._default,this.options=s,this.start=this.now=this.cur(),this.end=d,this.unit=m||(h.cssNumber[l]?"":"px")},cur:function(){var n=ke.propHooks[this.prop];return n&&n.get?n.get(this):ke.propHooks._default.get(this)},run:function(n){var s,l=ke.propHooks[this.prop];return this.options.duration?this.pos=s=h.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):this.pos=s=n,this.now=(this.end-this.start)*s+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),l&&l.set?l.set(this):ke.propHooks._default.set(this),this}},ke.prototype.init.prototype=ke.prototype,ke.propHooks={_default:{get:function(n){var s;return n.elem.nodeType!==1||n.elem[n.prop]!=null&&n.elem.style[n.prop]==null?n.elem[n.prop]:(s=h.css(n.elem,n.prop,""),!s||s==="auto"?0:s)},set:function(n){h.fx.step[n.prop]?h.fx.step[n.prop](n):n.elem.nodeType===1&&(h.cssHooks[n.prop]||n.elem.style[ji(n.prop)]!=null)?h.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}},ke.propHooks.scrollTop=ke.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}},h.easing={linear:function(n){return n},swing:function(n){return .5-Math.cos(n*Math.PI)/2},_default:"swing"},h.fx=ke.prototype.init,h.fx.step={};var vt,ni,Rr=/^(?:toggle|show|hide)$/,qr=/queueHooks$/;function Li(){ni&&(F.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Li):e.setTimeout(Li,h.fx.interval),h.fx.tick())}function Pn(){return e.setTimeout(function(){vt=void 0}),vt=Date.now()}function ri(n,s){var l,d=0,p={height:n};for(s=s?1:0;d<4;d+=2-s)l=Ue[d],p["margin"+l]=p["padding"+l]=n;return s&&(p.opacity=p.width=n),p}function Mn(n,s,l){for(var d,p=(Pe.tweeners[s]||[]).concat(Pe.tweeners["*"]),m=0,b=p.length;m<b;m++)if(d=p[m].call(l,s,n))return d}function Qr(n,s,l){var d,p,m,b,x,k,E,P,A="width"in s||"height"in s,L=this,O={},G=n.style,te=n.nodeType&&ei(n),Z=z.get(n,"fxshow");l.queue||(b=h._queueHooks(n,"fx"),b.unqueued==null&&(b.unqueued=0,x=b.empty.fire,b.empty.fire=function(){b.unqueued||x()}),b.unqueued++,L.always(function(){L.always(function(){b.unqueued--,h.queue(n,"fx").length||b.empty.fire()})}));for(d in s)if(p=s[d],Rr.test(p)){if(delete s[d],m=m||p==="toggle",p===(te?"hide":"show"))if(p==="show"&&Z&&Z[d]!==void 0)te=!0;else continue;O[d]=Z&&Z[d]||h.style(n,d)}if(k=!h.isEmptyObject(s),!(!k&&h.isEmptyObject(O))){A&&n.nodeType===1&&(l.overflow=[G.overflow,G.overflowX,G.overflowY],E=Z&&Z.display,E==null&&(E=z.get(n,"display")),P=h.css(n,"display"),P==="none"&&(E?P=E:(gt([n],!0),E=n.style.display||E,P=h.css(n,"display"),gt([n]))),(P==="inline"||P==="inline-block"&&E!=null)&&h.css(n,"float")==="none"&&(k||(L.done(function(){G.display=E}),E==null&&(P=G.display,E=P==="none"?"":P)),G.display="inline-block")),l.overflow&&(G.overflow="hidden",L.always(function(){G.overflow=l.overflow[0],G.overflowX=l.overflow[1],G.overflowY=l.overflow[2]})),k=!1;for(d in O)k||(Z?"hidden"in Z&&(te=Z.hidden):Z=z.access(n,"fxshow",{display:E}),m&&(Z.hidden=!te),te&&gt([n],!0),L.done(function(){te||gt([n]),z.remove(n,"fxshow");for(d in O)h.style(n,d,O[d])})),k=Mn(te?Z[d]:0,d,L),d in Z||(Z[d]=k.start,te&&(k.end=k.start,k.start=0))}}function Wr(n,s){var l,d,p,m,b;for(l in n)if(d=$e(l),p=s[d],m=n[l],Array.isArray(m)&&(p=m[1],m=n[l]=m[0]),l!==d&&(n[d]=m,delete n[l]),b=h.cssHooks[d],b&&"expand"in b){m=b.expand(m),delete n[d];for(l in m)l in n||(n[l]=m[l],s[l]=p)}else s[d]=p}function Pe(n,s,l){var d,p,m=0,b=Pe.prefilters.length,x=h.Deferred().always(function(){delete k.elem}),k=function(){if(p)return!1;for(var A=vt||Pn(),L=Math.max(0,E.startTime+E.duration-A),O=L/E.duration||0,G=1-O,te=0,Z=E.tweens.length;te<Z;te++)E.tweens[te].run(G);return x.notifyWith(n,[E,G,L]),G<1&&Z?L:(Z||x.notifyWith(n,[E,1,0]),x.resolveWith(n,[E]),!1)},E=x.promise({elem:n,props:h.extend({},s),opts:h.extend(!0,{specialEasing:{},easing:h.easing._default},l),originalProperties:s,originalOptions:l,startTime:vt||Pn(),duration:l.duration,tweens:[],createTween:function(A,L){var O=h.Tween(n,E.opts,A,L,E.opts.specialEasing[A]||E.opts.easing);return E.tweens.push(O),O},stop:function(A){var L=0,O=A?E.tweens.length:0;if(p)return this;for(p=!0;L<O;L++)E.tweens[L].run(1);return A?(x.notifyWith(n,[E,1,0]),x.resolveWith(n,[E,A])):x.rejectWith(n,[E,A]),this}}),P=E.props;for(Wr(P,E.opts.specialEasing);m<b;m++)if(d=Pe.prefilters[m].call(E,n,P,E.opts),d)return M(d.stop)&&(h._queueHooks(E.elem,E.opts.queue).stop=d.stop.bind(d)),d;return h.map(P,Mn,E),M(E.opts.start)&&E.opts.start.call(n,E),E.progress(E.opts.progress).done(E.opts.done,E.opts.complete).fail(E.opts.fail).always(E.opts.always),h.fx.timer(h.extend(k,{elem:n,anim:E,queue:E.opts.queue})),E}h.Animation=h.extend(Pe,{tweeners:{"*":[function(n,s){var l=this.createTween(n,s);return pn(l.elem,n,At.exec(s),l),l}]},tweener:function(n,s){M(n)?(s=n,n=["*"]):n=n.match(Oe);for(var l,d=0,p=n.length;d<p;d++)l=n[d],Pe.tweeners[l]=Pe.tweeners[l]||[],Pe.tweeners[l].unshift(s)},prefilters:[Qr],prefilter:function(n,s){s?Pe.prefilters.unshift(n):Pe.prefilters.push(n)}}),h.speed=function(n,s,l){var d=n&&typeof n=="object"?h.extend({},n):{complete:l||!l&&s||M(n)&&n,duration:n,easing:l&&s||s&&!M(s)&&s};return h.fx.off?d.duration=0:typeof d.duration!="number"&&(d.duration in h.fx.speeds?d.duration=h.fx.speeds[d.duration]:d.duration=h.fx.speeds._default),(d.queue==null||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){M(d.old)&&d.old.call(this),d.queue&&h.dequeue(this,d.queue)},d},h.fn.extend({fadeTo:function(n,s,l,d){return this.filter(ei).css("opacity",0).show().end().animate({opacity:s},n,l,d)},animate:function(n,s,l,d){var p=h.isEmptyObject(n),m=h.speed(s,l,d),b=function(){var x=Pe(this,h.extend({},n),m);(p||z.get(this,"finish"))&&x.stop(!0)};return b.finish=b,p||m.queue===!1?this.each(b):this.queue(m.queue,b)},stop:function(n,s,l){var d=function(p){var m=p.stop;delete p.stop,m(l)};return typeof n!="string"&&(l=s,s=n,n=void 0),s&&this.queue(n||"fx",[]),this.each(function(){var p=!0,m=n!=null&&n+"queueHooks",b=h.timers,x=z.get(this);if(m)x[m]&&x[m].stop&&d(x[m]);else for(m in x)x[m]&&x[m].stop&&qr.test(m)&&d(x[m]);for(m=b.length;m--;)b[m].elem===this&&(n==null||b[m].queue===n)&&(b[m].anim.stop(l),p=!1,b.splice(m,1));(p||!l)&&h.dequeue(this,n)})},finish:function(n){return n!==!1&&(n=n||"fx"),this.each(function(){var s,l=z.get(this),d=l[n+"queue"],p=l[n+"queueHooks"],m=h.timers,b=d?d.length:0;for(l.finish=!0,h.queue(this,n,[]),p&&p.stop&&p.stop.call(this,!0),s=m.length;s--;)m[s].elem===this&&m[s].queue===n&&(m[s].anim.stop(!0),m.splice(s,1));for(s=0;s<b;s++)d[s]&&d[s].finish&&d[s].finish.call(this);delete l.finish})}}),h.each(["toggle","show","hide"],function(n,s){var l=h.fn[s];h.fn[s]=function(d,p,m){return d==null||typeof d=="boolean"?l.apply(this,arguments):this.animate(ri(s,!0),d,p,m)}}),h.each({slideDown:ri("show"),slideUp:ri("hide"),slideToggle:ri("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,s){h.fn[n]=function(l,d,p){return this.animate(s,l,d,p)}}),h.timers=[],h.fx.tick=function(){var n,s=0,l=h.timers;for(vt=Date.now();s<l.length;s++)n=l[s],!n()&&l[s]===n&&l.splice(s--,1);l.length||h.fx.stop(),vt=void 0},h.fx.timer=function(n){h.timers.push(n),h.fx.start()},h.fx.interval=13,h.fx.start=function(){ni||(ni=!0,Li())},h.fx.stop=function(){ni=null},h.fx.speeds={slow:600,fast:200,_default:400},h.fn.delay=function(n,s){return n=h.fx&&h.fx.speeds[n]||n,s=s||"fx",this.queue(s,function(l,d){var p=e.setTimeout(l,n);d.stop=function(){e.clearTimeout(p)}})},function(){var n=F.createElement("input"),s=F.createElement("select"),l=s.appendChild(F.createElement("option"));n.type="checkbox",N.checkOn=n.value!=="",N.optSelected=l.selected,n=F.createElement("input"),n.value="t",n.type="radio",N.radioValue=n.value==="t"}();var In,Nt=h.expr.attrHandle;h.fn.extend({attr:function(n,s){return ze(this,h.attr,n,s,arguments.length>1)},removeAttr:function(n){return this.each(function(){h.removeAttr(this,n)})}}),h.extend({attr:function(n,s,l){var d,p,m=n.nodeType;if(!(m===3||m===8||m===2)){if(typeof n.getAttribute>"u")return h.prop(n,s,l);if((m!==1||!h.isXMLDoc(n))&&(p=h.attrHooks[s.toLowerCase()]||(h.expr.match.bool.test(s)?In:void 0)),l!==void 0){if(l===null){h.removeAttr(n,s);return}return p&&"set"in p&&(d=p.set(n,l,s))!==void 0?d:(n.setAttribute(s,l+""),l)}return p&&"get"in p&&(d=p.get(n,s))!==null?d:(d=h.find.attr(n,s),d??void 0)}},attrHooks:{type:{set:function(n,s){if(!N.radioValue&&s==="radio"&&oe(n,"input")){var l=n.value;return n.setAttribute("type",s),l&&(n.value=l),s}}}},removeAttr:function(n,s){var l,d=0,p=s&&s.match(Oe);if(p&&n.nodeType===1)for(;l=p[d++];)n.removeAttribute(l)}}),In={set:function(n,s,l){return s===!1?h.removeAttr(n,l):n.setAttribute(l,l),l}},h.each(h.expr.match.bool.source.match(/\w+/g),function(n,s){var l=Nt[s]||h.find.attr;Nt[s]=function(d,p,m){var b,x,k=p.toLowerCase();return m||(x=Nt[k],Nt[k]=b,b=l(d,p,m)!=null?k:null,Nt[k]=x),b}});var Hr=/^(?:input|select|textarea|button)$/i,zr=/^(?:a|area)$/i;h.fn.extend({prop:function(n,s){return ze(this,h.prop,n,s,arguments.length>1)},removeProp:function(n){return this.each(function(){delete this[h.propFix[n]||n]})}}),h.extend({prop:function(n,s,l){var d,p,m=n.nodeType;if(!(m===3||m===8||m===2))return(m!==1||!h.isXMLDoc(n))&&(s=h.propFix[s]||s,p=h.propHooks[s]),l!==void 0?p&&"set"in p&&(d=p.set(n,l,s))!==void 0?d:n[s]=l:p&&"get"in p&&(d=p.get(n,s))!==null?d:n[s]},propHooks:{tabIndex:{get:function(n){var s=h.find.attr(n,"tabindex");return s?parseInt(s,10):Hr.test(n.nodeName)||zr.test(n.nodeName)&&n.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),N.optSelected||(h.propHooks.selected={get:function(n){var s=n.parentNode;return s&&s.parentNode&&s.parentNode.selectedIndex,null},set:function(n){var s=n.parentNode;s&&(s.selectedIndex,s.parentNode&&s.parentNode.selectedIndex)}}),h.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){h.propFix[this.toLowerCase()]=this});function st(n){var s=n.match(Oe)||[];return s.join(" ")}function ot(n){return n.getAttribute&&n.getAttribute("class")||""}function _i(n){return Array.isArray(n)?n:typeof n=="string"?n.match(Oe)||[]:[]}h.fn.extend({addClass:function(n){var s,l,d,p,m,b;return M(n)?this.each(function(x){h(this).addClass(n.call(this,x,ot(this)))}):(s=_i(n),s.length?this.each(function(){if(d=ot(this),l=this.nodeType===1&&" "+st(d)+" ",l){for(m=0;m<s.length;m++)p=s[m],l.indexOf(" "+p+" ")<0&&(l+=p+" ");b=st(l),d!==b&&this.setAttribute("class",b)}}):this)},removeClass:function(n){var s,l,d,p,m,b;return M(n)?this.each(function(x){h(this).removeClass(n.call(this,x,ot(this)))}):arguments.length?(s=_i(n),s.length?this.each(function(){if(d=ot(this),l=this.nodeType===1&&" "+st(d)+" ",l){for(m=0;m<s.length;m++)for(p=s[m];l.indexOf(" "+p+" ")>-1;)l=l.replace(" "+p+" "," ");b=st(l),d!==b&&this.setAttribute("class",b)}}):this):this.attr("class","")},toggleClass:function(n,s){var l,d,p,m,b=typeof n,x=b==="string"||Array.isArray(n);return M(n)?this.each(function(k){h(this).toggleClass(n.call(this,k,ot(this),s),s)}):typeof s=="boolean"&&x?s?this.addClass(n):this.removeClass(n):(l=_i(n),this.each(function(){if(x)for(m=h(this),p=0;p<l.length;p++)d=l[p],m.hasClass(d)?m.removeClass(d):m.addClass(d);else(n===void 0||b==="boolean")&&(d=ot(this),d&&z.set(this,"__className__",d),this.setAttribute&&this.setAttribute("class",d||n===!1?"":z.get(this,"__className__")||""))}))},hasClass:function(n){var s,l,d=0;for(s=" "+n+" ";l=this[d++];)if(l.nodeType===1&&(" "+st(ot(l))+" ").indexOf(s)>-1)return!0;return!1}});var Ur=/\r/g;h.fn.extend({val:function(n){var s,l,d,p=this[0];return arguments.length?(d=M(n),this.each(function(m){var b;this.nodeType===1&&(d?b=n.call(this,m,h(this).val()):b=n,b==null?b="":typeof b=="number"?b+="":Array.isArray(b)&&(b=h.map(b,function(x){return x==null?"":x+""})),s=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()],(!s||!("set"in s)||s.set(this,b,"value")===void 0)&&(this.value=b))})):p?(s=h.valHooks[p.type]||h.valHooks[p.nodeName.toLowerCase()],s&&"get"in s&&(l=s.get(p,"value"))!==void 0?l:(l=p.value,typeof l=="string"?l.replace(Ur,""):l??"")):void 0}}),h.extend({valHooks:{option:{get:function(n){var s=h.find.attr(n,"value");return s??st(h.text(n))}},select:{get:function(n){var s,l,d,p=n.options,m=n.selectedIndex,b=n.type==="select-one",x=b?null:[],k=b?m+1:p.length;for(m<0?d=k:d=b?m:0;d<k;d++)if(l=p[d],(l.selected||d===m)&&!l.disabled&&(!l.parentNode.disabled||!oe(l.parentNode,"optgroup"))){if(s=h(l).val(),b)return s;x.push(s)}return x},set:function(n,s){for(var l,d,p=n.options,m=h.makeArray(s),b=p.length;b--;)d=p[b],(d.selected=h.inArray(h.valHooks.option.get(d),m)>-1)&&(l=!0);return l||(n.selectedIndex=-1),m}}}}),h.each(["radio","checkbox"],function(){h.valHooks[this]={set:function(n,s){if(Array.isArray(s))return n.checked=h.inArray(h(n).val(),s)>-1}},N.checkOn||(h.valHooks[this].get=function(n){return n.getAttribute("value")===null?"on":n.value})});var Bt=e.location,An={guid:Date.now()},Pi=/\?/;h.parseXML=function(n){var s,l;if(!n||typeof n!="string")return null;try{s=new e.DOMParser().parseFromString(n,"text/xml")}catch{}return l=s&&s.getElementsByTagName("parsererror")[0],(!s||l)&&h.error("Invalid XML: "+(l?h.map(l.childNodes,function(d){return d.textContent}).join(`
`):n)),s};var On=/^(?:focusinfocus|focusoutblur)$/,$n=function(n){n.stopPropagation()};h.extend(h.event,{trigger:function(n,s,l,d){var p,m,b,x,k,E,P,A,L=[l||F],O=T.call(n,"type")?n.type:n,G=T.call(n,"namespace")?n.namespace.split("."):[];if(m=A=b=l=l||F,!(l.nodeType===3||l.nodeType===8)&&!On.test(O+h.event.triggered)&&(O.indexOf(".")>-1&&(G=O.split("."),O=G.shift(),G.sort()),k=O.indexOf(":")<0&&"on"+O,n=n[h.expando]?n:new h.Event(O,typeof n=="object"&&n),n.isTrigger=d?2:3,n.namespace=G.join("."),n.rnamespace=n.namespace?new RegExp("(^|\\.)"+G.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=void 0,n.target||(n.target=l),s=s==null?[n]:h.makeArray(s,[n]),P=h.event.special[O]||{},!(!d&&P.trigger&&P.trigger.apply(l,s)===!1))){if(!d&&!P.noBubble&&!H(l)){for(x=P.delegateType||O,On.test(x+O)||(m=m.parentNode);m;m=m.parentNode)L.push(m),b=m;b===(l.ownerDocument||F)&&L.push(b.defaultView||b.parentWindow||e)}for(p=0;(m=L[p++])&&!n.isPropagationStopped();)A=m,n.type=p>1?x:P.bindType||O,E=(z.get(m,"events")||Object.create(null))[n.type]&&z.get(m,"handle"),E&&E.apply(m,s),E=k&&m[k],E&&E.apply&&Mt(m)&&(n.result=E.apply(m,s),n.result===!1&&n.preventDefault());return n.type=O,!d&&!n.isDefaultPrevented()&&(!P._default||P._default.apply(L.pop(),s)===!1)&&Mt(l)&&k&&M(l[O])&&!H(l)&&(b=l[k],b&&(l[k]=null),h.event.triggered=O,n.isPropagationStopped()&&A.addEventListener(O,$n),l[O](),n.isPropagationStopped()&&A.removeEventListener(O,$n),h.event.triggered=void 0,b&&(l[k]=b)),n.result}},simulate:function(n,s,l){var d=h.extend(new h.Event,l,{type:n,isSimulated:!0});h.event.trigger(d,null,s)}}),h.fn.extend({trigger:function(n,s){return this.each(function(){h.event.trigger(n,s,this)})},triggerHandler:function(n,s){var l=this[0];if(l)return h.event.trigger(n,s,l,!0)}});var Vr=/\[\]$/,Nn=/\r?\n/g,Kr=/^(?:submit|button|image|reset|file)$/i,Gr=/^(?:input|select|textarea|keygen)/i;function Mi(n,s,l,d){var p;if(Array.isArray(s))h.each(s,function(m,b){l||Vr.test(n)?d(n,b):Mi(n+"["+(typeof b=="object"&&b!=null?m:"")+"]",b,l,d)});else if(!l&&de(s)==="object")for(p in s)Mi(n+"["+p+"]",s[p],l,d);else d(n,s)}h.param=function(n,s){var l,d=[],p=function(m,b){var x=M(b)?b():b;d[d.length]=encodeURIComponent(m)+"="+encodeURIComponent(x??"")};if(n==null)return"";if(Array.isArray(n)||n.jquery&&!h.isPlainObject(n))h.each(n,function(){p(this.name,this.value)});else for(l in n)Mi(l,n[l],s,p);return d.join("&")},h.fn.extend({serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var n=h.prop(this,"elements");return n?h.makeArray(n):this}).filter(function(){var n=this.type;return this.name&&!h(this).is(":disabled")&&Gr.test(this.nodeName)&&!Kr.test(n)&&(this.checked||!Ot.test(n))}).map(function(n,s){var l=h(this).val();return l==null?null:Array.isArray(l)?h.map(l,function(d){return{name:s.name,value:d.replace(Nn,`\r
`)}}):{name:s.name,value:l.replace(Nn,`\r
`)}}).get()}});var Xr=/%20/g,Zr=/#.*$/,Yr=/([?&])_=[^&]*/,Jr=/^(.*?):[ \t]*([^\r\n]*)$/mg,es=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ts=/^(?:GET|HEAD)$/,is=/^\/\//,Bn={},Ii={},Fn="*/".concat("*"),Ai=F.createElement("a");Ai.href=Bt.href;function Rn(n){return function(s,l){typeof s!="string"&&(l=s,s="*");var d,p=0,m=s.toLowerCase().match(Oe)||[];if(M(l))for(;d=m[p++];)d[0]==="+"?(d=d.slice(1)||"*",(n[d]=n[d]||[]).unshift(l)):(n[d]=n[d]||[]).push(l)}}function qn(n,s,l,d){var p={},m=n===Ii;function b(x){var k;return p[x]=!0,h.each(n[x]||[],function(E,P){var A=P(s,l,d);if(typeof A=="string"&&!m&&!p[A])return s.dataTypes.unshift(A),b(A),!1;if(m)return!(k=A)}),k}return b(s.dataTypes[0])||!p["*"]&&b("*")}function Oi(n,s){var l,d,p=h.ajaxSettings.flatOptions||{};for(l in s)s[l]!==void 0&&((p[l]?n:d||(d={}))[l]=s[l]);return d&&h.extend(!0,n,d),n}function ns(n,s,l){for(var d,p,m,b,x=n.contents,k=n.dataTypes;k[0]==="*";)k.shift(),d===void 0&&(d=n.mimeType||s.getResponseHeader("Content-Type"));if(d){for(p in x)if(x[p]&&x[p].test(d)){k.unshift(p);break}}if(k[0]in l)m=k[0];else{for(p in l){if(!k[0]||n.converters[p+" "+k[0]]){m=p;break}b||(b=p)}m=m||b}if(m)return m!==k[0]&&k.unshift(m),l[m]}function rs(n,s,l,d){var p,m,b,x,k,E={},P=n.dataTypes.slice();if(P[1])for(b in n.converters)E[b.toLowerCase()]=n.converters[b];for(m=P.shift();m;)if(n.responseFields[m]&&(l[n.responseFields[m]]=s),!k&&d&&n.dataFilter&&(s=n.dataFilter(s,n.dataType)),k=m,m=P.shift(),m){if(m==="*")m=k;else if(k!=="*"&&k!==m){if(b=E[k+" "+m]||E["* "+m],!b){for(p in E)if(x=p.split(" "),x[1]===m&&(b=E[k+" "+x[0]]||E["* "+x[0]],b)){b===!0?b=E[p]:E[p]!==!0&&(m=x[0],P.unshift(x[1]));break}}if(b!==!0)if(b&&n.throws)s=b(s);else try{s=b(s)}catch(A){return{state:"parsererror",error:b?A:"No conversion from "+k+" to "+m}}}}return{state:"success",data:s}}h.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Bt.href,type:"GET",isLocal:es.test(Bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Fn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":h.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(n,s){return s?Oi(Oi(n,h.ajaxSettings),s):Oi(h.ajaxSettings,n)},ajaxPrefilter:Rn(Bn),ajaxTransport:Rn(Ii),ajax:function(n,s){typeof n=="object"&&(s=n,n=void 0),s=s||{};var l,d,p,m,b,x,k,E,P,A,L=h.ajaxSetup({},s),O=L.context||L,G=L.context&&(O.nodeType||O.jquery)?h(O):h.event,te=h.Deferred(),Z=h.Callbacks("once memory"),pe=L.statusCode||{},ce={},Ne={},Be="canceled",ee={readyState:0,getResponseHeader:function(ie){var le;if(k){if(!m)for(m={};le=Jr.exec(p);)m[le[1].toLowerCase()+" "]=(m[le[1].toLowerCase()+" "]||[]).concat(le[2]);le=m[ie.toLowerCase()+" "]}return le==null?null:le.join(", ")},getAllResponseHeaders:function(){return k?p:null},setRequestHeader:function(ie,le){return k==null&&(ie=Ne[ie.toLowerCase()]=Ne[ie.toLowerCase()]||ie,ce[ie]=le),this},overrideMimeType:function(ie){return k==null&&(L.mimeType=ie),this},statusCode:function(ie){var le;if(ie)if(k)ee.always(ie[ee.status]);else for(le in ie)pe[le]=[pe[le],ie[le]];return this},abort:function(ie){var le=ie||Be;return l&&l.abort(le),at(0,le),this}};if(te.promise(ee),L.url=((n||L.url||Bt.href)+"").replace(is,Bt.protocol+"//"),L.type=s.method||s.type||L.method||L.type,L.dataTypes=(L.dataType||"*").toLowerCase().match(Oe)||[""],L.crossDomain==null){x=F.createElement("a");try{x.href=L.url,x.href=x.href,L.crossDomain=Ai.protocol+"//"+Ai.host!=x.protocol+"//"+x.host}catch{L.crossDomain=!0}}if(L.data&&L.processData&&typeof L.data!="string"&&(L.data=h.param(L.data,L.traditional)),qn(Bn,L,s,ee),k)return ee;E=h.event&&L.global,E&&h.active++===0&&h.event.trigger("ajaxStart"),L.type=L.type.toUpperCase(),L.hasContent=!ts.test(L.type),d=L.url.replace(Zr,""),L.hasContent?L.data&&L.processData&&(L.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(L.data=L.data.replace(Xr,"+")):(A=L.url.slice(d.length),L.data&&(L.processData||typeof L.data=="string")&&(d+=(Pi.test(d)?"&":"?")+L.data,delete L.data),L.cache===!1&&(d=d.replace(Yr,"$1"),A=(Pi.test(d)?"&":"?")+"_="+An.guid+++A),L.url=d+A),L.ifModified&&(h.lastModified[d]&&ee.setRequestHeader("If-Modified-Since",h.lastModified[d]),h.etag[d]&&ee.setRequestHeader("If-None-Match",h.etag[d])),(L.data&&L.hasContent&&L.contentType!==!1||s.contentType)&&ee.setRequestHeader("Content-Type",L.contentType),ee.setRequestHeader("Accept",L.dataTypes[0]&&L.accepts[L.dataTypes[0]]?L.accepts[L.dataTypes[0]]+(L.dataTypes[0]!=="*"?", "+Fn+"; q=0.01":""):L.accepts["*"]);for(P in L.headers)ee.setRequestHeader(P,L.headers[P]);if(L.beforeSend&&(L.beforeSend.call(O,ee,L)===!1||k))return ee.abort();if(Be="abort",Z.add(L.complete),ee.done(L.success),ee.fail(L.error),l=qn(Ii,L,s,ee),!l)at(-1,"No Transport");else{if(ee.readyState=1,E&&G.trigger("ajaxSend",[ee,L]),k)return ee;L.async&&L.timeout>0&&(b=e.setTimeout(function(){ee.abort("timeout")},L.timeout));try{k=!1,l.send(ce,at)}catch(ie){if(k)throw ie;at(-1,ie)}}function at(ie,le,Rt,Ni){var Fe,qt,Re,Je,et,je=le;k||(k=!0,b&&e.clearTimeout(b),l=void 0,p=Ni||"",ee.readyState=ie>0?4:0,Fe=ie>=200&&ie<300||ie===304,Rt&&(Je=ns(L,ee,Rt)),!Fe&&h.inArray("script",L.dataTypes)>-1&&h.inArray("json",L.dataTypes)<0&&(L.converters["text script"]=function(){}),Je=rs(L,Je,ee,Fe),Fe?(L.ifModified&&(et=ee.getResponseHeader("Last-Modified"),et&&(h.lastModified[d]=et),et=ee.getResponseHeader("etag"),et&&(h.etag[d]=et)),ie===204||L.type==="HEAD"?je="nocontent":ie===304?je="notmodified":(je=Je.state,qt=Je.data,Re=Je.error,Fe=!Re)):(Re=je,(ie||!je)&&(je="error",ie<0&&(ie=0))),ee.status=ie,ee.statusText=(le||je)+"",Fe?te.resolveWith(O,[qt,je,ee]):te.rejectWith(O,[ee,je,Re]),ee.statusCode(pe),pe=void 0,E&&G.trigger(Fe?"ajaxSuccess":"ajaxError",[ee,L,Fe?qt:Re]),Z.fireWith(O,[ee,je]),E&&(G.trigger("ajaxComplete",[ee,L]),--h.active||h.event.trigger("ajaxStop")))}return ee},getJSON:function(n,s,l){return h.get(n,s,l,"json")},getScript:function(n,s){return h.get(n,void 0,s,"script")}}),h.each(["get","post"],function(n,s){h[s]=function(l,d,p,m){return M(d)&&(m=m||p,p=d,d=void 0),h.ajax(h.extend({url:l,type:s,dataType:m,data:d,success:p},h.isPlainObject(l)&&l))}}),h.ajaxPrefilter(function(n){var s;for(s in n.headers)s.toLowerCase()==="content-type"&&(n.contentType=n.headers[s]||"")}),h._evalUrl=function(n,s,l){return h.ajax({url:n,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(d){h.globalEval(d,s,l)}})},h.fn.extend({wrapAll:function(n){var s;return this[0]&&(M(n)&&(n=n.call(this[0])),s=h(n,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&s.insertBefore(this[0]),s.map(function(){for(var l=this;l.firstElementChild;)l=l.firstElementChild;return l}).append(this)),this},wrapInner:function(n){return M(n)?this.each(function(s){h(this).wrapInner(n.call(this,s))}):this.each(function(){var s=h(this),l=s.contents();l.length?l.wrapAll(n):s.append(n)})},wrap:function(n){var s=M(n);return this.each(function(l){h(this).wrapAll(s?n.call(this,l):n)})},unwrap:function(n){return this.parent(n).not("body").each(function(){h(this).replaceWith(this.childNodes)}),this}}),h.expr.pseudos.hidden=function(n){return!h.expr.pseudos.visible(n)},h.expr.pseudos.visible=function(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)},h.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var ss={0:200,1223:204},Ft=h.ajaxSettings.xhr();N.cors=!!Ft&&"withCredentials"in Ft,N.ajax=Ft=!!Ft,h.ajaxTransport(function(n){var s,l;if(N.cors||Ft&&!n.crossDomain)return{send:function(d,p){var m,b=n.xhr();if(b.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(m in n.xhrFields)b[m]=n.xhrFields[m];n.mimeType&&b.overrideMimeType&&b.overrideMimeType(n.mimeType),!n.crossDomain&&!d["X-Requested-With"]&&(d["X-Requested-With"]="XMLHttpRequest");for(m in d)b.setRequestHeader(m,d[m]);s=function(x){return function(){s&&(s=l=b.onload=b.onerror=b.onabort=b.ontimeout=b.onreadystatechange=null,x==="abort"?b.abort():x==="error"?typeof b.status!="number"?p(0,"error"):p(b.status,b.statusText):p(ss[b.status]||b.status,b.statusText,(b.responseType||"text")!=="text"||typeof b.responseText!="string"?{binary:b.response}:{text:b.responseText},b.getAllResponseHeaders()))}},b.onload=s(),l=b.onerror=b.ontimeout=s("error"),b.onabort!==void 0?b.onabort=l:b.onreadystatechange=function(){b.readyState===4&&e.setTimeout(function(){s&&l()})},s=s("abort");try{b.send(n.hasContent&&n.data||null)}catch(x){if(s)throw x}},abort:function(){s&&s()}}}),h.ajaxPrefilter(function(n){n.crossDomain&&(n.contents.script=!1)}),h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(n){return h.globalEval(n),n}}}),h.ajaxPrefilter("script",function(n){n.cache===void 0&&(n.cache=!1),n.crossDomain&&(n.type="GET")}),h.ajaxTransport("script",function(n){if(n.crossDomain||n.scriptAttrs){var s,l;return{send:function(d,p){s=h("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",l=function(m){s.remove(),l=null,m&&p(m.type==="error"?404:200,m.type)}),F.head.appendChild(s[0])},abort:function(){l&&l()}}}});var Qn=[],$i=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=Qn.pop()||h.expando+"_"+An.guid++;return this[n]=!0,n}}),h.ajaxPrefilter("json jsonp",function(n,s,l){var d,p,m,b=n.jsonp!==!1&&($i.test(n.url)?"url":typeof n.data=="string"&&(n.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&$i.test(n.data)&&"data");if(b||n.dataTypes[0]==="jsonp")return d=n.jsonpCallback=M(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,b?n[b]=n[b].replace($i,"$1"+d):n.jsonp!==!1&&(n.url+=(Pi.test(n.url)?"&":"?")+n.jsonp+"="+d),n.converters["script json"]=function(){return m||h.error(d+" was not called"),m[0]},n.dataTypes[0]="json",p=e[d],e[d]=function(){m=arguments},l.always(function(){p===void 0?h(e).removeProp(d):e[d]=p,n[d]&&(n.jsonpCallback=s.jsonpCallback,Qn.push(d)),m&&M(p)&&p(m[0]),m=p=void 0}),"script"}),N.createHTMLDocument=function(){var n=F.implementation.createHTMLDocument("").body;return n.innerHTML="<form></form><form></form>",n.childNodes.length===2}(),h.parseHTML=function(n,s,l){if(typeof n!="string")return[];typeof s=="boolean"&&(l=s,s=!1);var d,p,m;return s||(N.createHTMLDocument?(s=F.implementation.createHTMLDocument(""),d=s.createElement("base"),d.href=F.location.href,s.head.appendChild(d)):s=F),p=ln.exec(n),m=!l&&[],p?[s.createElement(p[1])]:(p=yn([n],s,m),m&&m.length&&h(m).remove(),h.merge([],p.childNodes))},h.fn.load=function(n,s,l){var d,p,m,b=this,x=n.indexOf(" ");return x>-1&&(d=st(n.slice(x)),n=n.slice(0,x)),M(s)?(l=s,s=void 0):s&&typeof s=="object"&&(p="POST"),b.length>0&&h.ajax({url:n,type:p||"GET",dataType:"html",data:s}).done(function(k){m=arguments,b.html(d?h("<div>").append(h.parseHTML(k)).find(d):k)}).always(l&&function(k,E){b.each(function(){l.apply(this,m||[k.responseText,E,k])})}),this},h.expr.pseudos.animated=function(n){return h.grep(h.timers,function(s){return n===s.elem}).length},h.offset={setOffset:function(n,s,l){var d,p,m,b,x,k,E,P=h.css(n,"position"),A=h(n),L={};P==="static"&&(n.style.position="relative"),x=A.offset(),m=h.css(n,"top"),k=h.css(n,"left"),E=(P==="absolute"||P==="fixed")&&(m+k).indexOf("auto")>-1,E?(d=A.position(),b=d.top,p=d.left):(b=parseFloat(m)||0,p=parseFloat(k)||0),M(s)&&(s=s.call(n,l,h.extend({},x))),s.top!=null&&(L.top=s.top-x.top+b),s.left!=null&&(L.left=s.left-x.left+p),"using"in s?s.using.call(n,L):A.css(L)}},h.fn.extend({offset:function(n){if(arguments.length)return n===void 0?this:this.each(function(p){h.offset.setOffset(this,n,p)});var s,l,d=this[0];if(d)return d.getClientRects().length?(s=d.getBoundingClientRect(),l=d.ownerDocument.defaultView,{top:s.top+l.pageYOffset,left:s.left+l.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var n,s,l,d=this[0],p={top:0,left:0};if(h.css(d,"position")==="fixed")s=d.getBoundingClientRect();else{for(s=this.offset(),l=d.ownerDocument,n=d.offsetParent||l.documentElement;n&&(n===l.body||n===l.documentElement)&&h.css(n,"position")==="static";)n=n.parentNode;n&&n!==d&&n.nodeType===1&&(p=h(n).offset(),p.top+=h.css(n,"borderTopWidth",!0),p.left+=h.css(n,"borderLeftWidth",!0))}return{top:s.top-p.top-h.css(d,"marginTop",!0),left:s.left-p.left-h.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent;n&&h.css(n,"position")==="static";)n=n.offsetParent;return n||rt})}}),h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,s){var l=s==="pageYOffset";h.fn[n]=function(d){return ze(this,function(p,m,b){var x;if(H(p)?x=p:p.nodeType===9&&(x=p.defaultView),b===void 0)return x?x[s]:p[m];x?x.scrollTo(l?x.pageXOffset:b,l?b:x.pageYOffset):p[m]=b},n,d,arguments.length)}}),h.each(["top","left"],function(n,s){h.cssHooks[s]=Sn(N.pixelPosition,function(l,d){if(d)return d=$t(l,s),Ei.test(d)?h(l).position()[s]+"px":d})}),h.each({Height:"height",Width:"width"},function(n,s){h.each({padding:"inner"+n,content:s,"":"outer"+n},function(l,d){h.fn[d]=function(p,m){var b=arguments.length&&(l||typeof p!="boolean"),x=l||(p===!0||m===!0?"margin":"border");return ze(this,function(k,E,P){var A;return H(k)?d.indexOf("outer")===0?k["inner"+n]:k.document.documentElement["client"+n]:k.nodeType===9?(A=k.documentElement,Math.max(k.body["scroll"+n],A["scroll"+n],k.body["offset"+n],A["offset"+n],A["client"+n])):P===void 0?h.css(k,E,x):h.style(k,E,P,x)},s,b?p:void 0,b)}})}),h.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(n,s){h.fn[s]=function(l){return this.on(s,l)}}),h.fn.extend({bind:function(n,s,l){return this.on(n,null,s,l)},unbind:function(n,s){return this.off(n,null,s)},delegate:function(n,s,l,d){return this.on(s,n,l,d)},undelegate:function(n,s,l){return arguments.length===1?this.off(n,"**"):this.off(s,n||"**",l)},hover:function(n,s){return this.on("mouseenter",n).on("mouseleave",s||n)}}),h.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(n,s){h.fn[s]=function(l,d){return arguments.length>0?this.on(s,null,l,d):this.trigger(s)}});var os=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;h.proxy=function(n,s){var l,d,p;if(typeof s=="string"&&(l=n[s],s=n,n=l),!!M(n))return d=o.call(arguments,2),p=function(){return n.apply(s||this,d.concat(o.call(arguments)))},p.guid=n.guid=n.guid||h.guid++,p},h.holdReady=function(n){n?h.readyWait++:h.ready(!0)},h.isArray=Array.isArray,h.parseJSON=JSON.parse,h.nodeName=oe,h.isFunction=M,h.isWindow=H,h.camelCase=$e,h.type=de,h.now=Date.now,h.isNumeric=function(n){var s=h.type(n);return(s==="number"||s==="string")&&!isNaN(n-parseFloat(n))},h.trim=function(n){return n==null?"":(n+"").replace(os,"$1")};var as=e.jQuery,ls=e.$;return h.noConflict=function(n){return e.$===h&&(e.$=ls),n&&e.jQuery===h&&(e.jQuery=as),h},typeof t>"u"&&(e.jQuery=e.$=h),h})})(ur);var Io=ur.exports;const Ao=Mo(Io);Ao(function(){let c=new Zt;window.require.config({paths:{vs:"lib/monaco-editor/dev/vs"}}),window.require.config({"vs/nls":{availableLanguages:{"*":"de"}},ignoreDuplicateModules:["vs/editor/editor.main"]}),window.require(["vs/editor/editor.main"],function(){c.initEditor(),c.getMonacoEditor().updateOptions({readOnly:!0}),c.bottomDiv.initGUI()}),c.initGUI()});
//# sourceMappingURL=main-Djo751FK.js.map
